{
    "sourceFile": "kullanici_konum_tracking.sql",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1756311206692,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1756311206692,
            "name": "Commit-0",
            "content": "-- Kullanıcı konum takibi için tablolar\r\n\r\n-- 1. Kullanıcı konum geçmişi tablosu\r\nCREATE TABLE IF NOT EXISTS kullanici_konum_takibi (\r\n    id int(11) PRIMARY KEY AUTO_INCREMENT,\r\n    kullanici_id int(11) NOT NULL,\r\n    latitude DECIMAL(10, 8) NOT NULL,\r\n    longitude DECIMAL(11, 8) NOT NULL,\r\n    accuracy FLOAT DEFAULT NULL,\r\n    address VARCHAR(500) DEFAULT NULL,\r\n    ip_address VARCHAR(45) DEFAULT NULL,\r\n    user_agent TEXT DEFAULT NULL,\r\n    device_info VARCHAR(255) DEFAULT NULL,\r\n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\r\n    INDEX idx_kullanici_id (kullanici_id),\r\n    INDEX idx_created_at (created_at)\r\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\r\n\r\n-- 2. Kullanıcı login log tablosunu oluştur\r\nCREATE TABLE IF NOT EXISTS kullanici_log (\r\n    log_id int(11) PRIMARY KEY AUTO_INCREMENT,\r\n    kullanici_id int(11) NOT NULL,\r\n    login_time DATETIME DEFAULT CURRENT_TIMESTAMP,\r\n    logout_time DATETIME DEFAULT NULL,\r\n    ip_address VARCHAR(45) DEFAULT NULL,\r\n    user_agent TEXT DEFAULT NULL,\r\n    login_latitude DECIMAL(10, 8) DEFAULT NULL,\r\n    login_longitude DECIMAL(11, 8) DEFAULT NULL,\r\n    login_address VARCHAR(500) DEFAULT NULL,\r\n    login_device_info VARCHAR(255) DEFAULT NULL,\r\n    INDEX idx_kullanici_id (kullanici_id),\r\n    INDEX idx_login_time (login_time)\r\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\r\n\r\n-- 3. Kullanıcı anlık konum tablosu (son bilinen konum)\r\nCREATE TABLE IF NOT EXISTS kullanici_son_konum (\r\n    kullanici_id int(11) PRIMARY KEY,\r\n    latitude DECIMAL(10, 8) DEFAULT NULL,\r\n    longitude DECIMAL(11, 8) DEFAULT NULL,\r\n    accuracy FLOAT DEFAULT NULL,\r\n    address VARCHAR(500) DEFAULT NULL,\r\n    last_update DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\r\n    is_online TINYINT(1) DEFAULT 0\r\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\r\n\r\n-- Foreign key kısıtlamaları yerine sadece indexler kullan\r\n-- Not: kullanicilar tablosunda foreign key sorunları olduğu için kısıtlamalar kaldırıldı\r\n-- Veri bütünlüğü uygulama seviyesinde sağlanacak\r\n\r\n-- Ek indexler ekle (performans için)\r\nCREATE INDEX IF NOT EXISTS idx_konum_takibi_kullanici_tarih \r\nON kullanici_konum_takibi (kullanici_id, created_at);\r\n\r\nCREATE INDEX IF NOT EXISTS idx_son_konum_update \r\nON kullanici_son_konum (last_update);\r\n\r\nCREATE INDEX IF NOT EXISTS idx_kullanici_log_session \r\nON kullanici_log (kullanici_id, login_time, logout_time);\r\n"
        }
    ]
}