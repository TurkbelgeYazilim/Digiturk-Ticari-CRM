{
    "sourceFile": "debug_months_test.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1759920963347,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1759920963347,
            "name": "Commit-0",
            "content": "<?php\r\ndefined('BASEPATH') OR exit('No direct script access allowed');\r\n\r\n// Simple test file to check month generation from database\r\nrequire_once APPPATH . 'config/database.php';\r\n\r\n$servername = $db['default']['hostname'];\r\n$username = $db['default']['username'];\r\n$password = $db['default']['password'];\r\n$dbname = $db['default']['database'];\r\n\r\ntry {\r\n    $pdo = new PDO(\"mysql:host=$servername;dbname=$dbname\", $username, $password);\r\n    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\r\n\r\n    echo \"<h2>Testing Month Generation for Tahsilat Listesi</h2>\";\r\n    echo \"<p>Current Date: \" . date('Y-m-d') . \"</p>\";\r\n    \r\n    // Test query from controller\r\n    $aylar_query = \"\r\n    SELECT DISTINCT DATE_FORMAT(vade_ay, '%Y-%m') AS ay_deger,\r\n           YEAR(vade_ay) AS yil,\r\n           MONTH(vade_ay) AS ay_num\r\n    FROM (\r\n        SELECT cek_vadeTarih AS vade_ay FROM cek WHERE cek_vadeTarih IS NOT NULL\r\n        UNION ALL\r\n        SELECT senet_vadeTarih AS vade_ay FROM senet WHERE senet_vadeTarih IS NOT NULL\r\n        UNION ALL\r\n        SELECT bh_tarih AS vade_ay FROM bankaHareketleri WHERE bh_tarih IS NOT NULL\r\n        UNION ALL\r\n        SELECT kh_tarih AS vade_ay FROM kasaHareketleri WHERE kh_tarih IS NOT NULL\r\n    ) AS birlesik\r\n    WHERE vade_ay != '0000-00-00' AND vade_ay IS NOT NULL\r\n    ORDER BY vade_ay DESC\";\r\n    \r\n    $stmt = $pdo->query($aylar_query);\r\n    $mevcut_aylar = $stmt->fetchAll(PDO::FETCH_OBJ);\r\n    \r\n    echo \"<h3>Months Found in Database:</h3>\";\r\n    echo \"<table border='1' style='border-collapse: collapse;'>\";\r\n    echo \"<tr><th>Month Value</th><th>Year</th><th>Month Number</th><th>Display Name</th></tr>\";\r\n    \r\n    $aylar_names = array(\r\n        1 => 'Ocak', 2 => 'Şubat', 3 => 'Mart', 4 => 'Nisan',\r\n        5 => 'Mayıs', 6 => 'Haziran', 7 => 'Temmuz', 8 => 'Ağustos',\r\n        9 => 'Eylül', 10 => 'Ekim', 11 => 'Kasım', 12 => 'Aralık'\r\n    );\r\n    \r\n    $eklenen_aylar = array();\r\n    foreach($mevcut_aylar as $ay) {\r\n        if ($ay->ay_deger && !in_array($ay->ay_deger, $eklenen_aylar)) {\r\n            $ay_adi = $aylar_names[$ay->ay_num];\r\n            echo \"<tr>\";\r\n            echo \"<td>{$ay->ay_deger}</td>\";\r\n            echo \"<td>{$ay->yil}</td>\";\r\n            echo \"<td>{$ay->ay_num}</td>\";\r\n            echo \"<td>{$ay_adi} {$ay->yil}</td>\";\r\n            echo \"</tr>\";\r\n            $eklenen_aylar[] = $ay->ay_deger;\r\n        }\r\n    }\r\n    echo \"</table>\";\r\n    \r\n    echo \"<h3>Test URLs:</h3>\";\r\n    echo \"<ul>\";\r\n    foreach($eklenen_aylar as $ay_deger) {\r\n        echo \"<li><a href='/muhasebe/tahsilat-listesi?tahsilat_ayi={$ay_deger}' target='_blank'>Tahsilat Listesi - {$ay_deger}</a></li>\";\r\n    }\r\n    echo \"</ul>\";\r\n    \r\n    // Test specific October 2025\r\n    echo \"<h3>Testing October 2025 Data:</h3>\";\r\n    $test_query = \"\r\n    SELECT 'cek' as tip, cek_id as id, cek_vadeTarih as tarih, cek_tutar as tutar \r\n    FROM cek \r\n    WHERE YEAR(cek_vadeTarih) = 2025 AND MONTH(cek_vadeTarih) = 10\r\n    UNION ALL\r\n    SELECT 'senet' as tip, senet_id as id, senet_vadeTarih as tarih, senet_tutar as tutar \r\n    FROM senet \r\n    WHERE YEAR(senet_vadeTarih) = 2025 AND MONTH(senet_vadeTarih) = 10\r\n    ORDER BY tarih DESC\";\r\n    \r\n    $stmt2 = $pdo->query($test_query);\r\n    $ekim_data = $stmt2->fetchAll(PDO::FETCH_OBJ);\r\n    \r\n    if (count($ekim_data) > 0) {\r\n        echo \"<p>Found \" . count($ekim_data) . \" records for October 2025:</p>\";\r\n        echo \"<table border='1' style='border-collapse: collapse;'>\";\r\n        echo \"<tr><th>Type</th><th>ID</th><th>Date</th><th>Amount</th></tr>\";\r\n        foreach($ekim_data as $record) {\r\n            echo \"<tr>\";\r\n            echo \"<td>{$record->tip}</td>\";\r\n            echo \"<td>{$record->id}</td>\";\r\n            echo \"<td>{$record->tarih}</td>\";\r\n            echo \"<td>{$record->tutar}</td>\";\r\n            echo \"</tr>\";\r\n        }\r\n        echo \"</table>\";\r\n    } else {\r\n        echo \"<p>No records found for October 2025</p>\";\r\n    }\r\n    \r\n} catch(PDOException $e) {\r\n    echo \"Error: \" . $e->getMessage();\r\n}\r\n?>"
        }
    ]
}