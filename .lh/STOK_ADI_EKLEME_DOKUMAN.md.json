{
    "sourceFile": "STOK_ADI_EKLEME_DOKUMAN.md",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1755506192816,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1755506192816,
            "name": "Commit-0",
            "content": "# Stok Adı Ekleme - Tam Ana Rapor\r\n\r\n## Özet\r\nTam Ana Rapor sayfasındaki \"Satış Sözleşme Hizmeti\" sütununa, Satış Faturası Listesi sayfasındaki gibi \"Stok Adı\" bilgisi eklendi.\r\n\r\n## Yapılan Değişiklikler\r\n\r\n### 1. Controller Güncellemesi\r\n**Dosya:** `application/controllers/Muhasebe.php`\r\n**Satırlar:** 2269-2274\r\n\r\nSQL sorgusuna stok adı bilgisini getiren yeni alt sorgu eklendi:\r\n\r\n```sql\r\n-- Stok adı bilgisi (en yeni satıştan)\r\n(SELECT s.stok_ad \r\n FROM satisFaturasi sf2 \r\n INNER JOIN satisFaturasiStok sfs ON sfs.satisStok_satisFaturasiID = sf2.satis_id\r\n INNER JOIN stok s ON sfs.satisStok_stokID = s.stok_id\r\n WHERE sf2.satis_cariID = c.cari_id \r\n ORDER BY sf2.satis_id DESC LIMIT 1) as satis_sozlesme_hizmeti,\r\n```\r\n\r\n**Amaç:** Her müşteri için en yeni satış faturasından ilk stok adını alır ve `satis_sozlesme_hizmeti` alanına koyar.\r\n\r\n### 2. View Güncellemesi\r\n**Dosya:** `application/views/muhasebe/tam-ana-rapor.php`\r\n**Satırlar:** 499-507\r\n\r\n\"Satış Sözleşme Hizmeti\" sütununun görünümü iyileştirildi:\r\n\r\n```php\r\n<td>\r\n    <?php if (isset($veri->satis_sozlesme_hizmeti) && !empty($veri->satis_sozlesme_hizmeti)): ?>\r\n        <span class=\"text-success\">\r\n            <i class=\"fa fa-box mr-1\"></i>\r\n            <?= htmlspecialchars($veri->satis_sozlesme_hizmeti) ?>\r\n        </span>\r\n    <?php else: ?>\r\n        <span class=\"text-muted\">-</span>\r\n    <?php endif; ?>\r\n</td>\r\n```\r\n\r\n**Amaç:** Stok adını, Satış Faturası Listesi sayfasındaki gibi yeşil renkte kutu ikonu ile gösterir.\r\n\r\n### 3. Excel Export Güncellemesi\r\n**Dosya:** `application/controllers/Muhasebe.php`\r\n**Satırlar:** 2599-2607 (Query), 2689-2701 (Headers), 2720-2732 (Data)\r\n\r\nExcel export fonksiyonuna da stok adı bilgisi eklendi:\r\n\r\n**Query Eklentisi:**\r\n```sql\r\n-- Stok adı bilgisi (en yeni satıştan) - Excel için eklendi\r\n(SELECT s.stok_ad \r\n FROM satisFaturasi sf2 \r\n INNER JOIN satisFaturasiStok sfs ON sfs.satisStok_satisFaturasiID = sf2.satis_id\r\n INNER JOIN stok s ON sfs.satisStok_stokID = s.stok_id\r\n WHERE sf2.satis_cariID = c.cari_id \r\n ORDER BY sf2.satis_id DESC LIMIT 1) as satis_sozlesme_hizmeti,\r\n```\r\n\r\n**Excel Başlığı:** \"D1\" sütunu = \"Satış Sözleşme Hizmeti\"\r\n\r\n**Amaç:** Excel export dosyasında da stok adı bilgisini gösterir.\r\n\r\n### 4. Düzeltilen Tablo Adları\r\nAşağıdaki tablo adları doğru şekilde düzenlendi:\r\n- `satisfaturasi` → `satisFaturasi`\r\n- `satisfaturasistok` → `satisFaturasiStok`\r\n\r\n## Sonuç\r\nBu değişiklikler sonrasında, Tam Ana Rapor sayfasındaki \"Satış Sözleşme Hizmeti\" sütunu artık müşterilerin son satın aldıkları stok adını gösterecektir. Görünüm de Satış Faturası Listesi ile tutarlı hale gelmiştir.\r\n\r\n## Test\r\nDeğişiklikleri test etmek için:\r\n1. Tam Ana Rapor sayfasına gidin: https://crm.ilekasoft.com/muhasebe/tam-ana-rapor\r\n2. \"Satış Sözleşme Hizmeti\" sütununda stok adlarının görüntülendiğini kontrol edin\r\n3. Stok adları yeşil renkte ve kutu ikonu ile gösterilmelidir\r\n\r\n## Tarih\r\n18 Ağustos 2025\r\n"
        }
    ]
}