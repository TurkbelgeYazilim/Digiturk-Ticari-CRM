{
    "sourceFile": "smtp_test.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1760099488527,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1760099488527,
            "name": "Commit-0",
            "content": "<?php\r\nini_set('display_errors', 1);\r\nerror_reporting(E_ALL);\r\n\r\necho \"<h2>SMTP Test Sayfası</h2>\";\r\necho \"<p>Test başlıyor...</p>\";\r\n\r\n// CodeIgniter bootstrap\r\ndefine('BASEPATH', __DIR__ . '/system/');\r\ndefine('APPPATH', __DIR__ . '/application/');\r\n\r\n// E-posta konfigürasyonu\r\n$mail_config = Array(\r\n    'protocol' => 'smtp',\r\n    'smtp_crypto' => 'ssl',\r\n    'smtp_host' => 'mail.ilekasoft.com',\r\n    'smtp_port' => 465,\r\n    'smtp_user' => 'ticket@ilekasoft.com',\r\n    'smtp_pass' => '0oqZknrfOw',\r\n    'charset'   => 'utf-8',\r\n    'mailtype'  => 'html',\r\n    'wordwrap' => TRUE\r\n);\r\n\r\necho \"<h3>SMTP Ayarları:</h3>\";\r\necho \"<ul>\";\r\necho \"<li>Host: \" . $mail_config['smtp_host'] . \"</li>\";\r\necho \"<li>Port: \" . $mail_config['smtp_port'] . \"</li>\";\r\necho \"<li>User: \" . $mail_config['smtp_user'] . \"</li>\";\r\necho \"<li>Crypto: \" . $mail_config['smtp_crypto'] . \"</li>\";\r\necho \"</ul>\";\r\n\r\n// Bağlantı testi\r\necho \"<h3>Bağlantı Testi:</h3>\";\r\n\r\n// Socket bağlantısı test et\r\n$socket = @fsockopen($mail_config['smtp_host'], $mail_config['smtp_port'], $errno, $errstr, 10);\r\nif ($socket) {\r\n    echo \"<p style='color: green;'>✅ Socket bağlantısı başarılı: \" . $mail_config['smtp_host'] . \":\" . $mail_config['smtp_port'] . \"</p>\";\r\n    fclose($socket);\r\n} else {\r\n    echo \"<p style='color: red;'>❌ Socket bağlantısı başarısız: $errstr ($errno)</p>\";\r\n}\r\n\r\n// SSL context test\r\necho \"<h3>SSL Test:</h3>\";\r\n$context = stream_context_create([\r\n    \"ssl\" => [\r\n        \"verify_peer\" => false,\r\n        \"verify_peer_name\" => false,\r\n    ],\r\n]);\r\n\r\n$ssl_socket = @stream_socket_client(\"ssl://\" . $mail_config['smtp_host'] . \":\" . $mail_config['smtp_port'], $errno, $errstr, 10, STREAM_CLIENT_CONNECT, $context);\r\nif ($ssl_socket) {\r\n    echo \"<p style='color: green;'>✅ SSL bağlantısı başarılı</p>\";\r\n    fclose($ssl_socket);\r\n} else {\r\n    echo \"<p style='color: red;'>❌ SSL bağlantısı başarısız: $errstr ($errno)</p>\";\r\n}\r\n\r\n// PHP mail fonksiyonu test\r\necho \"<h3>PHP Mail Test:</h3>\";\r\nif (function_exists('mail')) {\r\n    echo \"<p style='color: green;'>✅ PHP mail() fonksiyonu mevcut</p>\";\r\n    \r\n    // Basit mail gönder\r\n    $to = \"test@example.com\";\r\n    $subject = \"SMTP Test\";\r\n    $message = \"Bu bir test e-postasıdır.\";\r\n    $headers = \"From: ticket@ilekasoft.com\\r\\n\";\r\n    \r\n    if (mail($to, $subject, $message, $headers)) {\r\n        echo \"<p style='color: green;'>✅ PHP mail() test başarılı (not: gerçek gönderim olmayabilir)</p>\";\r\n    } else {\r\n        echo \"<p style='color: orange;'>⚠️ PHP mail() test sonucu belirsiz</p>\";\r\n    }\r\n} else {\r\n    echo \"<p style='color: red;'>❌ PHP mail() fonksiyonu mevcut değil</p>\";\r\n}\r\n\r\n// DNS test\r\necho \"<h3>DNS Test:</h3>\";\r\n$ip = gethostbyname($mail_config['smtp_host']);\r\nif ($ip != $mail_config['smtp_host']) {\r\n    echo \"<p style='color: green;'>✅ DNS çözümleme başarılı: \" . $mail_config['smtp_host'] . \" → $ip</p>\";\r\n} else {\r\n    echo \"<p style='color: red;'>❌ DNS çözümleme başarısız</p>\";\r\n}\r\n\r\n// Ping test (Windows)\r\necho \"<h3>Ping Test:</h3>\";\r\n$ping_result = shell_exec(\"ping -n 1 \" . $mail_config['smtp_host']);\r\nif (strpos($ping_result, 'TTL') !== false) {\r\n    echo \"<p style='color: green;'>✅ Ping test başarılı</p>\";\r\n    echo \"<pre style='background: #f5f5f5; padding: 10px;'>\" . htmlspecialchars($ping_result) . \"</pre>\";\r\n} else {\r\n    echo \"<p style='color: red;'>❌ Ping test başarısız</p>\";\r\n    echo \"<pre style='background: #f5f5f5; padding: 10px;'>\" . htmlspecialchars($ping_result) . \"</pre>\";\r\n}\r\n\r\n// Telnet test simülasyonu\r\necho \"<h3>SMTP Protokol Test:</h3>\";\r\n$smtp_socket = @fsockopen($mail_config['smtp_host'], $mail_config['smtp_port'], $errno, $errstr, 10);\r\nif ($smtp_socket) {\r\n    $response = fgets($smtp_socket, 515);\r\n    echo \"<p style='color: green;'>✅ SMTP sunucu yanıtı: \" . htmlspecialchars(trim($response)) . \"</p>\";\r\n    \r\n    // EHLO komutu gönder\r\n    fwrite($smtp_socket, \"EHLO test.com\\r\\n\");\r\n    $ehlo_response = \"\";\r\n    while ($line = fgets($smtp_socket, 515)) {\r\n        $ehlo_response .= $line;\r\n        if (substr($line, 3, 1) == ' ') break;\r\n    }\r\n    echo \"<p>EHLO yanıtı:</p>\";\r\n    echo \"<pre style='background: #f5f5f5; padding: 10px;'>\" . htmlspecialchars($ehlo_response) . \"</pre>\";\r\n    \r\n    fclose($smtp_socket);\r\n} else {\r\n    echo \"<p style='color: red;'>❌ SMTP protokol test başarısız</p>\";\r\n}\r\n\r\necho \"<hr>\";\r\necho \"<p><a href='javascript:history.back()'>← Geri Dön</a></p>\";\r\n?>"
        }
    ]
}