{
    "sourceFile": "test_stok_endpoint.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1755584922758,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1755584922758,
            "name": "Commit-0",
            "content": "<?php\r\n// Simple endpoint test without CodeIgniter\r\nheader('Content-Type: application/json');\r\nheader('Access-Control-Allow-Origin: *');\r\nheader('Access-Control-Allow-Methods: POST, GET, OPTIONS');\r\nheader('Access-Control-Allow-Headers: Content-Type');\r\n\r\nif ($_SERVER['REQUEST_METHOD'] === 'OPTIONS') {\r\n    http_response_code(200);\r\n    exit();\r\n}\r\n\r\n$satis_id = isset($_POST['satis_id']) ? $_POST['satis_id'] : null;\r\n$cari_id = isset($_POST['cari_id']) ? $_POST['cari_id'] : null;\r\n\r\nif (!$satis_id) {\r\n    echo json_encode([\r\n        'success' => false,\r\n        'message' => 'Satış ID bilgisi eksik',\r\n        'debug' => [\r\n            'POST' => $_POST,\r\n            'method' => $_SERVER['REQUEST_METHOD']\r\n        ]\r\n    ]);\r\n    exit;\r\n}\r\n\r\ntry {\r\n    // Direct database connection\r\n    $host = 'localhost';\r\n    $dbname = 'ilekasoft_crmdb';\r\n    $username = 'ilekasoft_crmuser'; // Updated with correct credentials\r\n    $password = 'KaleW356!';         // Updated with correct credentials\r\n    \r\n    // MySQL 8.0 uyumlu PDO bağlantısı\r\n    $dsn = \"mysql:host=$host;dbname=$dbname;charset=utf8mb4\";\r\n    $options = [\r\n        PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,\r\n        PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,\r\n        PDO::MYSQL_ATTR_INIT_COMMAND => \"SET NAMES utf8mb4 COLLATE utf8mb4_unicode_ci\",\r\n        PDO::MYSQL_ATTR_SSL_VERIFY_SERVER_CERT => false\r\n    ];\r\n    \r\n    $pdo = new PDO($dsn, $username, $password, $options);\r\n    \r\n    // Test query\r\n    $query = \"\r\n        SELECT \r\n            sfs.satisStok_id,\r\n            sfs.satisStok_satisFaturasiID,\r\n            sfs.satisStok_stokID as stok_id,\r\n            sfs.satisStok_stokAdi as stok_adi,\r\n            sfs.satisStok_miktar,\r\n            sfs.satisStok_birimFiyat,\r\n            sfs.satisStok_kdv\r\n        FROM satisFaturasiStok sfs\r\n        WHERE sfs.satisStok_satisFaturasiID = ?\r\n        ORDER BY sfs.satisStok_id ASC\r\n    \";\r\n    \r\n    $stmt = $pdo->prepare($query);\r\n    $stmt->execute([$satis_id]);\r\n    $result = $stmt->fetchAll(PDO::FETCH_ASSOC);\r\n    \r\n    echo json_encode([\r\n        'success' => true,\r\n        'data' => $result,\r\n        'debug' => [\r\n            'satis_id' => $satis_id,\r\n            'cari_id' => $cari_id,\r\n            'count' => count($result),\r\n            'query' => $query\r\n        ]\r\n    ]);\r\n    \r\n} catch (Exception $e) {\r\n    echo json_encode([\r\n        'success' => false,\r\n        'message' => 'Database error: ' . $e->getMessage(),\r\n        'debug' => [\r\n            'satis_id' => $satis_id,\r\n            'cari_id' => $cari_id,\r\n            'error' => $e->getMessage()\r\n        ]\r\n    ]);\r\n}\r\n?>\r\n"
        }
    ]
}