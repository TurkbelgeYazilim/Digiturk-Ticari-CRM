{
    "sourceFile": "test_stok_dropdown.html",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1756810205232,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1756810205232,
            "name": "Commit-0",
            "content": "<!DOCTYPE html>\r\n<html lang=\"tr\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <title>Stok Dropdown Test</title>\r\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\r\n    <link href=\"https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css\" rel=\"stylesheet\" />\r\n    <link href=\"https://cdn.jsdelivr.net/npm/select2-bootstrap-5-theme@1.3.0/dist/select2-bootstrap-5-theme.min.css\" rel=\"stylesheet\" />\r\n</head>\r\n<body>\r\n    <div class=\"container mt-5\">\r\n        <h1>Stok Dropdown Test</h1>\r\n        \r\n        <div class=\"row\">\r\n            <div class=\"col-md-6\">\r\n                <h3>Select2 Dropdown</h3>\r\n                <select id=\"stokDropdown\" class=\"form-select\" style=\"width: 100%;\">\r\n                    <option value=\"\">Stok seçiniz...</option>\r\n                </select>\r\n            </div>\r\n            <div class=\"col-md-6\">\r\n                <h3>Seçilen Stok Bilgileri</h3>\r\n                <div id=\"selectedStokInfo\" class=\"alert alert-info\">\r\n                    Bir stok seçin...\r\n                </div>\r\n            </div>\r\n        </div>\r\n        \r\n        <div class=\"row mt-4\">\r\n            <div class=\"col-12\">\r\n                <h3>Debug Bilgileri</h3>\r\n                <div id=\"debugInfo\" class=\"alert alert-secondary\">\r\n                    Henüz işlem yapılmadı...\r\n                </div>\r\n            </div>\r\n        </div>\r\n        \r\n        <div class=\"row mt-4\">\r\n            <div class=\"col-12\">\r\n                <h3>Test Butonları</h3>\r\n                <button id=\"testEndpoint\" class=\"btn btn-primary me-2\">Endpoint'i Test Et</button>\r\n                <button id=\"loadAllStocks\" class=\"btn btn-success me-2\">Tüm Stokları Yükle</button>\r\n                <button id=\"searchTest\" class=\"btn btn-warning\">Arama Testi</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <script src=\"https://code.jquery.com/jquery-3.6.0.min.js\"></script>\r\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js\"></script>\r\n    <script src=\"https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js\"></script>\r\n\r\n    <script>\r\n        $(document).ready(function() {\r\n            // Select2'yi başlat\r\n            $('#stokDropdown').select2({\r\n                theme: 'bootstrap-5',\r\n                width: '100%',\r\n                placeholder: 'Stok seçiniz...',\r\n                allowClear: true,\r\n                ajax: {\r\n                    url: 'stok_dropdown_endpoint.php',\r\n                    dataType: 'json',\r\n                    delay: 250,\r\n                    data: function (params) {\r\n                        return {\r\n                            q: params.term, // arama terimi\r\n                            page: params.page || 1\r\n                        };\r\n                    },\r\n                    processResults: function (data, params) {\r\n                        console.log('AJAX Response:', data);\r\n                        $('#debugInfo').html('<pre>' + JSON.stringify(data, null, 2) + '</pre>');\r\n                        \r\n                        params.page = params.page || 1;\r\n                        \r\n                        return {\r\n                            results: data.results || [],\r\n                            pagination: {\r\n                                more: data.pagination && data.pagination.more\r\n                            }\r\n                        };\r\n                    },\r\n                    cache: true\r\n                },\r\n                minimumInputLength: 0,\r\n                escapeMarkup: function (markup) { \r\n                    return markup; \r\n                }\r\n            }).on('select2:select', function (e) {\r\n                const selectedData = e.params.data;\r\n                console.log('Seçilen stok:', selectedData);\r\n                \r\n                if (selectedData.stok_data) {\r\n                    $('#selectedStokInfo').html(`\r\n                        <strong>Stok Bilgileri:</strong><br>\r\n                        ID: ${selectedData.stok_data.stok_id}<br>\r\n                        Ad: ${selectedData.stok_data.stok_ad}<br>\r\n                        Kod: ${selectedData.stok_data.stok_kodu}<br>\r\n                        Satış Fiyatı: ${selectedData.stok_data.stok_satisFiyati} ₺<br>\r\n                        KDV: %${selectedData.stok_data.stok_satisKDV}\r\n                    `);\r\n                } else {\r\n                    $('#selectedStokInfo').html('Stok data bulunamadı');\r\n                }\r\n            }).on('select2:clear', function (e) {\r\n                $('#selectedStokInfo').html('Seçim temizlendi');\r\n            });\r\n\r\n            // Test butonları\r\n            $('#testEndpoint').click(function() {\r\n                $.ajax({\r\n                    url: 'stok_dropdown_endpoint.php',\r\n                    method: 'GET',\r\n                    dataType: 'json',\r\n                    success: function(data) {\r\n                        $('#debugInfo').html('<h5>Endpoint Test Sonucu:</h5><pre>' + JSON.stringify(data, null, 2) + '</pre>');\r\n                    },\r\n                    error: function(xhr, status, error) {\r\n                        $('#debugInfo').html('<h5 class=\"text-danger\">Endpoint Hatası:</h5><pre>' + xhr.responseText + '</pre>');\r\n                    }\r\n                });\r\n            });\r\n\r\n            $('#loadAllStocks').click(function() {\r\n                $.ajax({\r\n                    url: 'stok_dropdown_endpoint.php',\r\n                    method: 'GET',\r\n                    data: { q: '' },\r\n                    dataType: 'json',\r\n                    success: function(data) {\r\n                        $('#debugInfo').html('<h5>Tüm Stoklar:</h5><pre>' + JSON.stringify(data, null, 2) + '</pre>');\r\n                    },\r\n                    error: function(xhr, status, error) {\r\n                        $('#debugInfo').html('<h5 class=\"text-danger\">Yükleme Hatası:</h5><pre>' + xhr.responseText + '</pre>');\r\n                    }\r\n                });\r\n            });\r\n\r\n            $('#searchTest').click(function() {\r\n                const searchTerm = prompt('Aranacak terimi girin:');\r\n                if (searchTerm) {\r\n                    $.ajax({\r\n                        url: 'stok_dropdown_endpoint.php',\r\n                        method: 'GET',\r\n                        data: { q: searchTerm },\r\n                        dataType: 'json',\r\n                        success: function(data) {\r\n                            $('#debugInfo').html(`<h5>Arama Sonucu (${searchTerm}):</h5><pre>` + JSON.stringify(data, null, 2) + '</pre>');\r\n                        },\r\n                        error: function(xhr, status, error) {\r\n                            $('#debugInfo').html(`<h5 class=\"text-danger\">Arama Hatası (${searchTerm}):</h5><pre>` + xhr.responseText + '</pre>');\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        });\r\n    </script>\r\n</body>\r\n</html>\r\n"
        }
    ]
}