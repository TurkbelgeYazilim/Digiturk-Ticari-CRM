{
    "sourceFile": "test_stok_mysqli.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1755584922758,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1755584922758,
            "name": "Commit-0",
            "content": "<?php\r\n// MySQLi kullanarak test endpoint\r\nheader('Content-Type: application/json');\r\nheader('Access-Control-Allow-Origin: *');\r\nheader('Access-Control-Allow-Methods: POST, GET, OPTIONS');\r\nheader('Access-Control-Allow-Headers: Content-Type');\r\n\r\nif ($_SERVER['REQUEST_METHOD'] === 'OPTIONS') {\r\n    http_response_code(200);\r\n    exit();\r\n}\r\n\r\n$satis_id = isset($_POST['satis_id']) ? $_POST['satis_id'] : null;\r\n$cari_id = isset($_POST['cari_id']) ? $_POST['cari_id'] : null;\r\n\r\nif (!$satis_id) {\r\n    echo json_encode([\r\n        'success' => false,\r\n        'message' => 'Satış ID bilgisi eksik',\r\n        'debug' => [\r\n            'POST' => $_POST,\r\n            'method' => $_SERVER['REQUEST_METHOD']\r\n        ]\r\n    ]);\r\n    exit;\r\n}\r\n\r\ntry {\r\n    // MySQLi connection\r\n    $host = 'localhost';\r\n    $dbname = 'ilekasoft_crmdb';\r\n    $username = 'ilekasoft_crmuser';\r\n    $password = 'KaleW356!';\r\n    \r\n    $mysqli = new mysqli($host, $username, $password, $dbname);\r\n    \r\n    // Set charset\r\n    $mysqli->set_charset(\"utf8mb4\");\r\n    \r\n    if ($mysqli->connect_error) {\r\n        throw new Exception(\"MySQL connection failed: \" . $mysqli->connect_error);\r\n    }\r\n    \r\n    // Test query\r\n    $query = \"\r\n        SELECT \r\n            sfs.satisStok_id,\r\n            sfs.satisStok_satisFaturasiID,\r\n            sfs.satisStok_stokID as stok_id,\r\n            sfs.satisStok_stokAdi as stok_adi,\r\n            sfs.satisStok_miktar,\r\n            sfs.satisStok_birimFiyat,\r\n            sfs.satisStok_kdv\r\n        FROM satisFaturasiStok sfs\r\n        WHERE sfs.satisStok_satisFaturasiID = ?\r\n        ORDER BY sfs.satisStok_id ASC\r\n    \";\r\n    \r\n    $stmt = $mysqli->prepare($query);\r\n    if (!$stmt) {\r\n        throw new Exception(\"Prepare failed: \" . $mysqli->error);\r\n    }\r\n    \r\n    $stmt->bind_param(\"i\", $satis_id);\r\n    $stmt->execute();\r\n    \r\n    $result = $stmt->get_result();\r\n    $data = [];\r\n    while ($row = $result->fetch_assoc()) {\r\n        $data[] = $row;\r\n    }\r\n    \r\n    $stmt->close();\r\n    $mysqli->close();\r\n    \r\n    echo json_encode([\r\n        'success' => true,\r\n        'data' => $data,\r\n        'debug' => [\r\n            'satis_id' => $satis_id,\r\n            'cari_id' => $cari_id,\r\n            'query' => $query,\r\n            'result_count' => count($data)\r\n        ]\r\n    ]);\r\n    \r\n} catch (Exception $e) {\r\n    echo json_encode([\r\n        'success' => false,\r\n        'message' => 'Database error: ' . $e->getMessage(),\r\n        'debug' => [\r\n            'satis_id' => $satis_id,\r\n            'cari_id' => $cari_id,\r\n            'error' => $e->getMessage()\r\n        ]\r\n    ]);\r\n}\r\n?>\r\n"
        }
    ]
}