{
    "sourceFile": "tahsilat_onay_update.sql",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1759839514061,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1759839514061,
            "name": "Commit-0",
            "content": "-- Tahsilat Onay Checkbox Özelliği için Veritabanı Güncellemesi\r\n-- Tarih: 07.10.2025\r\n-- Amaç: muhasebe_tahsilat_durum tablosuna onay_durumu alanı ekleme\r\n\r\n-- 1. muhasebe_tahsilat_durum tablosuna onay_durumu alanını ekle\r\nALTER TABLE `muhasebe_tahsilat_durum` \r\nADD COLUMN `onay_durumu` TINYINT(1) NOT NULL DEFAULT '0' \r\nCOMMENT 'Onay durumu: 0=Onaylanmamış, 1=Onaylanmış' \r\nAFTER `aciklama`;\r\n\r\n-- 2. Güncelleme tarihi alanını ekle (isteğe bağlı)\r\nALTER TABLE `muhasebe_tahsilat_durum` \r\nADD COLUMN `guncelleme_tarihi` DATETIME NULL \r\nCOMMENT 'Son güncelleme tarihi' \r\nAFTER `onay_durumu`;\r\n\r\n-- 3. Index ekle (performans için)\r\nALTER TABLE `muhasebe_tahsilat_durum` \r\nADD INDEX `idx_tahsilat_tip_kayit` (`tahsilat_tipi`, `kayit_id`),\r\nADD INDEX `idx_onay_durumu` (`onay_durumu`);\r\n\r\n-- Kontrol sorgusu - tablonun güncel durumunu göster\r\nDESCRIBE `muhasebe_tahsilat_durum`;\r\n\r\n-- Test sorgusu - varolan kayıtları kontrol et\r\nSELECT \r\n    tahsilat_tipi,\r\n    COUNT(*) as kayit_sayisi,\r\n    SUM(CASE WHEN onay_durumu = 1 THEN 1 ELSE 0 END) as onaylanmis_sayisi,\r\n    SUM(CASE WHEN onay_durumu = 0 THEN 1 ELSE 0 END) as onaylanmamis_sayisi\r\nFROM `muhasebe_tahsilat_durum` \r\nGROUP BY tahsilat_tipi;"
        }
    ]
}