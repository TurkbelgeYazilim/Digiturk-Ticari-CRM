{
    "sourceFile": "smtp_detailed_test.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1760099488522,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1760099488522,
            "name": "Commit-0",
            "content": "<?php\r\n// SMTP Test - Gmail ile\r\nini_set('display_errors', 1);\r\nerror_reporting(E_ALL);\r\n\r\necho \"<h2>Gmail SMTP Test</h2>\";\r\n\r\n// Gmail SMTP ayarları (daha güvenilir)\r\n$gmail_config = Array(\r\n    'protocol' => 'smtp',\r\n    'smtp_crypto' => 'tls',\r\n    'smtp_host' => 'smtp.gmail.com',\r\n    'smtp_port' => 587,\r\n    'smtp_user' => 'test@gmail.com',  // Test için\r\n    'smtp_pass' => 'test_password',   // Test için\r\n    'charset'   => 'utf-8',\r\n    'mailtype'  => 'html',\r\n    'wordwrap' => TRUE\r\n);\r\n\r\necho \"<h3>Gmail SMTP Bağlantı Testi:</h3>\";\r\n$socket = @fsockopen($gmail_config['smtp_host'], $gmail_config['smtp_port'], $errno, $errstr, 10);\r\nif ($socket) {\r\n    echo \"<p style='color: green;'>✅ Gmail SMTP bağlantısı başarılı</p>\";\r\n    fclose($socket);\r\n} else {\r\n    echo \"<p style='color: red;'>❌ Gmail SMTP bağlantısı başarısız: $errstr ($errno)</p>\";\r\n}\r\n\r\necho \"<hr>\";\r\n\r\n// İlekaSoft SMTP ayarları\r\n$ilekasoft_config = Array(\r\n    'protocol' => 'smtp',\r\n    'smtp_crypto' => 'ssl',\r\n    'smtp_host' => 'mail.ilekasoft.com',\r\n    'smtp_port' => 465,\r\n    'smtp_user' => 'ticket@ilekasoft.com',\r\n    'smtp_pass' => '0oqZknrfOw',\r\n    'charset'   => 'utf-8',\r\n    'mailtype'  => 'html',\r\n    'wordwrap' => TRUE\r\n);\r\n\r\necho \"<h3>İlekaSoft SMTP Detaylı Test:</h3>\";\r\n\r\n// 1. DNS Test\r\necho \"<h4>1. DNS Çözümleme:</h4>\";\r\n$ip = gethostbyname($ilekasoft_config['smtp_host']);\r\nif ($ip != $ilekasoft_config['smtp_host']) {\r\n    echo \"<p style='color: green;'>✅ DNS: \" . $ilekasoft_config['smtp_host'] . \" → $ip</p>\";\r\n} else {\r\n    echo \"<p style='color: red;'>❌ DNS çözümleme başarısız</p>\";\r\n}\r\n\r\n// 2. Port bağlantısı\r\necho \"<h4>2. Port Bağlantısı:</h4>\";\r\n$socket = @fsockopen($ilekasoft_config['smtp_host'], $ilekasoft_config['smtp_port'], $errno, $errstr, 10);\r\nif ($socket) {\r\n    echo \"<p style='color: green;'>✅ Port \" . $ilekasoft_config['smtp_port'] . \" açık</p>\";\r\n    fclose($socket);\r\n} else {\r\n    echo \"<p style='color: red;'>❌ Port \" . $ilekasoft_config['smtp_port'] . \" kapalı: $errstr ($errno)</p>\";\r\n}\r\n\r\n// 3. SSL Bağlantısı\r\necho \"<h4>3. SSL Bağlantısı:</h4>\";\r\n$context = stream_context_create([\r\n    \"ssl\" => [\r\n        \"verify_peer\" => false,\r\n        \"verify_peer_name\" => false,\r\n    ],\r\n]);\r\n\r\n$ssl_socket = @stream_socket_client(\"ssl://\" . $ilekasoft_config['smtp_host'] . \":\" . $ilekasoft_config['smtp_port'], $errno, $errstr, 10, STREAM_CLIENT_CONNECT, $context);\r\nif ($ssl_socket) {\r\n    echo \"<p style='color: green;'>✅ SSL bağlantısı başarılı</p>\";\r\n    fclose($ssl_socket);\r\n} else {\r\n    echo \"<p style='color: red;'>❌ SSL bağlantısı başarısız: $errstr ($errno)</p>\";\r\n}\r\n\r\n// 4. SMTP Komutları\r\necho \"<h4>4. SMTP Protokol Test:</h4>\";\r\n$smtp_socket = @fsockopen($ilekasoft_config['smtp_host'], $ilekasoft_config['smtp_port'], $errno, $errstr, 10);\r\nif ($smtp_socket) {\r\n    $response = fgets($smtp_socket, 515);\r\n    echo \"<p style='color: green;'>✅ İlk yanıt: \" . htmlspecialchars(trim($response)) . \"</p>\";\r\n    \r\n    // EHLO komutu\r\n    fwrite($smtp_socket, \"EHLO testhost.com\\r\\n\");\r\n    $ehlo_response = \"\";\r\n    while ($line = fgets($smtp_socket, 515)) {\r\n        $ehlo_response .= $line;\r\n        if (substr($line, 3, 1) == ' ') break;\r\n    }\r\n    echo \"<p>EHLO Yanıtı:</p>\";\r\n    echo \"<pre style='background: #f5f5f5; padding: 10px; font-size: 12px;'>\" . htmlspecialchars($ehlo_response) . \"</pre>\";\r\n    \r\n    fclose($smtp_socket);\r\n} else {\r\n    echo \"<p style='color: red;'>❌ SMTP bağlantı hatası</p>\";\r\n}\r\n\r\n// 5. Alternatif portlar\r\necho \"<h4>5. Alternatif Port Testleri:</h4>\";\r\n$ports = [25, 587, 465, 2525];\r\nforeach ($ports as $port) {\r\n    $socket = @fsockopen($ilekasoft_config['smtp_host'], $port, $errno, $errstr, 5);\r\n    if ($socket) {\r\n        echo \"<p style='color: green;'>✅ Port $port: Açık</p>\";\r\n        fclose($socket);\r\n    } else {\r\n        echo \"<p style='color: red;'>❌ Port $port: Kapalı</p>\";\r\n    }\r\n}\r\n\r\necho \"<hr>\";\r\necho \"<h3>Öneriler:</h3>\";\r\necho \"<ul>\";\r\necho \"<li>SMTP sunucusu çalışır durumda görünüyor</li>\";\r\necho \"<li>Port 465 (SSL) kullanılıyor</li>\";\r\necho \"<li>Kullanıcı adı/şifre kombinasyonu kontrol edilmeli</li>\";\r\necho \"<li>Sunucu IP'si firewall'da engellenmiş olabilir</li>\";\r\necho \"<li>SMTP auth gereksinimleri kontrol edilmeli</li>\";\r\necho \"</ul>\";\r\n\r\necho \"<p><a href='javascript:history.back()'>← Geri Dön</a></p>\";\r\n?>"
        }
    ]
}