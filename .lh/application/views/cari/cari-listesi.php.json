{
    "sourceFile": "application/views/cari/cari-listesi.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1756213970968,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1759746593682,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -681,26 +681,58 @@\n \r\n \r\n \t\t\t\t\t\t\t\t\t\t$cari_idsi = $cr->cari_id;\r\n \r\n+\t\t\t\t\t\t\t\t\t\t// Cari hareketleri sayfasındaki UNION sorgusu ile tutarlı hesaplama\r\n+\t\t\t\t\t\t\t\t\t\t$cariHareketleriQ = \"\r\n+\t\t\t\t\t\t\t\t\t\t\tSELECT \r\n+\t\t\t\t\t\t\t\t\t\t\t\tNULL    AS Borc,\r\n+\t\t\t\t\t\t\t\t\t\t\t\tCOALESCE(bh_giris, bh_cikis) AS Alacak\r\n+\t\t\t\t\t\t\t\t\t\t\tFROM bankahareketleri\r\n+\t\t\t\t\t\t\t\t\t\t\tWHERE bh_cariID = '$cari_idsi'\r\n \r\n+\t\t\t\t\t\t\t\t\t\t\tUNION ALL\r\n \r\n-\t\t\t\t\t\t\t\t\t\t$toplamBorcQ = \"SELECT SUM(ch_borc) AS toplamBorc FROM cariHareketleri WHERE ch_olusturanAnaHesap = '$anaHesap' AND ch_cariID = '$cari_idsi'\";\r\n+\t\t\t\t\t\t\t\t\t\t\tSELECT \r\n+\t\t\t\t\t\t\t\t\t\t\t\tNULL           AS Borc,\r\n+\t\t\t\t\t\t\t\t\t\t\t\tcek_tutar      AS Alacak\r\n+\t\t\t\t\t\t\t\t\t\t\tFROM cek\r\n+\t\t\t\t\t\t\t\t\t\t\tWHERE cek_cariID = '$cari_idsi'\r\n \r\n-\t\t\t\t\t\t\t\t\t\t$toplamBorcExe = $this->db->query($toplamBorcQ)->row();\r\n+\t\t\t\t\t\t\t\t\t\t\tUNION ALL\r\n \r\n+\t\t\t\t\t\t\t\t\t\t\tSELECT \r\n+\t\t\t\t\t\t\t\t\t\t\t\tNULL    AS Borc,\r\n+\t\t\t\t\t\t\t\t\t\t\t\tCOALESCE(kh_giris, kh_cikis) AS Alacak\r\n+\t\t\t\t\t\t\t\t\t\t\tFROM kasahareketleri\r\n+\t\t\t\t\t\t\t\t\t\t\tWHERE kh_cariID = '$cari_idsi'\r\n \r\n+\t\t\t\t\t\t\t\t\t\t\tUNION ALL\r\n \r\n-\t\t\t\t\t\t\t\t\t\t$toplamAlacakQ = \"SELECT SUM(ch_alacak) AS toplamAlacak FROM cariHareketleri WHERE ch_olusturanAnaHesap = '$anaHesap' AND ch_cariID = '$cari_idsi'\";\r\n+\t\t\t\t\t\t\t\t\t\t\tSELECT \r\n+\t\t\t\t\t\t\t\t\t\t\t\tNULL     AS Borc,\r\n+\t\t\t\t\t\t\t\t\t\t\t\tsenet_tutar AS Alacak\r\n+\t\t\t\t\t\t\t\t\t\t\tFROM senet\r\n+\t\t\t\t\t\t\t\t\t\t\tWHERE senet_cariID = '$cari_idsi'\r\n \r\n-\t\t\t\t\t\t\t\t\t\t$toplamAlacakExe = $this->db->query($toplamAlacakQ)->row();\r\n+\t\t\t\t\t\t\t\t\t\t\tUNION ALL\r\n \r\n-\r\n-\r\n-\t\t\t\t\t\t\t\t\t\t$toplamBorc = $toplamBorcExe->toplamBorc;\r\n-\r\n-\t\t\t\t\t\t\t\t\t\t$toplamAlacak = $toplamAlacakExe->toplamAlacak;\r\n-\r\n+\t\t\t\t\t\t\t\t\t\t\tSELECT\r\n+\t\t\t\t\t\t\t\t\t\t\t\tsatis_genelToplam  AS Borc,\r\n+\t\t\t\t\t\t\t\t\t\t\t\tNULL               AS Alacak\r\n+\t\t\t\t\t\t\t\t\t\t\tFROM satisfaturasi\r\n+\t\t\t\t\t\t\t\t\t\t\tWHERE satis_cariID = '$cari_idsi'\r\n+\t\t\t\t\t\t\t\t\t\t\";\r\n+\t\t\t\t\t\t\t\t\t\t\r\n+\t\t\t\t\t\t\t\t\t\t$hareketler = $this->db->query($cariHareketleriQ)->result();\r\n+\t\t\t\t\t\t\t\t\t\t\r\n+\t\t\t\t\t\t\t\t\t\t// Bakiye hesaplama\r\n+\t\t\t\t\t\t\t\t\t\t$toplamBorc = 0;\r\n+\t\t\t\t\t\t\t\t\t\t$toplamAlacak = 0;\r\n+\t\t\t\t\t\t\t\t\t\tforeach($hareketler as $hareket) {\r\n+\t\t\t\t\t\t\t\t\t\t\tif($hareket->Borc) $toplamBorc += $hareket->Borc;\r\n+\t\t\t\t\t\t\t\t\t\t\tif($hareket->Alacak) $toplamAlacak += $hareket->Alacak;\r\n+\t\t\t\t\t\t\t\t\t\t}\r\n \t\t\t\t\t\t\t\t\t\t$kalan = $toplamBorc - $toplamAlacak;\r\n \r\n \r\n \r\n@@ -929,22 +961,58 @@\n \t\t\t\t\t\t\t\t\t        \r\n \r\n \t\t\t\t\t\t\t\t\t        $cari_idsi = $cr->cari_id;\r\n \r\n-\t\t\t\t\t\t\t\t\t        $toplamBorcQ = \"SELECT SUM(ch_borc) AS toplamBorc FROM cariHareketleri WHERE ch_olusturanAnaHesap = '$anaHesap' AND ch_cariID = '$cari_idsi'\";\r\n+\t\t\t\t\t\t\t\t\t        // Cari hareketleri sayfasındaki UNION sorgusu ile tutarlı hesaplama\r\n+\t\t\t\t\t\t\t\t\t        $cariHareketleriQ = \"\r\n+\t\t\t\t\t\t\t\t\t            SELECT \r\n+\t\t\t\t\t\t\t\t\t                NULL    AS Borc,\r\n+\t\t\t\t\t\t\t\t\t                COALESCE(bh_giris, bh_cikis) AS Alacak\r\n+\t\t\t\t\t\t\t\t\t            FROM bankahareketleri\r\n+\t\t\t\t\t\t\t\t\t            WHERE bh_cariID = '$cari_idsi'\r\n \r\n-\t\t\t\t\t\t\t\t\t        $toplamBorcExe = $this->db->query($toplamBorcQ)->row();\r\n+\t\t\t\t\t\t\t\t\t            UNION ALL\r\n \r\n-\t\t\t\t\t\t\t\t\t        $toplamAlacakQ = \"SELECT SUM(ch_alacak) AS toplamAlacak FROM cariHareketleri WHERE ch_olusturanAnaHesap = '$anaHesap' AND ch_cariID = '$cari_idsi'\";\r\n+\t\t\t\t\t\t\t\t\t            SELECT \r\n+\t\t\t\t\t\t\t\t\t                NULL           AS Borc,\r\n+\t\t\t\t\t\t\t\t\t                cek_tutar      AS Alacak\r\n+\t\t\t\t\t\t\t\t\t            FROM cek\r\n+\t\t\t\t\t\t\t\t\t            WHERE cek_cariID = '$cari_idsi'\r\n \r\n-\t\t\t\t\t\t\t\t\t        $toplamAlacakExe = $this->db->query($toplamAlacakQ)->row();\r\n+\t\t\t\t\t\t\t\t\t            UNION ALL\r\n \r\n-\t\t\t\t\t\t\t\t\t        \r\n+\t\t\t\t\t\t\t\t\t            SELECT \r\n+\t\t\t\t\t\t\t\t\t                NULL    AS Borc,\r\n+\t\t\t\t\t\t\t\t\t                COALESCE(kh_giris, kh_cikis) AS Alacak\r\n+\t\t\t\t\t\t\t\t\t            FROM kasahareketleri\r\n+\t\t\t\t\t\t\t\t\t            WHERE kh_cariID = '$cari_idsi'\r\n \r\n-\t\t\t\t\t\t\t\t\t        $toplamBorc = $toplamBorcExe->toplamBorc;\r\n+\t\t\t\t\t\t\t\t\t            UNION ALL\r\n \r\n-\t\t\t\t\t\t\t\t\t        $toplamAlacak = $toplamAlacakExe->toplamAlacak;\r\n+\t\t\t\t\t\t\t\t\t            SELECT \r\n+\t\t\t\t\t\t\t\t\t                NULL     AS Borc,\r\n+\t\t\t\t\t\t\t\t\t                senet_tutar AS Alacak\r\n+\t\t\t\t\t\t\t\t\t            FROM senet\r\n+\t\t\t\t\t\t\t\t\t            WHERE senet_cariID = '$cari_idsi'\r\n \r\n+\t\t\t\t\t\t\t\t\t            UNION ALL\r\n+\r\n+\t\t\t\t\t\t\t\t\t            SELECT\r\n+\t\t\t\t\t\t\t\t\t                satis_genelToplam  AS Borc,\r\n+\t\t\t\t\t\t\t\t\t                NULL               AS Alacak\r\n+\t\t\t\t\t\t\t\t\t            FROM satisfaturasi\r\n+\t\t\t\t\t\t\t\t\t            WHERE satis_cariID = '$cari_idsi'\r\n+\t\t\t\t\t\t\t\t\t        \";\r\n+\t\t\t\t\t\t\t\t\t        \r\n+\t\t\t\t\t\t\t\t\t        $hareketler = $this->db->query($cariHareketleriQ)->result();\r\n+\t\t\t\t\t\t\t\t\t        \r\n+\t\t\t\t\t\t\t\t\t        // Bakiye hesaplama\r\n+\t\t\t\t\t\t\t\t\t        $toplamBorc = 0;\r\n+\t\t\t\t\t\t\t\t\t        $toplamAlacak = 0;\r\n+\t\t\t\t\t\t\t\t\t        foreach($hareketler as $hareket) {\r\n+\t\t\t\t\t\t\t\t\t            if($hareket->Borc) $toplamBorc += $hareket->Borc;\r\n+\t\t\t\t\t\t\t\t\t            if($hareket->Alacak) $toplamAlacak += $hareket->Alacak;\r\n+\t\t\t\t\t\t\t\t\t        }\r\n \t\t\t\t\t\t\t\t\t        $kalan = $toplamBorc - $toplamAlacak;\r\n \r\n \t\t\t\t\t\t\t\t\t        $kalann = abs($kalan);\r\n \r\n"
                },
                {
                    "date": 1759748248191,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -564,10 +564,46 @@\n \r\n \t\t\t\t$qs = \"?\" . $_SERVER['QUERY_STRING'];\r\n \r\n \t\t\t}\r\n-\r\n \t\t\t?>\r\n+\t\t\t\r\n+\t\t\t<!-- İstatistik Kutucukları -->\r\n+\t\t\t<div class=\"row mb-4\">\r\n+\t\t\t\t<div class=\"col-md-6\">\r\n+\t\t\t\t\t<div class=\"card border-left-primary shadow h-100 py-2\">\r\n+\t\t\t\t\t\t<div class=\"card-body\">\r\n+\t\t\t\t\t\t\t<div class=\"row no-gutters align-items-center\">\r\n+\t\t\t\t\t\t\t\t<div class=\"col mr-2\">\r\n+\t\t\t\t\t\t\t\t\t<div class=\"text-xs font-weight-bold text-primary text-uppercase mb-1\">\r\n+\t\t\t\t\t\t\t\t\t\tToplam Kayıt Sayısı</div>\r\n+\t\t\t\t\t\t\t\t\t<div class=\"h5 mb-0 font-weight-bold text-gray-800\"><?= number_format($count_of_list, 0, ',', '.'); ?></div>\r\n+\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t<div class=\"col-auto\">\r\n+\t\t\t\t\t\t\t\t\t<i class=\"fas fa-users fa-2x text-gray-300\"></i>\r\n+\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</div>\r\n+\t\t\t\t</div>\r\n+\t\t\t\t<div class=\"col-md-6\">\r\n+\t\t\t\t\t<div class=\"card border-left-success shadow h-100 py-2\">\r\n+\t\t\t\t\t\t<div class=\"card-body\">\r\n+\t\t\t\t\t\t\t<div class=\"row no-gutters align-items-center\">\r\n+\t\t\t\t\t\t\t\t<div class=\"col mr-2\">\r\n+\t\t\t\t\t\t\t\t\t<div class=\"text-xs font-weight-bold text-success text-uppercase mb-1\">\r\n+\t\t\t\t\t\t\t\t\t\tToplam Tutar (Satış Faturaları)</div>\r\n+\t\t\t\t\t\t\t\t\t<div class=\"h5 mb-0 font-weight-bold text-gray-800\"><?= number_format($toplamSatisTutar, 2, ',', '.'); ?> ₺</div>\r\n+\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t\t<div class=\"col-auto\">\r\n+\t\t\t\t\t\t\t\t\t<i class=\"fas fa-file-invoice fa-2x text-gray-300\"></i>\r\n+\t\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t\t</div>\r\n+\t\t\t\t\t</div>\r\n+\t\t\t\t</div>\r\n+\t\t\t</div>\r\n+\t\t\t<!-- /İstatistik Kutucukları -->\r\n \r\n \t\t\t<div class=\"row\">\r\n \r\n \r\n"
                }
            ],
            "date": 1756213970968,
            "name": "Commit-0",
            "content": "<!DOCTYPE html>\r\n\r\n<html lang=\"tr\">\r\n\r\n\r\n\r\n<head>\r\n\r\n\t<?php $this->load->view(\"include/head-tags\"); ?>\t<style>\r\n\r\n\t.btn.text-danger, .btn.btn-white.text-danger, .btn.btn-danger, .btn-danger {\r\n\r\n\t\tcolor: #fff !important;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t/* Görsel ve Evrak kolonları için stil */\r\n\r\n\t.gorsel-column, .evrak-column {\r\n\r\n\t\twidth: 80px;\r\n\r\n\t\ttext-align: center;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.gorsel-thumbnail {\r\n\r\n\t\twidth: 50px;\r\n\r\n\t\theight: 50px;\r\n\r\n\t\tobject-fit: cover;\r\n\r\n\t\tborder-radius: 5px;\r\n\r\n\t\tcursor: pointer;\r\n\r\n\t\tborder: 2px solid #e0e0e0;\r\n\r\n\t\ttransition: all 0.3s ease;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.gorsel-thumbnail:hover {\r\n\r\n\t\tborder-color: #007bff;\r\n\r\n\t\ttransform: scale(1.1);\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.badge-overlay {\r\n\r\n\t\tposition: relative;\r\n\r\n\t\tdisplay: inline-block;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.badge-overlay .badge {\r\n\r\n\t\tposition: absolute;\r\n\r\n\t\ttop: -5px;\r\n\r\n\t\tright: -5px;\r\n\r\n\t\tfont-size: 10px;\r\n\r\n\t\tmin-width: 18px;\r\n\r\n\t\theight: 18px;\r\n\r\n\t\tline-height: 18px;\r\n\r\n\t\tborder-radius: 9px;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.evrak-btn {\r\n\r\n\t\tmin-width: 50px;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.gorsel-btn {\r\n\r\n\t\tmin-width: 50px;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t/* Modal için stil */\r\n\r\n\t.carousel-item img {\r\n\r\n\t\tmax-height: 400px;\r\n\r\n\t\tobject-fit: contain;\r\n\r\n\t\twidth: 100%;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.list-group-item:hover {\r\n\r\n\t\tbackground-color: #f8f9fa;\r\n\r\n\t}\r\n\r\n\t/* Mobile Card View Styles */\r\n\r\n\t.mobile-customer-card {\r\n\r\n\t\tbackground: #fff;\r\n\r\n\t\tborder: 1px solid #e0e0e0;\r\n\r\n\t\tborder-radius: 8px;\r\n\r\n\t\tmargin-bottom: 15px;\r\n\r\n\t\tpadding: 15px;\r\n\r\n\t\tbox-shadow: 0 2px 4px rgba(0,0,0,0.1);\r\n\r\n\t\tcursor: pointer;\r\n\r\n\t\ttransition: all 0.3s ease;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.mobile-customer-card:hover {\r\n\r\n\t\tbox-shadow: 0 4px 8px rgba(0,0,0,0.15);\r\n\r\n\t\ttransform: translateY(-2px);\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.mobile-customer-card .card-header-info {\r\n\r\n\t\tdisplay: flex;\r\n\r\n\t\tjustify-content: space-between;\r\n\r\n\t\talign-items: center;\r\n\r\n\t\tmargin-bottom: 10px;\r\n\r\n\t\tpadding-bottom: 8px;\r\n\r\n\t\tborder-bottom: 1px solid #f0f0f0;\r\n\r\n\t\tposition: relative;\r\n\r\n\t}\r\n\r\n\t\t.mobile-customer-card .card-header-info::after {\r\n\r\n\t\tcontent: '\\f107';\r\n\r\n\t\tfont-family: 'Font Awesome 5 Free';\r\n\r\n\t\tfont-weight: 900;\r\n\r\n\t\tposition: absolute;\r\n\r\n\t\tright: 0;\r\n\r\n\t\ttop: 50%;\r\n\r\n\t\ttransform: translateY(-50%);\r\n\r\n\t\tcolor: #999;\r\n\r\n\t\tfont-size: 14px;\r\n\r\n\t\ttransition: transform 0.3s ease;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.mobile-customer-card.expanded .card-header-info::after {\r\n\r\n\t\ttransform: translateY(-50%) rotate(180deg);\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.mobile-customer-card .card-details {\r\n\r\n\t\tmax-height: 0;\r\n\r\n\t\toverflow: hidden;\r\n\r\n\t\ttransition: max-height 0.3s ease;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.mobile-customer-card.expanded .card-details {\r\n\r\n\t\tmax-height: 1000px;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.mobile-customer-card .customer-name {\r\n\r\n\t\tfont-weight: bold;\r\n\r\n\t\tcolor: #333;\r\n\r\n\t\tfont-size: 16px;\r\n\r\n\t\tmargin: 0;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.mobile-customer-card .customer-type {\r\n\r\n\t\tbackground: #007bff;\r\n\r\n\t\tcolor: white;\r\n\r\n\t\tpadding: 4px 8px;\r\n\r\n\t\tborder-radius: 12px;\r\n\r\n\t\tfont-size: 11px;\r\n\r\n\t\ttext-transform: uppercase;\r\n\r\n\t}\r\n\r\n\t\t.mobile-customer-card .customer-details {\r\n\r\n\t\tdisplay: grid;\r\n\r\n\t\tgrid-template-columns: 1fr 1fr;\r\n\r\n\t\tgap: 8px;\r\n\r\n\t\tfont-size: 13px;\r\n\r\n\t\tmargin-bottom: 10px;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.mobile-customer-card .detail-item {\r\n\r\n\t\tdisplay: flex;\r\n\r\n\t\tflex-direction: column;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.mobile-customer-card .detail-label {\r\n\r\n\t\tfont-weight: 600;\r\n\r\n\t\tcolor: #666;\r\n\r\n\t\tfont-size: 11px;\r\n\r\n\t\ttext-transform: uppercase;\r\n\r\n\t\tmargin-bottom: 2px;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.mobile-customer-card .detail-value {\r\n\r\n\t\tcolor: #333;\r\n\r\n\t\tword-break: break-word;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.mobile-customer-card .media-section {\r\n\r\n\t\tdisplay: flex;\r\n\r\n\t\tjustify-content: space-between;\r\n\r\n\t\talign-items: center;\r\n\r\n\t\tmargin-bottom: 10px;\r\n\r\n\t\tpadding: 8px;\r\n\r\n\t\tbackground: #f8f9fa;\r\n\r\n\t\tborder-radius: 6px;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.mobile-customer-card .media-item {\r\n\r\n\t\tdisplay: flex;\r\n\r\n\t\talign-items: center;\r\n\r\n\t\tfont-size: 12px;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.mobile-customer-card .media-item i {\r\n\r\n\t\tmargin-right: 5px;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.mobile-customer-card .balance-section {\r\n\r\n\t\ttext-align: center;\r\n\r\n\t\tmargin-bottom: 10px;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.mobile-customer-card .action-buttons {\r\n\r\n\t\tdisplay: flex;\r\n\r\n\t\tgap: 5px;\r\n\r\n\t\tflex-wrap: wrap;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.mobile-customer-card .action-buttons .btn {\r\n\r\n\t\tflex: 1;\r\n\r\n\t\tmin-width: 80px;\r\n\r\n\t\tfont-size: 11px;\r\n\r\n\t\tpadding: 6px 8px;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t\t/* Mobilde Önceki Sayfa butonunu gizle */\r\n\r\n\t@media (max-width: 767.98px) {\r\n\r\n\t\t.col-sm-2 {\r\n\r\n\t\t\tdisplay: none !important;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t/* Mobilde görsel ve evrak kolonu boyutlarını ayarla */\r\n\r\n\t\t.gorsel-column, .evrak-column {\r\n\r\n\t\t\twidth: 60px;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.gorsel-thumbnail {\r\n\r\n\t\t\twidth: 40px;\r\n\r\n\t\t\theight: 40px;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t/* Mobilde düzenle butonunu en sola taşı */\r\n\r\n\t\t.mobile-edit-first {\r\n\r\n\t\t\torder: -1;\r\n\r\n\t\t}\r\n\r\n\t\t\t\t.action-buttons {\r\n\r\n\t\t\tdisplay: flex;\r\n\r\n\t\t\tflex-wrap: wrap;\r\n\r\n\t\t\tgap: 5px;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t/* Mor renk düzenle butonu */\r\n\r\n\t.btn-purple {\r\n\r\n\t\tbackground-color: #6f42c1;\r\n\r\n\t\tborder-color: #6f42c1;\r\n\r\n\t\tcolor: white;\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t.btn-purple:hover {\r\n\r\n\t\tbackground-color: #5a2d91;\r\n\r\n\t\tborder-color: #5a2d91;\r\n\r\n\t\tcolor: white;\r\n\r\n\t}\r\n\r\n\t</style>\r\n\r\n</head>\r\n\r\n<body>\r\n\r\n\r\n\r\n<!-- Main Wrapper -->\r\n\r\n<div class=\"main-wrapper\">\r\n\r\n\r\n\r\n\t<!-- Header -->\r\n\r\n\t<?php $this->load->view(\"include/header\"); ?>\r\n\r\n\t<!-- /Header -->\r\n\r\n\r\n\r\n\t<!-- Sidebar -->\r\n\r\n\t<?php $this->load->view(\"include/sidebar\"); ?>\r\n\r\n\t<!-- /Sidebar -->\r\n\r\n\r\n\r\n\t<!-- Page Wrapper -->\r\n\r\n\t<div class=\"page-wrapper\">\r\n\r\n\t\t<div class=\"content container-fluid\">\r\n\r\n\r\n\r\n\t\t\t<!-- Page Header -->\r\n\r\n\r\n\r\n\t\t\t<?php\r\n\r\n\r\n\r\n\t\t\t$firma = getirFirma();\r\n\r\n\t\t\t$deletePermission = $firma->ayarlar_deletePermission;\r\n\r\n\t\t\t?>\r\n\r\n\t\t\t<div class=\"page-header\">\r\n\r\n\t\t\t\t<div class=\"row\">\r\n\r\n\t\t\t\t\t<div class=\"col-sm-10\">\r\n\r\n\t\t\t\t\t\t<h3 class=\"page-title\">Müşteri Listesi</h3>\r\n\r\n\t\t\t\t\t\t<ul class=\"breadcrumb\">\r\n\r\n\t\t\t\t\t\t\t<li class=\"breadcrumb-item\"><a href=\"<?= base_url(); ?>\">Anasayfa</a>\r\n\r\n\t\t\t\t\t\t\t</li>\r\n\r\n\t\t\t\t\t\t\t<li class=\"breadcrumb-item\">Müşteri\r\n\r\n\t\t\t\t\t\t\t</li>\r\n\r\n\t\t\t\t\t\t\t<li class=\"breadcrumb-item active\">Müşteri Listesi</li>\r\n\r\n\t\t\t\t\t\t</ul>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"d-flex justify-content-end text-align-center col-sm-2\">\r\n\r\n\t\t\t\t\t\t<a class=\"btn btn-outline-light\" href=\"javascript:history.back()\"><i class=\"fa fa-history\"></i>\r\n\r\n\t\t\t\t\t\t\t<br>Önceki Sayfa</a>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t\t<!-- /Page Header -->\r\n\r\n\t\t\t<?php\r\n\r\n\t\t\tif ($_SERVER['QUERY_STRING']) {\r\n\r\n\t\t\t\t$qs = \"?\" . $_SERVER['QUERY_STRING'];\r\n\r\n\t\t\t}\r\n\r\n\t\t\t?>\r\n\r\n\t\t\t<div class=\"row\">\r\n\r\n\r\n\r\n\t\t\t\t<div class=\"col-xl-12 col-md-12\">\r\n\r\n\t\t\t\t\t<div class=\"card card-table\">\r\n\r\n\t\t\t\t\t\t<div class=\"card-header\">\r\n\r\n\t\t\t\t\t\t\t<div class=\"row\">\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"col\">\r\n\r\n\t\t\t\t\t\t\t\t\t<h5 class=\"card-title\">Müşteri Listesi</h5>\r\n\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"col-auto\">\r\n\r\n\t\t\t\t\t\t\t\t\t<a href=\"<?= base_url(\"cari/cariListesiExcel$qs\"); ?>\"\r\n\r\n\t\t\t\t\t\t\t\t\t   class=\"btn btn-outline-success btn-sm\"\r\n\r\n\t\t\t\t\t\t\t\t\t   style='font-family: Arial, Helvetica, sans-serif;'><i\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"fa fa-file-excel\"></i> Dışa aktar</a>\r\n\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"col-auto\">\r\n\r\n\t\t\t\t\t\t\t\t\t<a href=\"javascript:void(0);\" class=\"btn btn-outline-danger btn-sm\"\r\n\r\n\t\t\t\t\t\t\t\t\t   data-toggle=\"modal\" data-target=\"#add_category\"><i class=\"fa fa-search\"></i>\r\n\r\n\t\t\t\t\t\t\t\t\t\tArama</a>\r\n\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class=\"card-body\">\r\n\r\n\t\t\t\t\t\t\t<!-- Desktop Table View -->\r\n\r\n\t\t\t\t\t\t\t<div class=\"table-responsive d-none d-md-block\">\r\n\r\n\t\t\t\t\t\t\t\t<table class=\"table table-striped custom-table mb-0\">\t\t\t\t\t\t\t\t\t<thead>\t\t\t\t\t\t\t\t\t<tr>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<th>Cari Adı</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<th>Cari Tipi</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<th>İşlemi Yapan</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<th>İlçe</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<th>İl</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<th class=\"gorsel-column\">İşletme Görsel</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<th class=\"evrak-column\">Evrak</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<th>B/A</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<th class=\"text-right\">İşlem</th>\r\n\r\n\t\t\t\t\t\t\t\t\t</tr>\r\n\r\n\t\t\t\t\t\t\t\t\t</thead>\r\n\r\n\t\t\t\t\t\t\t\t\t<tbody>\r\n\r\n\t\t\t\t\t\t\t\t\t<?php \r\n\r\n\t\t\t\t\t\t\t\t\t    $tumBorc=0;\r\n\r\n\t\t\t\t\t\t\t\t\t    $tumAlacak=0;\r\n\r\n\t\t\t\t\t\t\t\t\t    foreach ($cari as $cr) {\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t$anaHesap = anaHesapBilgisi();\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t$alias_pk = $cr->cari_alias;\t\t\t\t\t\t\t\t\t\t$grubuq = \"SELECT * FROM cariGruplari WHERE cariGrup_id = '$cr->cari_cariGrupKoduID'\";\r\n\r\n\t\t\t\t\t\t\t\t\t\t$grubuexe = $this->db->query($grubuq)->row();\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t$ilq = \"SELECT * FROM iller WHERE id='$cr->cari_il'\";\r\n\r\n\t\t\t\t\t\t\t\t\t\t$ilexe = $this->db->query($ilq)->row();\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t$ilceq = \"SELECT * FROM ilceler WHERE id='$cr->cari_ilce'\";\r\n\r\n\t\t\t\t\t\t\t\t\t\t$ilceexe = $this->db->query($ilceq)->row();\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t// Cari oluşturan kullanıcı bilgisini çek\r\n\r\n\t\t\t\t\t\t\t\t\t\t$kullaniciQ = \"SELECT CONCAT(kullanici_ad, ' ', kullanici_soyad) as tam_ad FROM kullanicilar WHERE kullanici_id = '$cr->cari_olusturan'\";\r\n\r\n\t\t\t\t\t\t\t\t\t\t$kullaniciExe = $this->db->query($kullaniciQ)->row();\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t$cari_idsi = $cr->cari_id;\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t$toplamBorcQ = \"SELECT SUM(ch_borc) AS toplamBorc FROM cariHareketleri WHERE ch_olusturanAnaHesap = '$anaHesap' AND ch_cariID = '$cari_idsi'\";\r\n\r\n\t\t\t\t\t\t\t\t\t\t$toplamBorcExe = $this->db->query($toplamBorcQ)->row();\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t$toplamAlacakQ = \"SELECT SUM(ch_alacak) AS toplamAlacak FROM cariHareketleri WHERE ch_olusturanAnaHesap = '$anaHesap' AND ch_cariID = '$cari_idsi'\";\r\n\r\n\t\t\t\t\t\t\t\t\t\t$toplamAlacakExe = $this->db->query($toplamAlacakQ)->row();\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t$toplamBorc = $toplamBorcExe->toplamBorc;\r\n\r\n\t\t\t\t\t\t\t\t\t\t$toplamAlacak = $toplamAlacakExe->toplamAlacak;\r\n\r\n\t\t\t\t\t\t\t\t\t\t$kalan = $toplamBorc - $toplamAlacak;\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t$kalann = abs($kalan);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (filter_var($kalan, FILTER_VALIDATE_FLOAT) && $kalan > 0) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t$bakiye = '<a href=\"javascript:void(0);\" class=\"btn btn-outline-success btn-sm\">' . number_format($kalann, 2,\",\",\".\") . ' ₺ (B)</a>';\r\n\r\n\t\t\t\t\t\t\t\t\t\t$tumBorc += $kalann;\r\n\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t$bakiye = '<a href=\"javascript:void(0);\" class=\"btn btn-outline-danger btn-sm\">' . number_format($kalann, 2,\",\",\".\") . ' ₺ (A)</a>';\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t\t\t$tumAlacak += $kalann;\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n                                        $toplamBakiye += $kalann;\r\n\r\n\t\t\t\t\t\t\t\t\t\t?>\t\t\t\t\t\t\t\t\t\t<tr>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif ($alias_pk != \"\") {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\techo \"<i class='fa fa-file-invoice text-dark' data-toggle='tooltip' data-placement='top' title='e-Fatura'></i>\";\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t$lengthOfCariAd = strlen($cr->cari_ad);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif ($lengthOfCariAd >= 24) { ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span data-toggle=\"tooltip\" data-placement=\"top\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  title=\"<?= $cr->cari_ad; ?>\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  style=\"cursor:help;\"><?php echo mb_substr($cr->cari_ad, 0, 24) . '...'; ?></span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php } else {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\techo $cr->cari_ad;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t} ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td><?php $cariTipi = $cr->cari_bireysel;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif ($cariTipi == 1) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\techo \"Bireysel\";\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t} elseif ($cariTipi == 0) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\techo \"Kurumsal\";\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t} elseif ($cariTipi == 2) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\techo \"Diğer\";\t\t\t\t\t\t\t\t\t\t\t\t} ?></td>\t\t\t\t\t\t\t\t\t\t\t<td><?= $kullaniciExe ? $kullaniciExe->tam_ad : 'Bilinmiyor'; ?></td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td><?= $ilceexe ? $ilceexe->ilce : ''; ?></td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td><?= $ilexe->il; ?></td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"gorsel-column\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php if (!empty($cr->fotograf_dosya)): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?php \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$fotograflar = explode(',', $cr->fotograf_dosya);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<button type=\"button\" \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"btn btn-sm btn-outline-success gorsel-btn\" \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"<?= count($fotograflar) ?> görsel\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonclick=\"window.open('<?= base_url(\"cari/gorselGoster/\" . $cr->cari_id); ?>', 'gorselPencere', 'width=800,height=600,scrollbars=yes,resizable=yes')\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-image\"></i> <?= count($fotograflar) ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php else: ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-image text-muted\" title=\"Görsel yok\"></i>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"evrak-column\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php if (!empty($cr->evrak_dosya)): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?php \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$evraklar = explode(',', $cr->evrak_dosya);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t?>\t\t\t\t\t\t\t\t\t\t\t\t\t<button type=\"button\" \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"btn btn-sm btn-outline-primary evrak-btn\" \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"<?= count($evraklar) ?> evrak\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonclick=\"window.open('<?= base_url(\"cari/evrakGoster/\" . $cr->cari_id); ?>', 'evrakPencere', 'width=800,height=600,scrollbars=yes,resizable=yes')\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-file\"></i> <?= count($evraklar) ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php else: ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-file text-muted\" title=\"Evrak yok\"></i>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td><?= $bakiye; ?></td>\t\t\t\t\t\t\t\t\t\t\t<td class=\"text-right\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"action-buttons\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?php if (grup_modul_yetkisi_var(120, 3)): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"<?= base_url(\"cari/cari-karti-duzenle/$cr->cari_id\"); ?>\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t   class=\"btn btn-sm btn-purple mobile-edit-first mr-2\" title=\"Düzenle\"><i\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"far fa-edit\"></i></a>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"<?= base_url(\"cari/cari-hareketleri?cari=$cr->cari_id\"); ?>\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t   class=\"btn btn-sm btn-white text-info mr-2\"><i\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"far fa-eye mr-1\"></i>Cari Hareketleri</a>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?php if ($deletePermission == 1 && grup_modul_yetkisi_var(120, 4)) { ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"javascript:void(0);\" data-toggle=\"modal\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   data-target=\"#cari_sil\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   onclick=\"document.getElementById('cari_id').value='<?= $cr->cari_id ?>';document.getElementById('cari_ad').innerHTML='Cari kodu <?= $cr->cari_kodu ?> olan cariyi pasif hale getirmek istediğinizden emin misiniz?';\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   class=\"btn btn-sm btn-white text-danger mr-2\"><i\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"far fa-trash-alt mr-1\"></i> Sil</a>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?php } ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<!--\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"#\" data-toggle=\"modal\" data-target=\"#edit_category\" class=\"btn btn-sm btn-white text-success mr-2\"><i class=\"far fa-edit mr-1\"></i> Düzenle</a>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"#\" data-toggle=\"modal\" data-target=\"#delete_category\" class=\"btn btn-sm btn-white text-danger mr-2\"><i class=\"far fa-trash-alt mr-1\"></i>Sil</a>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t-->\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t</tr>\r\n\r\n\t\t\t\t\t\t\t\t\t<?php } ?>\r\n\r\n\t\t\t\t\t\t\t\t\t</tbody>\r\n\r\n\t\t\t\t\t\t\t\t</table>\t\t\t\t\t\t\t\t<hr>\r\n\r\n\t\t\t\t\t\t\t\t<span style=\"margin-left:15px;\">Toplam kayıt sayısı: <b><?= $count_of_list; ?></b></span>\r\n\r\n\t\t\t\t\t\t\t\t<span style=\"margin-left:15px;\">Toplam borç: <b><?= number_format($tumBorc, 2,\",\",\".\"); ?></b></span>\r\n\r\n\t\t\t\t\t\t\t\t<span style=\"margin-left:15px;\">Toplam alacak: <b><?= number_format($tumAlacak, 2,\",\",\".\"); ?></b></span>\r\n\r\n\t\t\t\t\t\t\t\t<br><br>\r\n\r\n\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<!-- Mobile Card View -->\r\n\r\n\t\t\t\t\t\t\t<div class=\"d-block d-md-none\" id=\"card-view\">\r\n\r\n\t\t\t\t\t\t\t\t<?php if(isset($cari) && count($cari) > 0): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t<?php \r\n\r\n\t\t\t\t\t\t\t\t\t    $tumBorcCard = 0;\r\n\r\n\t\t\t\t\t\t\t\t\t    $tumAlacakCard = 0;\r\n\r\n\t\t\t\t\t\t\t\t\t    foreach ($cari as $cr): \r\n\r\n\t\t\t\t\t\t\t\t\t        $anaHesap = anaHesapBilgisi();\r\n\r\n\t\t\t\t\t\t\t\t\t        $alias_pk = $cr->cari_alias;\r\n\r\n\t\t\t\t\t\t\t\t\t        $grubuq = \"SELECT * FROM cariGruplari WHERE cariGrup_id = '$cr->cari_cariGrupKoduID'\";\r\n\r\n\t\t\t\t\t\t\t\t\t        $grubuexe = $this->db->query($grubuq)->row();\r\n\r\n\t\t\t\t\t\t\t\t\t        $ilq = \"SELECT * FROM iller WHERE id='$cr->cari_il'\";\r\n\r\n\t\t\t\t\t\t\t\t\t        $ilexe = $this->db->query($ilq)->row();\r\n\r\n\t\t\t\t\t\t\t\t\t        \r\n\r\n\t\t\t\t\t\t\t\t\t        $cari_idsi = $cr->cari_id;\r\n\r\n\t\t\t\t\t\t\t\t\t        $toplamBorcQ = \"SELECT SUM(ch_borc) AS toplamBorc FROM cariHareketleri WHERE ch_olusturanAnaHesap = '$anaHesap' AND ch_cariID = '$cari_idsi'\";\r\n\r\n\t\t\t\t\t\t\t\t\t        $toplamBorcExe = $this->db->query($toplamBorcQ)->row();\r\n\r\n\t\t\t\t\t\t\t\t\t        $toplamAlacakQ = \"SELECT SUM(ch_alacak) AS toplamAlacak FROM cariHareketleri WHERE ch_olusturanAnaHesap = '$anaHesap' AND ch_cariID = '$cari_idsi'\";\r\n\r\n\t\t\t\t\t\t\t\t\t        $toplamAlacakExe = $this->db->query($toplamAlacakQ)->row();\r\n\r\n\t\t\t\t\t\t\t\t\t        \r\n\r\n\t\t\t\t\t\t\t\t\t        $toplamBorc = $toplamBorcExe->toplamBorc;\r\n\r\n\t\t\t\t\t\t\t\t\t        $toplamAlacak = $toplamAlacakExe->toplamAlacak;\r\n\r\n\t\t\t\t\t\t\t\t\t        $kalan = $toplamBorc - $toplamAlacak;\r\n\r\n\t\t\t\t\t\t\t\t\t        $kalann = abs($kalan);\r\n\r\n\t\t\t\t\t\t\t\t\t        \r\n\r\n\t\t\t\t\t\t\t\t\t        if (filter_var($kalan, FILTER_VALIDATE_FLOAT) && $kalan > 0) {\r\n\r\n\t\t\t\t\t\t\t\t\t            $bakiye = '<span class=\"btn btn-outline-success btn-sm\">' . number_format($kalann, 2,\",\",\".\") . ' ₺ (B)</span>';\r\n\r\n\t\t\t\t\t\t\t\t\t            $tumBorcCard += $kalann;\r\n\r\n\t\t\t\t\t\t\t\t\t        } else {\r\n\r\n\t\t\t\t\t\t\t\t\t            $bakiye = '<span class=\"btn btn-outline-danger btn-sm\">' . number_format($kalann, 2,\",\",\".\") . ' ₺ (A)</span>';\r\n\r\n\t\t\t\t\t\t\t\t\t            $tumAlacakCard += $kalann;\r\n\r\n\t\t\t\t\t\t\t\t\t        }\r\n\r\n\t\t\t\t\t\t\t\t\t?>\t\t\t\t\t\t\t\t\t<div class=\"mobile-customer-card\" data-cari-id=\"<?= $cr->cari_id; ?>\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"card-header-info\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<h6 class=\"customer-name\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php if ($alias_pk != \"\"): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i class='fa fa-file-invoice text-dark' data-toggle='tooltip' data-placement='top' title='e-Fatura'></i>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?= strlen($cr->cari_ad) >= 30 ? mb_substr($cr->cari_ad, 0, 30) . '...' : $cr->cari_ad; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</h6>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"customer-type\" style=\"<?php \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (filter_var($kalan, FILTER_VALIDATE_FLOAT) && $kalan > 0) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\techo 'background: #28a745;'; // Yeşil (Borç)\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\techo 'background: #dc3545;'; // Kırmızı (Alacak)\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t?>\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?= number_format($kalann, 2,\",\",\".\") . ' ₺ (' . (filter_var($kalan, FILTER_VALIDATE_FLOAT) && $kalan > 0 ? 'B' : 'A') . ')'; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"card-details\">\t\t\t\t\t\t\t\t\t\t\t<div class=\"customer-details\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"detail-item\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"detail-label\">İşlemi Yapan</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"detail-value\"><?= $kullaniciExe ? $kullaniciExe->tam_ad : 'Bilinmiyor'; ?></span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"detail-item\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"detail-label\">İlçe</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"detail-value\"><?= $ilceexe ? $ilceexe->ilce : '-'; ?></span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"detail-item\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"detail-label\">İl</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"detail-value\"><?= $ilexe->il; ?></span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"detail-item\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"detail-label\">Cari Tipi</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"detail-value\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$cariTipi = $cr->cari_bireysel;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif ($cariTipi == 1) echo \"Bireysel\";\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telseif ($cariTipi == 0) echo \"Kurumsal\";\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telseif ($cariTipi == 2) echo \"Diğer\";\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<!-- Media Section -->\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"media-section\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"media-item\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php if (!empty($cr->fotograf_dosya)): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?php \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$fotograflar = explode(',', $cr->fotograf_dosya);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<button type=\"button\" \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"btn btn-sm btn-outline-success gorsel-btn\" \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"padding: 4px 8px; font-size: 10px;\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonclick=\"window.open('<?= base_url(\"cari/gorselGoster/\" . $cr->cari_id); ?>', 'gorselPencere', 'width=800,height=600,scrollbars=yes,resizable=yes')\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-image\"></i> <?= count($fotograflar) ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php else: ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-image text-muted\"></i>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-muted\">Görsel yok</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"media-item\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php if (!empty($cr->evrak_dosya)): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?php \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$evraklar = explode(',', $cr->evrak_dosya);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<button type=\"button\" \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"btn btn-sm btn-outline-primary evrak-btn\" \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"padding: 4px 8px; font-size: 10px;\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonclick=\"window.open('<?= base_url(\"cari/evrakGoster/\" . $cr->cari_id); ?>', 'evrakPencere', 'width=800,height=600,scrollbars=yes,resizable=yes')\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-file\"></i> <?= count($evraklar) ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php else: ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-file text-muted\"></i>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-muted\">Evrak yok</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<!-- Action Buttons -->\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"action-buttons\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php if (grup_modul_yetkisi_var(120, 3)): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"<?= base_url(\"cari/cari-karti-duzenle/$cr->cari_id\"); ?>\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t   class=\"btn btn-sm btn-purple\" title=\"Düzenle\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t   <i class=\"far fa-edit\"></i>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"<?= base_url(\"cari/cari-hareketleri?cari=$cr->cari_id\"); ?>\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t   class=\"btn btn-sm btn-outline-info\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t   <i class=\"far fa-eye\"></i> Hareketler\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php if ($deletePermission == 1 && grup_modul_yetkisi_var(120, 4)): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"javascript:void(0);\" data-toggle=\"modal\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t   data-target=\"#cari_sil\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t   onclick=\"document.getElementById('cari_id').value='<?= $cr->cari_id ?>';document.getElementById('cari_ad').innerHTML='Cari kodu <?= $cr->cari_kodu ?> olan cariyi pasif hale getirmek istediğinizden emin misiniz?';\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t   class=\"btn btn-sm btn-outline-danger\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t   <i class=\"far fa-trash-alt\"></i>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t<?php endforeach; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t\t<!-- Card View Summary -->\r\n\r\n\t\t\t\t\t\t\t\t\t<div class=\"mt-3 p-3\" style=\"background: #f8f9fa; border-radius: 8px;\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"row text-center\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"col-4\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<strong>Toplam Kayıt</strong><br>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-primary\"><?= $count_of_list; ?></span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"col-4\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<strong>Toplam Borç</strong><br>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-success\"><?= number_format($tumBorcCard, 2,\",\",\".\"); ?></span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"col-4\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<strong>Toplam Alacak</strong><br>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-danger\"><?= number_format($tumAlacakCard, 2,\",\",\".\"); ?></span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<?php else: ?>\r\n\r\n\t\t\t\t\t\t\t\t\t<div class=\"text-center text-muted p-4\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-users fa-3x mb-3\"></i>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<p>Kayıt bulunamadı.</p>\r\n\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<?php echo $links; ?>\r\n\r\n\t\t\t\t\t<br><br>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t</div>\r\n\r\n\t</div>\r\n\r\n\t<!-- /Page Wrapper -->\r\n\r\n\t<?php\r\n\r\n\t$cariKodu = $this->input->get('cariKodu');\r\n\r\n\t$cariAdi = $this->input->get('cariAdi');\r\n\r\n\t$cariTipi = $this->input->get('bireysel');\r\n\r\n\t$islemYapan = $this->input->get('islemYapan');\r\n\r\n\t$bulunduguIl = $this->input->get('bulunduguIl');\r\n\r\n\t$tarihAraligi = $this->input->get('tarihAraligi');\r\n\r\n\t?>\r\n\r\n\t<!-- Add Category Modal -->\r\n\r\n\t<div id=\"add_category\" class=\"modal custom-modal fade\" role=\"dialog\">\r\n\r\n\t\t<div class=\"modal-dialog modal-dialog-centered\" role=\"document\">\r\n\r\n\t\t\t<div class=\"modal-content\">\r\n\r\n\t\t\t\t<div class=\"modal-header\">\r\n\r\n\t\t\t\t\t<h5 class=\"modal-title\">Cari Kartı Arama</h5>\r\n\r\n\t\t\t\t\t<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\r\n\r\n\t\t\t\t\t\t<span aria-hidden=\"true\">&times;</span>\r\n\r\n\t\t\t\t\t</button>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"modal-body\">\r\n\r\n\t\t\t\t\t<form action=\"<?= base_url(\"cari/cari-listesi\"); ?>\" method=\"GET\">\r\n\r\n\t\t\t\t\t\t<div class=\"form-group\">\r\n\r\n\t\t\t\t\t\t\t<label>Kayıt Tarihi Aralığına Göre </label>\r\n\r\n\t\t\t\t\t\t\t<input class=\"form-control\" id=\"daterange\" type=\"text\" name=\"tarihAraligi\"\r\n\r\n\t\t\t\t\t\t\t\t   value=\"<?= $tarihAraligi; ?>\" autocomplete=\"off\"/>\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"form-group\">\r\n\r\n\t\t\t\t\t\t\t<label>Cari Koduna Göre </label>\r\n\r\n\t\t\t\t\t\t\t<input class=\"form-control\" type=\"text\" name=\"cariKodu\" value=\"<?= $cariKodu; ?>\"\r\n\r\n\t\t\t\t\t\t\t\t   autocomplete=\"off\">\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"form-group\">\r\n\r\n\t\t\t\t\t\t\t<label>Cari Adına Göre </label>\r\n\r\n\t\t\t\t\t\t\t<input class=\"form-control\" type=\"text\" name=\"cariAdi\" value=\"<?= $cariAdi; ?>\"\r\n\r\n\t\t\t\t\t\t\t\t   autocomplete=\"off\">\r\n\r\n\t\t\t\t\t\t</div>\t\t\t\t\t\t<?php\r\n\r\n\t\t\t\t\t\t$anaHesap = anaHesapBilgisi();\r\n\r\n\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t// Kullanıcı grup bilgisi kontrol et\r\n\r\n\t\t\t\t\t\t$control = session(\"r\", \"login_info\");\r\n\r\n\t\t\t\t\t\t$user_group_id = $control->grup_id;\r\n\r\n\t\t\t\t\t\t$admin_groups = [1, 2, 5, 7];\r\n\r\n\t\t\t\t\t\t$is_admin = in_array($user_group_id, $admin_groups);\r\n\r\n\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t// Admin gruplar için tüm kullanıcıları göster, diğerleri için sadece kendileri ve bağlılarını\r\n\r\n\t\t\t\t\t\tif ($is_admin) {\r\n\r\n\t\t\t\t\t\t\t$kullanicilarQ = \"SELECT kullanici_id, kullanici_ad, kullanici_soyad FROM kullanicilar WHERE kullanici_olusturanAnaHesap = '$anaHesap' ORDER BY kullanici_ad, kullanici_soyad\";\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t$u_id = $control->kullanici_id;\r\n\r\n\t\t\t\t\t\t\t$kullanicilarQ = \"SELECT kullanici_id, kullanici_ad, kullanici_soyad FROM kullanicilar WHERE (kullanici_id = '$u_id' OR kullanici_sorumluMudur = '$u_id') ORDER BY kullanici_ad, kullanici_soyad\";\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t$kullanicilarE = $this->db->query($kullanicilarQ)->result();\r\n\r\n\t\t\t\t\t\t?>\r\n\r\n\t\t\t\t\t\t<div class=\"form-group\">\r\n\r\n\t\t\t\t\t\t\t<label>Cari Tipine Göre</label>\r\n\r\n\t\t\t\t\t\t\t<select name=\"bireysel\" class=\"form-control\">\r\n\r\n\t\t\t\t\t\t\t\t<option value=\"\">Cari tipi seçiniz...</option>\r\n\r\n\t\t\t\t\t\t\t\t<option value=\"true\" <?php if ($cariTipi == \"true\") {\r\n\r\n\t\t\t\t\t\t\t\t\techo \"selected\";\r\n\r\n\t\t\t\t\t\t\t\t} ?>>Bireysel Müşteri\r\n\r\n\t\t\t\t\t\t\t\t</option>\r\n\r\n\t\t\t\t\t\t\t\t<option value=\"false\" <?php if ($cariTipi == \"false\") {\r\n\r\n\t\t\t\t\t\t\t\t\techo \"selected\";\r\n\r\n\t\t\t\t\t\t\t\t} ?>>Kurumsal Müşteri\r\n\r\n\t\t\t\t\t\t\t\t</option>\r\n\r\n\t\t\t\t\t\t\t</select>\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"form-group\">\r\n\r\n\t\t\t\t\t\t\t<label>İşlemi Yapana Göre </label>\r\n\r\n\t\t\t\t\t\t\t<select name=\"islemYapan\" class=\"form-control\">\r\n\r\n\t\t\t\t\t\t\t\t<option value=\"\">İşlem yapanı seçiniz...</option>\r\n\r\n\t\t\t\t\t\t\t\t<?php foreach ($kullanicilarE as $kullanici) { ?>\r\n\r\n\t\t\t\t\t\t\t\t\t<option value=\"<?= $kullanici->kullanici_id; ?>\" <?php if ($kullanici->kullanici_id == $islemYapan) {\r\n\r\n\t\t\t\t\t\t\t\t\t\techo \"selected\";\r\n\r\n\t\t\t\t\t\t\t\t\t} ?>><?= $kullanici->kullanici_ad . ' ' . $kullanici->kullanici_soyad; ?></option>\r\n\r\n\t\t\t\t\t\t\t\t<?php } ?>\r\n\r\n\t\t\t\t\t\t\t</select>\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<?php $iller = $this->vt->multiple(\"iller\"); ?>\r\n\r\n\t\t\t\t\t\t<div class=\"form-group\">\r\n\r\n\t\t\t\t\t\t\t<label>Bulunduğu İle Göre </label>\r\n\r\n\t\t\t\t\t\t\t<select name=\"bulunduguIl\" class=\"form-control\">\r\n\r\n\t\t\t\t\t\t\t\t<option value=\"\">İl seçiniz...</option>\r\n\r\n\t\t\t\t\t\t\t\t<?php foreach ($iller as $il) { ?>\r\n\r\n\t\t\t\t\t\t\t\t\t<option value=\"<?= $il->id; ?>\" <?php if ($il->id == $bulunduguIl) {\r\n\r\n\t\t\t\t\t\t\t\t\t\techo \"selected\";\r\n\r\n\t\t\t\t\t\t\t\t\t} ?>><?= $il->il; ?></option>\r\n\r\n\t\t\t\t\t\t\t\t<?php } ?>\r\n\r\n\t\t\t\t\t\t\t</select>\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"submit-section\">\r\n\r\n\t\t\t\t\t\t\t<button class=\"btn btn-danger submit-btn\">Ara</button>\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t</form>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t</div>\r\n\r\n\t</div>\r\n\r\n\t<!-- /Add Category Modal -->\r\n\r\n\r\n\r\n\r\n\r\n\t<!-- Modal Delete  -->\r\n\r\n\t<div id=\"cari_sil\" class=\"modal custom-modal fade\" role=\"dialog\">\r\n\r\n\t\t<div class=\"modal-dialog modal-dialog-centered\" role=\"document\">\r\n\r\n\t\t\t<div class=\"modal-content\">\r\n\r\n\t\t\t\t<div class=\"modal-header\">\r\n\r\n\t\t\t\t\t<h5 class=\"modal-title\">Cari Kartı Silme</h5>\r\n\r\n\t\t\t\t\t<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\r\n\r\n\t\t\t\t\t\t<span aria-hidden=\"true\">&times;</span>\r\n\r\n\t\t\t\t\t</button>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"modal-body\">\r\n\r\n\t\t\t\t\t<form action=\"<?= base_url(\"cari/cari_sil\"); ?>\" method=\"GET\">\r\n\r\n\t\t\t\t\t\t<input type=\"hidden\" name=\"cari_id\" id=\"cari_id\" value=\"\">\r\n\r\n\t\t\t\t\t\t<p id=\"cari_ad\"></p>\r\n\r\n\t\t\t\t\t\t<div class=\"submit-section\">\r\n\r\n\t\t\t\t\t\t\t<button class=\"btn btn-danger submit-btn\">Evet</button>\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t</form>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t</div>\t</div>\r\n\r\n\t<!-- Görsel Modal -->\r\n\r\n\t<div id=\"gorselModal\" class=\"modal custom-modal fade\" role=\"dialog\">\r\n\r\n\t\t<div class=\"modal-dialog modal-dialog-centered modal-lg\" role=\"document\">\r\n\r\n\t\t\t<div class=\"modal-content\">\r\n\r\n\t\t\t\t<div class=\"modal-header\">\r\n\r\n\t\t\t\t\t<h5 class=\"modal-title\">İşletme Görselleri - <span id=\"gorselCariAd\"></span></h5>\r\n\r\n\t\t\t\t\t<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\r\n\r\n\t\t\t\t\t\t<span aria-hidden=\"true\">&times;</span>\r\n\r\n\t\t\t\t\t</button>\r\n\r\n\t\t\t\t</div>\t\t\t\t<div class=\"modal-body\">\r\n\r\n\t\t\t\t\t<div class=\"list-group\" id=\"gorselListesi\">\r\n\r\n\t\t\t\t\t\t<!-- Görseller buraya eklenecek -->\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t</div>\r\n\r\n\t</div>\r\n\r\n\r\n\r\n\t<!-- Evrak Modal -->\r\n\r\n\t<div id=\"evrakModal\" class=\"modal custom-modal fade\" role=\"dialog\">\r\n\r\n\t\t<div class=\"modal-dialog modal-dialog-centered modal-lg\" role=\"document\">\r\n\r\n\t\t\t<div class=\"modal-content\">\r\n\r\n\t\t\t\t<div class=\"modal-header\">\r\n\r\n\t\t\t\t\t<h5 class=\"modal-title\">Evraklar - <span id=\"evrakCariAd\"></span></h5>\r\n\r\n\t\t\t\t\t<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\r\n\r\n\t\t\t\t\t\t<span aria-hidden=\"true\">&times;</span>\r\n\r\n\t\t\t\t\t</button>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"modal-body\">\r\n\r\n\t\t\t\t\t<div class=\"list-group\" id=\"evrakListesi\">\r\n\r\n\t\t\t\t\t\t<!-- Evraklar buraya eklenecek -->\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t</div>\r\n\r\n\t</div>\r\n\r\n\r\n\r\n\r\n\r\n</div>\r\n\r\n<!-- /Main Wrapper -->\r\n\r\n\r\n\r\n<?php if ($this->session->flashdata('excel_ok')) : ?>\r\n\r\n\t<script>\r\n\r\n\t\tswal({\r\n\r\n\t\t\ttitle: \"Bilgilendirme\",\r\n\r\n\t\t\ttype: \"success\",\r\n\r\n\t\t\ttext: \"Excel dışa aktarma işlemi gerçekleştiriliyor.\",\r\n\r\n\t\t\tconfirmButtonText: 'Tamam',\r\n\r\n\t\t\tbutton: false,\r\n\r\n\t\t\ttimer: 5000,\r\n\r\n\t\t});\r\n\r\n\t</script>\r\n\r\n<?php endif; ?>\r\n\r\n<?php if ($this->session->flashdata('cari_sil_ok')) : ?>\r\n\r\n\t<script>\r\n\r\n\t\tswal({\r\n\r\n\t\t\ttitle: \"Bilgilendirme\",\r\n\r\n\t\t\ttype: \"success\",\r\n\r\n\t\t\ttext: \"Cari başarıyla pasif hale getirildi.\",\r\n\r\n\t\t\tconfirmButtonText: 'Tamam',\r\n\r\n\t\t\tbutton: false,\r\n\r\n\t\t\ttimer: 5000,\r\n\r\n\t\t});\r\n\r\n\t</script>\r\n\r\n<?php endif; ?>\r\n\r\n<?php $this->load->view(\"include/footer-js\"); ?>\r\n\r\n<!-- Select2 JS -->\r\n\r\n<script src=\"<?= base_url(); ?>assets/plugins/select2/js/select2.min.js\"></script>\r\n\r\n\r\n\r\n<script>\t$(function () {\r\n\r\n\t\tmoment.locale('tr');\r\n\r\n\t\t$('#daterange').daterangepicker({\r\n\r\n\t\t\topens: 'left',\r\n\r\n\t\t\tautoUpdateInput: false\r\n\r\n\t\t}, function (start, end, label) {\r\n\r\n\t\t\t$('#daterange').val(start.format('DD.MM.YYYY') + ' - ' + end.format('DD.MM.YYYY'));\r\n\r\n\t\t\t//console.log(\"A new date selection was made: \" + start.format('YYYY-MM-DD') + ' to ' + end.format('YYYY-MM-DD'));\r\n\r\n\t\t});\r\n\r\n\t});\t// Base URL'yi JavaScript'e tanımlayalım\r\n\r\n\tvar baseUrl = '<?= base_url(); ?>';\r\n\r\n\t\r\n\r\n\t// Manuel modal açma fonksiyonları\r\n\r\n\tfunction openGorselModal(images, cariAd, cariId) {\r\n\r\n\t\tconsole.log('Manuel görsel modal açılıyor:', {images: images, cariAd: cariAd, cariId: cariId});\r\n\r\n\t\t\r\n\r\n\t\tif (!cariId || cariId === undefined || cariId === null || cariId === '') {\r\n\r\n\t\t\tconsole.error('Manuel modal açma - Cari ID boş!');\r\n\r\n\t\t\talert('HATA: Cari ID değeri bulunamadı!');\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t$('#gorselCariAd').text(cariAd);\r\n\r\n\t\t\r\n\r\n\t\tif (images && images !== '') {\r\n\r\n\t\t\tvar imageArray = images.split(',');\r\n\r\n\t\t\tvar gorselListesi = $('#gorselListesi');\r\n\r\n\t\t\tgorselListesi.empty();\r\n\r\n\t\t\t\r\n\r\n\t\t\timageArray.forEach(function(image, index) {\r\n\r\n\t\t\t\tvar trimmedImage = image.trim();\r\n\r\n\t\t\t\tvar fileName = trimmedImage.split('/').pop().replace(/^[^_]*_/, '');\r\n\r\n\t\t\t\tvar imageUrl = baseUrl + 'assets/uploads/' + trimmedImage;\r\n\r\n\t\t\t\t\r\n\r\n\t\t\t\tvar imageHtml = '<div class=\"list-group-item d-flex align-items-center justify-content-between\">' +\r\n\r\n\t\t\t\t\t'<div class=\"d-flex align-items-center flex-grow-1\">' +\r\n\r\n\t\t\t\t\t'<a href=\"' + imageUrl + '\" target=\"_blank\" class=\"d-flex align-items-center text-decoration-none flex-grow-1\">' +\r\n\r\n\t\t\t\t\t'<img src=\"' + imageUrl + '\" alt=\"Görsel\" class=\"img-thumbnail mr-2\" style=\"width: 60px; height: 60px; object-fit: cover;\">' +\r\n\r\n\t\t\t\t\tfileName +\r\n\r\n\t\t\t\t\t'</a>' +\r\n\r\n\t\t\t\t\t'</div>' +\r\n\r\n\t\t\t\t\t'<button type=\"button\" class=\"btn btn-sm btn-outline-danger ml-2\" ' +\r\n\r\n\t\t\t\t\t'onclick=\"silGorsel(\\'' + cariId + '\\', \\'' + trimmedImage + '\\', this)\" ' +\r\n\r\n\t\t\t\t\t'title=\"Görseli sil\">' +\r\n\r\n\t\t\t\t\t'<i class=\"fa fa-trash\"></i>' +\r\n\r\n\t\t\t\t\t'</button>' +\r\n\r\n\t\t\t\t\t'</div>';\r\n\r\n\t\t\t\tgorselListesi.append(imageHtml);\r\n\r\n\t\t\t});\r\n\r\n\t\t} else {\r\n\r\n\t\t\t$('#gorselListesi').html('<div class=\"text-center text-muted p-4\">Görsel bulunamadı</div>');\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t$('#gorselModal').modal('show');\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\tfunction openEvrakModal(documents, cariAd, cariId) {\r\n\r\n\t\tconsole.log('Manuel evrak modal açılıyor:', {documents: documents, cariAd: cariAd, cariId: cariId});\r\n\r\n\t\t\r\n\r\n\t\tif (!cariId || cariId === undefined || cariId === null || cariId === '') {\r\n\r\n\t\t\tconsole.error('Manuel modal açma - Cari ID boş!');\r\n\r\n\t\t\talert('HATA: Cari ID değeri bulunamadı!');\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t$('#evrakCariAd').text(cariAd);\r\n\r\n\t\t\r\n\r\n\t\tif (documents && documents !== '') {\r\n\r\n\t\t\tvar documentArray = documents.split(',');\r\n\r\n\t\t\tvar evrakListesi = $('#evrakListesi');\r\n\r\n\t\t\tevrakListesi.empty();\r\n\r\n\t\t\t\r\n\r\n\t\t\tdocumentArray.forEach(function(document, index) {\r\n\r\n\t\t\t\tvar trimmedDocument = document.trim();\r\n\r\n\t\t\t\tvar fileName = trimmedDocument.split('/').pop().replace(/^[^_]*_/, '');\r\n\r\n\t\t\t\tvar fileExtension = fileName.split('.').pop().toLowerCase();\r\n\r\n\t\t\t\tvar icon = 'fa-file';\r\n\r\n\t\t\t\t\r\n\r\n\t\t\t\tif (['pdf'].includes(fileExtension)) {\r\n\r\n\t\t\t\t\ticon = 'fa-file-pdf text-danger';\r\n\r\n\t\t\t\t} else if (['doc', 'docx'].includes(fileExtension)) {\r\n\r\n\t\t\t\t\ticon = 'fa-file-word text-primary';\r\n\r\n\t\t\t\t} else if (['xls', 'xlsx'].includes(fileExtension)) {\r\n\r\n\t\t\t\t\ticon = 'fa-file-excel text-success';\r\n\r\n\t\t\t\t} else if (['jpg', 'jpeg', 'png', 'gif'].includes(fileExtension)) {\r\n\r\n\t\t\t\t\ticon = 'fa-file-image text-info';\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t\r\n\r\n\t\t\t\tvar documentUrl = baseUrl + 'assets/uploads/' + trimmedDocument;\r\n\r\n\t\t\t\t\r\n\r\n\t\t\t\tvar documentHtml = '<div class=\"list-group-item d-flex align-items-center justify-content-between\">' +\r\n\r\n\t\t\t\t\t'<div class=\"d-flex align-items-center flex-grow-1\">' +\r\n\r\n\t\t\t\t\t'<a href=\"' + documentUrl + '\" target=\"_blank\" class=\"d-flex align-items-center text-decoration-none flex-grow-1\">' +\r\n\r\n\t\t\t\t\t'<i class=\"fa ' + icon + ' mr-2\"></i>' + fileName +\r\n\r\n\t\t\t\t\t'</a>' +\r\n\r\n\t\t\t\t\t'</div>' +\r\n\r\n\t\t\t\t\t'<button type=\"button\" class=\"btn btn-sm btn-outline-danger ml-2\" ' +\r\n\r\n\t\t\t\t\t'onclick=\"silEvrak(\\'' + cariId + '\\', \\'' + trimmedDocument + '\\', this)\" ' +\r\n\r\n\t\t\t\t\t'title=\"Evrakı sil\">' +\r\n\r\n\t\t\t\t\t'<i class=\"fa fa-trash\"></i>' +\r\n\r\n\t\t\t\t\t'</button>' +\r\n\r\n\t\t\t\t\t'</div>';\r\n\r\n\t\t\t\tevrakListesi.append(documentHtml);\r\n\r\n\t\t\t});\r\n\r\n\t\t} else {\r\n\r\n\t\t\t$('#evrakListesi').html('<div class=\"text-center text-muted p-4\">Evrak bulunamadı</div>');\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t$('#evrakModal').modal('show');\r\n\r\n\t}\r\n\r\n\t\r\n\r\n\t// Görsel Modal İşlevselliği\r\n\r\n\t$('#gorselModal').on('show.bs.modal', function (event) {\r\n\r\n\t\tconsole.log('=== GÖRSEL MODAL AÇILIYOR ===');\r\n\r\n\t\tconsole.log('Event:', event);\r\n\r\n\t\t\r\n\r\n\t\tvar button = $(event.relatedTarget);\r\n\r\n\t\tconsole.log('Button element:', button);\r\n\r\n\t\tconsole.log('Button HTML:', button[0] ? button[0].outerHTML : 'Buton bulunamadı!');\r\n\r\n\t\t\r\n\r\n\t\tvar images = button.data('images');\r\n\r\n\t\tvar cariAd = button.data('cari');\r\n\r\n\t\tvar cariId = button.data('cariid');\r\n\r\n\t\t\r\n\r\n\t\tconsole.log('Button data attributes:');\r\n\r\n\t\tconsole.log('- images:', images);\r\n\r\n\t\tconsole.log('- cari:', cariAd);\r\n\r\n\t\tconsole.log('- cariid:', cariId);\r\n\r\n\t\t\r\n\r\n\t\t// Eğer cariid data attribute'u yoksa, alternatif yoldan al\r\n\r\n\t\tif (!cariId || cariId === undefined || cariId === null || cariId === '') {\r\n\r\n\t\t\tconsole.log('cariid data attribute bulunamadı, alternatif yoldan alınıyor...');\r\n\r\n\t\t\t\r\n\r\n\t\t\t// Önce tablo satırından al\r\n\r\n\t\t\tvar tableRow = button.closest('tr');\r\n\r\n\t\t\tif (tableRow.length > 0) {\r\n\r\n\t\t\t\tvar hareketlerLink = tableRow.find('a[href*=\"cari-hareketleri\"]');\r\n\r\n\t\t\t\tconsole.log('Hareketler link (table):', hareketlerLink);\r\n\r\n\t\t\t\tif (hareketlerLink.length > 0) {\r\n\r\n\t\t\t\t\tvar href = hareketlerLink.attr('href');\r\n\r\n\t\t\t\t\tconsole.log('Href (table):', href);\r\n\r\n\t\t\t\t\tif (href && href.includes('cari=')) {\r\n\r\n\t\t\t\t\t\tcariId = href.split('cari=')[1];\r\n\r\n\t\t\t\t\t\tconsole.log('Alternatif yoldan alınan cariId (table):', cariId);\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t\r\n\r\n\t\t\t// Eğer hala bulunamadıysa mobil karttan al\r\n\r\n\t\t\tif (!cariId || cariId === undefined || cariId === null || cariId === '') {\r\n\r\n\t\t\t\tvar mobileCard = button.closest('.mobile-customer-card');\r\n\r\n\t\t\t\tif (mobileCard.length > 0) {\r\n\r\n\t\t\t\t\tvar hareketlerLinkMobile = mobileCard.find('a[href*=\"cari-hareketleri\"]');\r\n\r\n\t\t\t\t\tconsole.log('Hareketler link (mobile):', hareketlerLinkMobile);\r\n\r\n\t\t\t\t\tif (hareketlerLinkMobile.length > 0) {\r\n\r\n\t\t\t\t\t\tvar hrefMobile = hareketlerLinkMobile.attr('href');\r\n\r\n\t\t\t\t\t\tconsole.log('Href (mobile):', hrefMobile);\r\n\r\n\t\t\t\t\t\tif (hrefMobile && hrefMobile.includes('cari=')) {\r\n\r\n\t\t\t\t\t\t\tcariId = hrefMobile.split('cari=')[1];\r\n\r\n\t\t\t\t\t\t\tconsole.log('Alternatif yoldan alınan cariId (mobile):', cariId);\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\tconsole.log('Modal açılıyor - Images RAW:', images);\r\n\r\n\t\tconsole.log('Images type:', typeof images);\r\n\r\n\t\tconsole.log('Cari Adı:', cariAd);\r\n\r\n\t\tconsole.log('Cari ID:', cariId);\r\n\r\n\t\tconsole.log('Cari ID Type:', typeof cariId);\r\n\r\n\t\t\r\n\r\n\t\t// Eğer cariId undefined/null/empty ise hata ver\r\n\r\n\t\tif (!cariId || cariId === undefined || cariId === null || cariId === '') {\r\n\r\n\t\t\tconsole.error('CARİ ID DEĞERİ BULUNAMADI!');\r\n\r\n\t\t\tconsole.error('Button data-cariid değeri:', button.data('cariid'));\r\n\r\n\t\t\tconsole.error('Button tüm data değerleri:', button.data());\r\n\r\n\t\t\talert('HATA: Cari ID değeri bulunamadı! Konsola bakın.');\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t$('#gorselCariAd').text(cariAd);\r\n\r\n\t\t\r\n\r\n\t\tif (images && images !== '') {\r\n\r\n\t\t\tconsole.log('Images mevcut, işlemeye devam ediliyor...');\r\n\r\n\t\t\tvar imageArray = images.split(',');\r\n\r\n\t\t\tconsole.log('Image Array:', imageArray);\r\n\r\n\t\t\tconsole.log('Array length:', imageArray.length);\r\n\r\n\t\t\t\r\n\r\n\t\t\tvar gorselListesi = $('#gorselListesi');\r\n\r\n\t\t\tgorselListesi.empty();\r\n\r\n\t\t\tconsole.log('Görsel listesi temizlendi');\r\n\r\n\t\t\t\r\n\r\n\t\t\timageArray.forEach(function(image, index) {\r\n\r\n\t\t\t\tvar trimmedImage = image.trim();\r\n\r\n\t\t\t\tconsole.log('Processing image ' + index + ':', trimmedImage);\r\n\r\n\t\t\t\t\r\n\r\n\t\t\t\tvar fileName = trimmedImage.split('/').pop();\r\n\r\n\t\t\t\tvar fileExtension = fileName.split('.').pop().toLowerCase();\r\n\r\n\t\t\t\tvar imageUrl = baseUrl + 'assets/uploads/' + trimmedImage;\r\n\r\n\t\t\t\t\r\n\r\n\t\t\t\tconsole.log('Final Image URL:', imageUrl);\r\n\r\n\t\t\t\t\r\n\r\n\t\t\t\t// Görsel için mini thumbnail gösterimi + silme butonu\r\n\r\n\t\t\t\tvar imageHtml = '<div class=\"list-group-item d-flex align-items-center justify-content-between\">' +\r\n\r\n\t\t\t\t\t'<div class=\"d-flex align-items-center flex-grow-1\">' +\r\n\r\n\t\t\t\t\t'<img src=\"' + imageUrl + '\" alt=\"Görsel\" ' +\r\n\r\n\t\t\t\t\t'style=\"width: 50px; height: 50px; object-fit: cover; border-radius: 5px; margin-right: 15px; cursor: pointer;\" ' +\r\n\r\n\t\t\t\t\t'onclick=\"window.open(\\'' + imageUrl + '\\', \\'_blank\\')\" ' +\r\n\r\n\t\t\t\t\t'onerror=\"console.log(\\'Image load error: ' + imageUrl + '\\')\" ' +\r\n\r\n\t\t\t\t\t'onload=\"console.log(\\'Image loaded successfully: ' + imageUrl + '\\')\">' +\r\n\r\n\t\t\t\t\t'<div>' +\r\n\r\n\t\t\t\t\t'<i class=\"fa fa-file-image text-success mr-2\"></i>' + fileName +\r\n\r\n\t\t\t\t\t'<br><small class=\"text-muted\">Görüntülemek için tıklayın</small>' +\r\n\r\n\t\t\t\t\t'</div>' +\r\n\r\n\t\t\t\t\t'</div>' +\r\n\r\n\t\t\t\t\t'<button type=\"button\" class=\"btn btn-sm btn-outline-danger ml-2\" ' +\r\n\r\n\t\t\t\t\t'onclick=\"silGorsel(\\'' + cariId + '\\', \\'' + trimmedImage + '\\', this)\" ' +\r\n\r\n\t\t\t\t\t'title=\"Görseli sil\">' +\r\n\r\n\t\t\t\t\t'<i class=\"fa fa-trash\"></i>' +\r\n\r\n\t\t\t\t\t'</button>' +\r\n\r\n\t\t\t\t\t'</div>';\r\n\r\n\t\t\t\t\r\n\r\n\t\t\t\tconsole.log('Adding HTML:', imageHtml);\r\n\r\n\t\t\t\tgorselListesi.append(imageHtml);\r\n\r\n\t\t\t});\r\n\r\n\t\t\t\r\n\r\n\t\t\tconsole.log('Final görsel content:', gorselListesi.html());\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconsole.log('Images verisi boş veya yok! Value:', images);\r\n\r\n\t\t\tvar gorselListesi = $('#gorselListesi');\r\n\r\n\t\t\tgorselListesi.html('<div class=\"text-center text-muted p-4\">Görsel bulunamadı</div>');\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\tconsole.log('=== GÖRSEL MODAL İŞLEMİ TAMAMLANDI ===');\r\n\r\n\t});\t// Evrak Modal İşlevselliği\r\n\r\n\t$('#evrakModal').on('show.bs.modal', function (event) {\r\n\r\n\t\tconsole.log('=== EVRAK MODAL AÇILIYOR ===');\r\n\r\n\t\tconsole.log('Event:', event);\r\n\r\n\t\t\r\n\r\n\t\tvar button = $(event.relatedTarget);\r\n\r\n\t\tconsole.log('Button element:', button);\r\n\r\n\t\tconsole.log('Button HTML:', button[0] ? button[0].outerHTML : 'Buton bulunamadı!');\r\n\r\n\t\t\r\n\r\n\t\tvar documents = button.data('documents');\r\n\r\n\t\tvar cariAd = button.data('cari');\r\n\r\n\t\tvar cariId = button.data('cariid');\r\n\r\n\t\t\r\n\r\n\t\tconsole.log('Button data attributes:');\r\n\r\n\t\tconsole.log('- documents:', documents);\r\n\r\n\t\tconsole.log('- cari:', cariAd);\r\n\r\n\t\tconsole.log('- cariid:', cariId);\r\n\r\n\t\t\r\n\r\n\t\t// Eğer cariid data attribute'u yoksa, alternatif yoldan al\r\n\r\n\t\tif (!cariId || cariId === undefined || cariId === null || cariId === '') {\r\n\r\n\t\t\tconsole.log('cariid data attribute bulunamadı, alternatif yoldan alınıyor...');\r\n\r\n\t\t\t\r\n\r\n\t\t\t// Önce tablo satırından al\r\n\r\n\t\t\tvar tableRow = button.closest('tr');\r\n\r\n\t\t\tif (tableRow.length > 0) {\r\n\r\n\t\t\t\tvar hareketlerLink = tableRow.find('a[href*=\"cari-hareketleri\"]');\r\n\r\n\t\t\t\tconsole.log('Hareketler link (table):', hareketlerLink);\r\n\r\n\t\t\t\tif (hareketlerLink.length > 0) {\r\n\r\n\t\t\t\t\tvar href = hareketlerLink.attr('href');\r\n\r\n\t\t\t\t\tconsole.log('Href (table):', href);\r\n\r\n\t\t\t\t\tif (href && href.includes('cari=')) {\r\n\r\n\t\t\t\t\t\tcariId = href.split('cari=')[1];\r\n\r\n\t\t\t\t\t\tconsole.log('Alternatif yoldan alınan cariId (table):', cariId);\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t\r\n\r\n\t\t\t// Eğer hala bulunamadıysa mobil karttan al\r\n\r\n\t\t\tif (!cariId || cariId === undefined || cariId === null || cariId === '') {\r\n\r\n\t\t\t\tvar mobileCard = button.closest('.mobile-customer-card');\r\n\r\n\t\t\t\tif (mobileCard.length > 0) {\r\n\r\n\t\t\t\t\tvar hareketlerLinkMobile = mobileCard.find('a[href*=\"cari-hareketleri\"]');\r\n\r\n\t\t\t\t\tconsole.log('Hareketler link (mobile):', hareketlerLinkMobile);\r\n\r\n\t\t\t\t\tif (hareketlerLinkMobile.length > 0) {\r\n\r\n\t\t\t\t\t\tvar hrefMobile = hareketlerLinkMobile.attr('href');\r\n\r\n\t\t\t\t\t\tconsole.log('Href (mobile):', hrefMobile);\r\n\r\n\t\t\t\t\t\tif (hrefMobile && hrefMobile.includes('cari=')) {\r\n\r\n\t\t\t\t\t\t\tcariId = hrefMobile.split('cari=')[1];\r\n\r\n\t\t\t\t\t\t\tconsole.log('Alternatif yoldan alınan cariId (mobile):', cariId);\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\tconsole.log('Evrak Modal - Cari ID:', cariId, 'Cari Adı:', cariAd);\r\n\r\n\t\t\r\n\r\n\t\t// Eğer cariId undefined/null/empty ise hata ver\r\n\r\n\t\tif (!cariId || cariId === undefined || cariId === null || cariId === '') {\r\n\r\n\t\t\tconsole.error('CARİ ID DEĞERİ BULUNAMADI!');\r\n\r\n\t\t\tconsole.error('Button data-cariid değeri:', button.data('cariid'));\r\n\r\n\t\t\tconsole.error('Button tüm data değerleri:', button.data());\r\n\r\n\t\t\talert('HATA: Cari ID değeri bulunamadı! Konsola bakın.');\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t$('#evrakCariAd').text(cariAd);\r\n\r\n\t\t\r\n\r\n\t\tif (documents) {\r\n\r\n\t\t\tvar documentArray = documents.split(',');\r\n\r\n\t\t\tconsole.log('Document Array:', documentArray);\r\n\r\n\t\t\t\r\n\r\n\t\t\tvar evrakListesi = $('#evrakListesi');\r\n\r\n\t\t\tevrakListesi.empty();\r\n\r\n\t\t\t\r\n\r\n\t\t\tdocumentArray.forEach(function(document, index) {\r\n\r\n\t\t\t\tvar trimmedDocument = document.trim();\r\n\r\n\t\t\t\tvar fileName = trimmedDocument.split('/').pop().replace(/^[^_]*_/, ''); // Prefix'i kaldır\r\n\r\n\t\t\t\tvar fileExtension = fileName.split('.').pop().toLowerCase();\r\n\r\n\t\t\t\tvar icon = 'fa-file';\r\n\r\n\t\t\t\t\r\n\r\n\t\t\t\t// Dosya tipine göre ikon belirle\r\n\r\n\t\t\t\tif (['pdf'].includes(fileExtension)) {\r\n\r\n\t\t\t\t\ticon = 'fa-file-pdf text-danger';\r\n\r\n\t\t\t\t} else if (['doc', 'docx'].includes(fileExtension)) {\r\n\r\n\t\t\t\t\ticon = 'fa-file-word text-primary';\r\n\r\n\t\t\t\t} else if (['xls', 'xlsx'].includes(fileExtension)) {\r\n\r\n\t\t\t\t\ticon = 'fa-file-excel text-success';\r\n\r\n\t\t\t\t} else if (['jpg', 'jpeg', 'png', 'gif'].includes(fileExtension)) {\r\n\r\n\t\t\t\t\ticon = 'fa-file-image text-info';\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t\r\n\r\n\t\t\t\tvar documentUrl = baseUrl + 'assets/uploads/' + trimmedDocument;\r\n\r\n\t\t\t\tconsole.log('Document URL:', documentUrl);\r\n\r\n\t\t\t\t\r\n\r\n\t\t\t\tvar documentHtml = '<div class=\"list-group-item d-flex align-items-center justify-content-between\">' +\r\n\r\n\t\t\t\t\t'<div class=\"d-flex align-items-center flex-grow-1\">' +\r\n\r\n\t\t\t\t\t'<a href=\"' + documentUrl + '\" target=\"_blank\" class=\"d-flex align-items-center text-decoration-none flex-grow-1\">' +\r\n\r\n\t\t\t\t\t'<i class=\"fa ' + icon + ' mr-2\"></i>' + fileName +\r\n\r\n\t\t\t\t\t'</a>' +\r\n\r\n\t\t\t\t\t'</div>' +\r\n\r\n\t\t\t\t\t'<button type=\"button\" class=\"btn btn-sm btn-outline-danger ml-2\" ' +\r\n\r\n\t\t\t\t\t'onclick=\"silEvrak(\\'' + cariId + '\\', \\'' + trimmedDocument + '\\', this)\" ' +\r\n\r\n\t\t\t\t\t'title=\"Evrakı sil\">' +\r\n\r\n\t\t\t\t\t'<i class=\"fa fa-trash\"></i>' +\r\n\r\n\t\t\t\t\t'</button>' +\r\n\r\n\t\t\t\t\t'</div>';\r\n\r\n\t\t\t\tevrakListesi.append(documentHtml);\r\n\r\n\t\t\t});\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconsole.log('Documents verisi boş veya yok!');\t\t}\r\n\r\n\t});\t// Görsel silme fonksiyonu\r\n\r\n\tfunction silGorsel(cariId, dosyaAdi, button) {\r\n\r\n\t\tconsole.log('Görsel silme - Cari ID:', cariId, 'Dosya:', dosyaAdi);\r\n\r\n\t\t\r\n\r\n\t\tif (confirm('Bu görseli silmek istediğinizden emin misiniz?\\n\\nDosya: ' + dosyaAdi.split('/').pop())) {\r\n\r\n\t\t\t// Butonu devre dışı bırak\r\n\r\n\t\t\t$(button).prop('disabled', true).html('<i class=\"fa fa-spinner fa-spin\"></i>');\r\n\r\n\t\t\t\r\n\r\n\t\t\t$.ajax({\r\n\r\n\t\t\t\turl: baseUrl + 'cari/gorselSil',\r\n\r\n\t\t\t\ttype: 'POST',\r\n\r\n\t\t\t\tdata: {\r\n\r\n\t\t\t\t\tcari_id: cariId,\r\n\r\n\t\t\t\t\tdosya_adi: dosyaAdi\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsuccess: function(response) {\r\n\r\n\t\t\t\t\ttry {\r\n\r\n\t\t\t\t\t\tvar result = JSON.parse(response);\r\n\r\n\t\t\t\t\t\tif (result.success) {\r\n\r\n\t\t\t\t\t\t\t// Satırı kaldır\r\n\r\n\t\t\t\t\t\t\t$(button).closest('.list-group-item').fadeOut(300, function() {\r\n\r\n\t\t\t\t\t\t\t\t$(this).remove();\r\n\r\n\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t// Eğer hiç görsel kalmadıysa\r\n\r\n\t\t\t\t\t\t\t\tif ($('#gorselListesi .list-group-item').length === 0) {\r\n\r\n\t\t\t\t\t\t\t\t\t$('#gorselListesi').html('<div class=\"text-center text-muted p-4\">Görsel bulunamadı</div>');\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t// Sayfayı yenile (güncel veriyi göstermek için)\r\n\r\n\t\t\t\t\t\t\tsetTimeout(function() {\r\n\r\n\t\t\t\t\t\t\t\tlocation.reload();\r\n\r\n\t\t\t\t\t\t\t}, 1000);\r\n\r\n\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t// Success alert\r\n\r\n\t\t\t\t\t\t\tswal({\r\n\r\n\t\t\t\t\t\t\t\ttitle: \"Başarılı\",\r\n\r\n\t\t\t\t\t\t\t\ttext: \"Görsel başarıyla silindi.\",\r\n\r\n\t\t\t\t\t\t\t\ttype: \"success\",\r\n\r\n\t\t\t\t\t\t\t\ttimer: 2000,\r\n\r\n\t\t\t\t\t\t\t\tshowConfirmButton: false\r\n\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\talert('Hata: ' + (result.message || 'Görsel silinemedi'));\r\n\r\n\t\t\t\t\t\t\t$(button).prop('disabled', false).html('<i class=\"fa fa-trash\"></i>');\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} catch (e) {\r\n\r\n\t\t\t\t\t\talert('Beklenmeyen bir hata oluştu');\r\n\r\n\t\t\t\t\t\t$(button).prop('disabled', false).html('<i class=\"fa fa-trash\"></i>');\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\terror: function() {\r\n\r\n\t\t\t\t\talert('Sunucu hatası oluştu');\r\n\r\n\t\t\t\t\t$(button).prop('disabled', false).html('<i class=\"fa fa-trash\"></i>');\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\r\n\t\t}\r\n\r\n\t}\t// Evrak silme fonksiyonu\r\n\r\n\tfunction silEvrak(cariId, dosyaAdi, button) {\r\n\r\n\t\tconsole.log('Evrak silme - Cari ID:', cariId, 'Dosya:', dosyaAdi);\r\n\r\n\t\t\r\n\r\n\t\tif (confirm('Bu evrakı silmek istediğinizden emin misiniz?\\n\\nDosya: ' + dosyaAdi.split('/').pop())) {\r\n\r\n\t\t\t// Butonu devre dışı bırak\r\n\r\n\t\t\t$(button).prop('disabled', true).html('<i class=\"fa fa-spinner fa-spin\"></i>');\r\n\r\n\t\t\t\r\n\r\n\t\t\t$.ajax({\r\n\r\n\t\t\t\turl: baseUrl + 'cari/evrakSil',\r\n\r\n\t\t\t\ttype: 'POST',\r\n\r\n\t\t\t\tdata: {\r\n\r\n\t\t\t\t\tcari_id: cariId,\r\n\r\n\t\t\t\t\tdosya_adi: dosyaAdi\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsuccess: function(response) {\r\n\r\n\t\t\t\t\ttry {\r\n\r\n\t\t\t\t\t\tvar result = JSON.parse(response);\r\n\r\n\t\t\t\t\t\tif (result.success) {\r\n\r\n\t\t\t\t\t\t\t// Satırı kaldır\r\n\r\n\t\t\t\t\t\t\t$(button).closest('.list-group-item').fadeOut(300, function() {\r\n\r\n\t\t\t\t\t\t\t\t$(this).remove();\r\n\r\n\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t// Eğer hiç evrak kalmadıysa\r\n\r\n\t\t\t\t\t\t\t\tif ($('#evrakListesi .list-group-item').length === 0) {\r\n\r\n\t\t\t\t\t\t\t\t\t$('#evrakListesi').html('<div class=\"text-center text-muted p-4\">Evrak bulunamadı</div>');\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t// Sayfayı yenile (güncel veriyi göstermek için)\r\n\r\n\t\t\t\t\t\t\tsetTimeout(function() {\r\n\r\n\t\t\t\t\t\t\t\tlocation.reload();\r\n\r\n\t\t\t\t\t\t\t}, 1000);\r\n\r\n\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t// Success alert\r\n\r\n\t\t\t\t\t\t\tswal({\r\n\r\n\t\t\t\t\t\t\t\ttitle: \"Başarılı\",\r\n\r\n\t\t\t\t\t\t\t\ttext: \"Evrak başarıyla silindi.\",\r\n\r\n\t\t\t\t\t\t\t\ttype: \"success\",\r\n\r\n\t\t\t\t\t\t\t\ttimer: 2000,\r\n\r\n\t\t\t\t\t\t\t\tshowConfirmButton: false\r\n\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\talert('Hata: ' + (result.message || 'Evrak silinemedi'));\r\n\r\n\t\t\t\t\t\t\t$(button).prop('disabled', false).html('<i class=\"fa fa-trash\"></i>');\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} catch (e) {\r\n\r\n\t\t\t\t\t\talert('Beklenmeyen bir hata oluştu');\r\n\r\n\t\t\t\t\t\t$(button).prop('disabled', false).html('<i class=\"fa fa-trash\"></i>');\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\terror: function() {\r\n\r\n\t\t\t\t\talert('Sunucu hatası oluştu');\r\n\r\n\t\t\t\t\t$(button).prop('disabled', false).html('<i class=\"fa fa-trash\"></i>');\r\n\r\n\t\t\t\t}\t\t\t});\t\t}\t}\t// Mobile Card Collapsible özelliği\r\n\r\n\t$(document).ready(function() {\r\n\r\n\t\t// Sidebar menüyü yeniden başlat\r\n\r\n\t\tsetTimeout(function() {\r\n\r\n\t\t\tif (typeof window.initSidebarMenu === 'function') {\r\n\r\n\t\t\t\twindow.initSidebarMenu();\r\n\r\n\t\t\t\tconsole.log('Sidebar menü cari listesi sayfasında yeniden başlatıldı');\r\n\r\n\t\t\t}\r\n\r\n\t\t}, 100);\r\n\r\n\t\t\r\n\r\n\t\t// Sadece mobil kart işlevselliği - sidebar'a müdahale etme\r\n\r\n\t\t$(document).on('click', '.mobile-customer-card', function(e) {\r\n\r\n\t\t\t// Buton ve link tıklamalarını önle\r\n\r\n\t\t\tif ($(e.target).closest('a, button').length > 0) {\r\n\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t\r\n\r\n\t\t\t// Event bubbling'i durdur ki sidebar'ı etkilemesin\r\n\r\n\t\t\te.stopPropagation();\r\n\r\n\t\t\t\r\n\r\n\t\t\t$(this).toggleClass('expanded');\r\n\r\n\t\t});\r\n\r\n\t\t\r\n\r\n\t\t// İlk yüklemede tüm kartları kapalı halde başlat\r\n\r\n\t\t$('.mobile-customer-card').removeClass('expanded');\r\n\r\n\t\t\r\n\r\n\t\t// Debug: Sidebar menü linklerinin var olup olmadığını kontrol et\r\n\r\n\t\tsetTimeout(function() {\r\n\r\n\t\t\tconsole.log('Sidebar menü linkleri:', $('#sidebar-menu a').length);\r\n\r\n\t\t\tconsole.log('Submenu linkleri:', $('#sidebar-menu .submenu > a').length);\r\n\r\n\t\t\tconsole.log('Aktif cari menüsü:', $('#sidebar-menu .submenu.active').length);\r\n\r\n\t\t}, 500);\r\n\r\n\t});\r\n\r\n</script>\r\n\r\n\r\n\r\n\r\n\r\n</body>\r\n\r\n\r\n\r\n</html>\r\n\r\n"
        }
    ]
}