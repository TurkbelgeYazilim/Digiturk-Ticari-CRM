{
    "sourceFile": "application/views/raporlar/digiturk-sehir-ciro-adet.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 23,
            "patches": [
                {
                    "date": 1755008783241,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1755008893906,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -946,36 +946,31 @@\n                             html += '<th>Cari Ad</th>';\r\n                             html += '<th>ƒ∞l</th>';\r\n                             html += '<th>ƒ∞l√ße</th>';\r\n                             html += '<th>Telefon</th>';\r\n-                            html += '<th>Satƒ±≈ü Adedi</th>';\r\n                             html += '<th>Toplam Tutar</th>';\r\n                             html += '</tr>';\r\n                             html += '</thead>';\r\n                             html += '<tbody>';\r\n                             \r\n-                            var toplamAdet = 0;\r\n                             var toplamTutar = 0;\r\n                             \r\n                             response.data.forEach(function(item) {\r\n-                                toplamAdet += parseInt(item.satis_adedi);\r\n                                 toplamTutar += parseFloat(item.toplam_tutar);\r\n                                 \r\n                                 html += '<tr>';\r\n                                 html += '<td>' + (item.cari_ad || '-') + '</td>';\r\n                                 html += '<td>' + (item.il_adi || '-') + '</td>';\r\n                                 html += '<td>' + (item.ilce_adi || '-') + '</td>';\r\n                                 html += '<td>' + (item.cari_firmaTelefon || '-') + '</td>';\r\n-                                html += '<td class=\"text-center\"><span class=\"badge badge-info\">' + item.satis_adedi + '</span></td>';\r\n                                 html += '<td class=\"text-right\">' + parseFloat(item.toplam_tutar).toLocaleString('tr-TR', {minimumFractionDigits: 2}) + ' ‚Ç∫</td>';\r\n                                 html += '</tr>';\r\n                             });\r\n                             \r\n                             html += '</tbody>';\r\n                             html += '<tfoot class=\"thead-light\">';\r\n                             html += '<tr>';\r\n                             html += '<th colspan=\"4\" class=\"text-right\">TOPLAM:</th>';\r\n-                            html += '<th class=\"text-center\"><span class=\"badge badge-success\">' + toplamAdet + '</span></th>';\r\n                             html += '<th class=\"text-right\">' + toplamTutar.toLocaleString('tr-TR', {minimumFractionDigits: 2}) + ' ‚Ç∫</th>';\r\n                             html += '</tr>';\r\n                             html += '</tfoot>';\r\n                             html += '</table>';\r\n"
                },
                {
                    "date": 1755009112303,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -932,45 +932,52 @@\n                         bitis_tarihi: bitis\r\n                     },\r\n                     dataType: 'json',\r\n                     success: function(response) {\r\n+                        console.log('AJAX Response:', response);\r\n+                        \r\n                         if (response.error) {\r\n                             $('#musteriDetayIcerik').html('<div class=\"alert alert-danger\">' + response.error + '</div>');\r\n                             return;\r\n                         }\r\n                         \r\n-                        if (response.data && response.data.length > 0) {\r\n+                        if (response.success && response.data && response.data.length > 0) {\r\n                             var html = '<div class=\"table-responsive\">';\r\n                             html += '<table class=\"table table-striped table-hover\">';\r\n                             html += '<thead class=\"thead-dark\">';\r\n                             html += '<tr>';\r\n                             html += '<th>Cari Ad</th>';\r\n                             html += '<th>ƒ∞l</th>';\r\n                             html += '<th>ƒ∞l√ße</th>';\r\n                             html += '<th>Telefon</th>';\r\n+                            html += '<th>Satƒ±≈ü Adedi</th>';\r\n                             html += '<th>Toplam Tutar</th>';\r\n                             html += '</tr>';\r\n                             html += '</thead>';\r\n                             html += '<tbody>';\r\n                             \r\n+                            var toplamAdet = 0;\r\n                             var toplamTutar = 0;\r\n                             \r\n                             response.data.forEach(function(item) {\r\n+                                toplamAdet += parseInt(item.satis_adedi);\r\n                                 toplamTutar += parseFloat(item.toplam_tutar);\r\n                                 \r\n                                 html += '<tr>';\r\n                                 html += '<td>' + (item.cari_ad || '-') + '</td>';\r\n                                 html += '<td>' + (item.il_adi || '-') + '</td>';\r\n                                 html += '<td>' + (item.ilce_adi || '-') + '</td>';\r\n                                 html += '<td>' + (item.cari_firmaTelefon || '-') + '</td>';\r\n+                                html += '<td class=\"text-center\"><span class=\"badge badge-info\">' + item.satis_adedi + '</span></td>';\r\n                                 html += '<td class=\"text-right\">' + parseFloat(item.toplam_tutar).toLocaleString('tr-TR', {minimumFractionDigits: 2}) + ' ‚Ç∫</td>';\r\n                                 html += '</tr>';\r\n                             });\r\n                             \r\n                             html += '</tbody>';\r\n                             html += '<tfoot class=\"thead-light\">';\r\n                             html += '<tr>';\r\n                             html += '<th colspan=\"4\" class=\"text-right\">TOPLAM:</th>';\r\n+                            html += '<th class=\"text-center\"><span class=\"badge badge-success\">' + toplamAdet + '</span></th>';\r\n                             html += '<th class=\"text-right\">' + toplamTutar.toLocaleString('tr-TR', {minimumFractionDigits: 2}) + ' ‚Ç∫</th>';\r\n                             html += '</tr>';\r\n                             html += '</tfoot>';\r\n                             html += '</table>';\r\n"
                },
                {
                    "date": 1755009223185,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -948,36 +948,33 @@\n                             html += '<th>Cari Ad</th>';\r\n                             html += '<th>ƒ∞l</th>';\r\n                             html += '<th>ƒ∞l√ße</th>';\r\n                             html += '<th>Telefon</th>';\r\n-                            html += '<th>Satƒ±≈ü Adedi</th>';\r\n+                            html += '<th>Personel</th>';\r\n                             html += '<th>Toplam Tutar</th>';\r\n                             html += '</tr>';\r\n                             html += '</thead>';\r\n                             html += '<tbody>';\r\n                             \r\n-                            var toplamAdet = 0;\r\n                             var toplamTutar = 0;\r\n                             \r\n                             response.data.forEach(function(item) {\r\n-                                toplamAdet += parseInt(item.satis_adedi);\r\n                                 toplamTutar += parseFloat(item.toplam_tutar);\r\n                                 \r\n                                 html += '<tr>';\r\n                                 html += '<td>' + (item.cari_ad || '-') + '</td>';\r\n                                 html += '<td>' + (item.il_adi || '-') + '</td>';\r\n                                 html += '<td>' + (item.ilce_adi || '-') + '</td>';\r\n                                 html += '<td>' + (item.cari_firmaTelefon || '-') + '</td>';\r\n-                                html += '<td class=\"text-center\"><span class=\"badge badge-info\">' + item.satis_adedi + '</span></td>';\r\n+                                html += '<td>' + (item.personel_adsoyad || '-') + '</td>';\r\n                                 html += '<td class=\"text-right\">' + parseFloat(item.toplam_tutar).toLocaleString('tr-TR', {minimumFractionDigits: 2}) + ' ‚Ç∫</td>';\r\n                                 html += '</tr>';\r\n                             });\r\n                             \r\n                             html += '</tbody>';\r\n                             html += '<tfoot class=\"thead-light\">';\r\n                             html += '<tr>';\r\n-                            html += '<th colspan=\"4\" class=\"text-right\">TOPLAM:</th>';\r\n-                            html += '<th class=\"text-center\"><span class=\"badge badge-success\">' + toplamAdet + '</span></th>';\r\n+                            html += '<th colspan=\"5\" class=\"text-right\">TOPLAM:</th>';\r\n                             html += '<th class=\"text-right\">' + toplamTutar.toLocaleString('tr-TR', {minimumFractionDigits: 2}) + ' ‚Ç∫</th>';\r\n                             html += '</tr>';\r\n                             html += '</tfoot>';\r\n                             html += '</table>';\r\n"
                },
                {
                    "date": 1755009447150,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -897,8 +897,11 @@\n                             </div>\r\n                         </div>\r\n                     </div>\r\n                     <div class=\"modal-footer\">\r\n+                        <button type=\"button\" class=\"btn btn-success\" id=\"excelIndir\" onclick=\"exportModalToExcel()\">\r\n+                            <i class=\"fas fa-file-excel\"></i> Excel'e ƒ∞ndir\r\n+                        </button>\r\n                         <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">Kapat</button>\r\n                     </div>\r\n                 </div>\r\n             </div>\r\n@@ -992,8 +995,74 @@\n                     }\r\n                 });\r\n             });\r\n         });\r\n+\r\n+        // Modal i√ßindeki tabloyu Excel'e aktarma fonksiyonu\r\n+        function exportModalToExcel() {\r\n+            var modalTable = $('#musteriDetayIcerik table');\r\n+            \r\n+            if (modalTable.length === 0) {\r\n+                alert('ƒ∞ndirmek i√ßin √∂nce veri y√ºklenmelidir!');\r\n+                return;\r\n+            }\r\n+            \r\n+            var data = [];\r\n+            var sehirAdi = $('#musteriDetayModalLabel').text().replace(' - M√º≈üteri Detaylarƒ±', '');\r\n+            \r\n+            // Ba≈ülƒ±k satƒ±rƒ±\r\n+            var headers = [];\r\n+            modalTable.find('thead th').each(function() {\r\n+                headers.push($(this).text());\r\n+            });\r\n+            data.push(headers);\r\n+            \r\n+            // Veri satƒ±rlarƒ±\r\n+            modalTable.find('tbody tr').each(function() {\r\n+                var rowData = [];\r\n+                $(this).find('td').each(function() {\r\n+                    var cellText = $(this).text().replace('‚Ç∫', '').replace(/\\s+/g, ' ').trim();\r\n+                    rowData.push(cellText);\r\n+                });\r\n+                if (rowData.length > 0) {\r\n+                    data.push(rowData);\r\n+                }\r\n+            });\r\n+            \r\n+            // Toplam satƒ±rƒ± (varsa)\r\n+            modalTable.find('tfoot tr').each(function() {\r\n+                var rowData = [];\r\n+                $(this).find('th').each(function() {\r\n+                    var cellText = $(this).text().replace('‚Ç∫', '').replace(/\\s+/g, ' ').trim();\r\n+                    rowData.push(cellText);\r\n+                });\r\n+                if (rowData.length > 0) {\r\n+                    data.push(rowData);\r\n+                }\r\n+            });\r\n+            \r\n+            // Excel dosyasƒ± olu≈ütur\r\n+            var wb = XLSX.utils.book_new();\r\n+            var ws = XLSX.utils.aoa_to_sheet(data);\r\n+            \r\n+            // S√ºtun geni≈üliklerini ayarla\r\n+            var colWidths = [\r\n+                {wch: 25}, // Cari Ad\r\n+                {wch: 15}, // ƒ∞l\r\n+                {wch: 15}, // ƒ∞l√ße\r\n+                {wch: 15}, // Telefon\r\n+                {wch: 20}, // Personel\r\n+                {wch: 15}  // Toplam Tutar\r\n+            ];\r\n+            ws['!cols'] = colWidths;\r\n+            \r\n+            XLSX.utils.book_append_sheet(wb, ws, sehirAdi + \" Detayƒ±\");\r\n+            \r\n+            // Dosya adƒ±nƒ± olu≈ütur\r\n+            var fileName = sehirAdi.replace(/[^a-zA-Z0-9]/g, '_') + \"_musteri_detaylari_\" + new Date().toISOString().slice(0,10) + \".xlsx\";\r\n+            \r\n+            XLSX.writeFile(wb, fileName);\r\n+        }\r\n         </script>\r\n \r\n     </body>\r\n \r\n"
                },
                {
                    "date": 1755189770638,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -305,8 +305,32 @@\n                         </div>\r\n \r\n                         <div class=\"card-body\">\r\n \r\n+                            <!-- Legend -->\r\n+\r\n+                            <div class=\"row mb-3\">\r\n+\r\n+                                <div class=\"col-12\">\r\n+\r\n+                                    <div class=\"alert alert-info\">\r\n+\r\n+                                        <strong>A√ßƒ±klama:</strong> \r\n+\r\n+                                        <span class=\"badge badge-success ml-2\">Digiturk</span> \r\n+\r\n+                                        <span class=\"badge badge-warning ml-2\">S Sport</span>\r\n+\r\n+                                        <span class=\"badge badge-info ml-2\">Toplam</span>\r\n+\r\n+                                        <small class=\"text-muted ml-3\">M√º≈üteri adƒ±nda veya a√ßƒ±klamasƒ±nda \"S SPORT\" ge√ßenler S Sport olarak kategorize edilmi≈ütir.</small>\r\n+\r\n+                                    </div>\r\n+\r\n+                                </div>\r\n+\r\n+                            </div>\r\n+\r\n                             <div class=\"table-responsive\">\r\n \r\n                                 <table class=\"table table-striped table-hover\" id=\"raporTablosu\">\r\n \r\n@@ -317,8 +341,12 @@\n                                             <th>#</th>\r\n \r\n                                             <th>≈ûehir</th>\r\n \r\n+                                            <th>Digiturk Satƒ±≈ü Adedi</th>\r\n+\r\n+                                            <th>S Sport Satƒ±≈ü Adedi</th>\r\n+\r\n                                             <th>Toplam Satƒ±≈ü Adedi</th>\r\n \r\n                                             <th>Toplam Ciro (‚Ç∫)</th>\r\n \r\n@@ -333,16 +361,24 @@\n                                         <?php \r\n \r\n                                         $toplam_adet = 0;\r\n \r\n+                                        $toplam_digiturk = 0;\r\n+\r\n+                                        $toplam_ssport = 0;\r\n+\r\n                                         $toplam_ciro = 0;\r\n \r\n                                         $sira = 1;\r\n \r\n                                         foreach($rapor_verileri as $veri): \r\n \r\n                                             $toplam_adet += $veri->toplam_satis_adedi;\r\n \r\n+                                            $toplam_digiturk += $veri->digiturk_satis_adedi;\r\n+\r\n+                                            $toplam_ssport += $veri->ssport_satis_adedi;\r\n+\r\n                                             $toplam_ciro += $veri->toplam_ciro;\r\n \r\n                                             $ortalama_satis = $veri->toplam_satis_adedi > 0 ? ($veri->toplam_ciro / $veri->toplam_satis_adedi) : 0;\r\n \r\n@@ -358,8 +394,14 @@\n \r\n                                             </td>\r\n \r\n                                             <td class=\"text-center\">\r\n+                                                <span class=\"badge badge-success\"><?= number_format($veri->digiturk_satis_adedi) ?></span>\r\n+                                            </td>\r\n+                                            <td class=\"text-center\">\r\n+                                                <span class=\"badge badge-warning\"><?= number_format($veri->ssport_satis_adedi) ?></span>\r\n+                                            </td>\r\n+                                            <td class=\"text-center\">\r\n                                                 <button type=\"button\" \r\n                                                         class=\"btn btn-link p-0 satis-detay-btn\" \r\n                                                         data-sehir-id=\"<?= $veri->cari_il ?>\" \r\n                                                         data-sehir-adi=\"<?= $veri->sehir_adi ?? 'Belirtilmemi≈ü' ?>\"\r\n@@ -391,9 +433,9 @@\n                                         <?php if(empty($rapor_verileri)): ?>\r\n \r\n                                         <tr>\r\n \r\n-                                            <td colspan=\"5\" class=\"text-center text-muted\">\r\n+                                            <td colspan=\"7\" class=\"text-center text-muted\">\r\n \r\n                                                 <i class=\"fas fa-info-circle\"></i>\r\n \r\n                                                 Se√ßilen tarih aralƒ±ƒüƒ±nda veri bulunamadƒ±.\r\n@@ -415,12 +457,24 @@\n                                             <th colspan=\"2\" class=\"text-right\">TOPLAM:</th>\r\n \r\n                                             <th class=\"text-center\">\r\n \r\n-                                                <span class=\"badge badge-success\"><?= number_format($toplam_adet) ?></span>\r\n+                                                <span class=\"badge badge-success\"><?= number_format($toplam_digiturk) ?></span>\r\n \r\n                                             </th>\r\n \r\n+                                            <th class=\"text-center\">\r\n+\r\n+                                                <span class=\"badge badge-warning\"><?= number_format($toplam_ssport) ?></span>\r\n+\r\n+                                            </th>\r\n+\r\n+                                            <th class=\"text-center\">\r\n+\r\n+                                                <span class=\"badge badge-info\"><?= number_format($toplam_adet) ?></span>\r\n+\r\n+                                            </th>\r\n+\r\n                                             <th class=\"text-right\">\r\n \r\n                                                 <strong><?= number_format($toplam_ciro, 2) ?> ‚Ç∫</strong>\r\n \r\n"
                },
                {
                    "date": 1755189876619,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -31,8 +31,36 @@\n             }\r\n \r\n         }\r\n \r\n+        \r\n+\r\n+        /* Satƒ±≈ü adedi s√ºtunlarƒ±nƒ±n aralƒ±ƒüƒ±nƒ± daralt */\r\n+\r\n+        #raporTablosu th:nth-child(3),\r\n+\r\n+        #raporTablosu th:nth-child(4), \r\n+\r\n+        #raporTablosu th:nth-child(5),\r\n+\r\n+        #raporTablosu td:nth-child(3),\r\n+\r\n+        #raporTablosu td:nth-child(4),\r\n+\r\n+        #raporTablosu td:nth-child(5) {\r\n+\r\n+            width: 100px !important;\r\n+\r\n+            min-width: 100px !important;\r\n+\r\n+            max-width: 100px !important;\r\n+\r\n+            padding: 8px 4px !important;\r\n+\r\n+            text-align: center !important;\r\n+\r\n+        }\r\n+\r\n     </style>\r\n \r\n </head>\r\n \r\n@@ -341,13 +369,13 @@\n                                             <th>#</th>\r\n \r\n                                             <th>≈ûehir</th>\r\n \r\n-                                            <th>Digiturk Satƒ±≈ü Adedi</th>\r\n+                                            <th>Digiturk Adedi</th>\r\n \r\n-                                            <th>S Sport Satƒ±≈ü Adedi</th>\r\n+                                            <th>S Sport Adedi</th>\r\n \r\n-                                            <th>Toplam Satƒ±≈ü Adedi</th>\r\n+                                            <th>Toplam Adedi</th>\r\n \r\n                                             <th>Toplam Ciro (‚Ç∫)</th>\r\n \r\n                                             <th>Ortalama Satƒ±≈ü Tutarƒ± (‚Ç∫)</th>\r\n"
                },
                {
                    "date": 1755619458030,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -349,9 +349,9 @@\n                                         <span class=\"badge badge-warning ml-2\">S Sport</span>\r\n \r\n                                         <span class=\"badge badge-info ml-2\">Toplam</span>\r\n \r\n-                                        <small class=\"text-muted ml-3\">M√º≈üteri adƒ±nda veya a√ßƒ±klamasƒ±nda \"S SPORT\" ge√ßenler S Sport olarak kategorize edilmi≈ütir.</small>\r\n+                                        <small class=\"text-muted ml-3\">Stok gruplarƒ±na g√∂re kategorilendirme: Digiturk (stok grup ID: 1), S Sport (stok grup ID: 279).</small>\r\n \r\n                                     </div>\r\n \r\n                                 </div>\r\n"
                },
                {
                    "date": 1755671089850,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -41,14 +41,18 @@\n         #raporTablosu th:nth-child(4), \r\n \r\n         #raporTablosu th:nth-child(5),\r\n \r\n+        #raporTablosu th:nth-child(7),\r\n+\r\n         #raporTablosu td:nth-child(3),\r\n \r\n         #raporTablosu td:nth-child(4),\r\n \r\n-        #raporTablosu td:nth-child(5) {\r\n+        #raporTablosu td:nth-child(5),\r\n \r\n+        #raporTablosu td:nth-child(7) {\r\n+\r\n             width: 100px !important;\r\n \r\n             min-width: 100px !important;\r\n \r\n"
                },
                {
                    "date": 1755673840712,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -33,10 +33,68 @@\n         }\r\n \r\n         \r\n \r\n-        /* Satƒ±≈ü adedi s√ºtunlarƒ±nƒ±n aralƒ±ƒüƒ±nƒ± daralt */\r\n+        /* Tablo genel optimizasyonlarƒ± */\r\n \r\n+        #raporTablosu {\r\n+\r\n+            font-size: 14px;\r\n+\r\n+            white-space: nowrap;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        #raporTablosu th,\r\n+\r\n+        #raporTablosu td {\r\n+\r\n+            padding: 8px 6px !important;\r\n+\r\n+            vertical-align: middle;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        /* Sƒ±ra numarasƒ± s√ºtunu dar */\r\n+\r\n+        #raporTablosu th:nth-child(1),\r\n+\r\n+        #raporTablosu td:nth-child(1) {\r\n+\r\n+            width: 40px !important;\r\n+\r\n+            min-width: 40px !important;\r\n+\r\n+            max-width: 40px !important;\r\n+\r\n+            text-align: center !important;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        /* ≈ûehir s√ºtunu orta geni≈ülik */\r\n+\r\n+        #raporTablosu th:nth-child(2),\r\n+\r\n+        #raporTablosu td:nth-child(2) {\r\n+\r\n+            width: 150px !important;\r\n+\r\n+            min-width: 150px !important;\r\n+\r\n+            max-width: 150px !important;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        /* Sayƒ±sal s√ºtunlar kompakt */\r\n+\r\n         #raporTablosu th:nth-child(3),\r\n \r\n         #raporTablosu th:nth-child(4), \r\n \r\n@@ -51,20 +109,144 @@\n         #raporTablosu td:nth-child(5),\r\n \r\n         #raporTablosu td:nth-child(7) {\r\n \r\n-            width: 100px !important;\r\n+            width: 90px !important;\r\n \r\n-            min-width: 100px !important;\r\n+            min-width: 90px !important;\r\n \r\n-            max-width: 100px !important;\r\n+            max-width: 90px !important;\r\n \r\n             padding: 8px 4px !important;\r\n \r\n             text-align: center !important;\r\n \r\n         }\r\n \r\n+        \r\n+\r\n+        /* Ciro s√ºtunu biraz daha geni≈ü */\r\n+\r\n+        #raporTablosu th:nth-child(6),\r\n+\r\n+        #raporTablosu td:nth-child(6) {\r\n+\r\n+            width: 120px !important;\r\n+\r\n+            min-width: 120px !important;\r\n+\r\n+            max-width: 120px !important;\r\n+\r\n+            text-align: right !important;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        /* Tablo responsive container */\r\n+\r\n+        .table-responsive {\r\n+\r\n+            margin: 0 -15px;\r\n+\r\n+            padding: 0 15px;\r\n+\r\n+            overflow-x: auto;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        /* Sayfa ba≈ülƒ±ƒüƒ± kompakt */\r\n+\r\n+        .page-header {\r\n+\r\n+            margin-bottom: 15px;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        /* Kart padding azalt */\r\n+\r\n+        .card-body {\r\n+\r\n+            padding: 1rem;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        /* Filtreleme alanƒ±nƒ± vurgula */\r\n+\r\n+        .form-control-lg {\r\n+\r\n+            box-shadow: 0 0 10px rgba(0,123,255,0.25);\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        /* Select2 Styling */\r\n+\r\n+        .select2-container--default .select2-selection--single {\r\n+\r\n+            height: calc(2.75rem + 2px);\r\n+\r\n+            border: 2px solid #007bff;\r\n+\r\n+            background-color: #f8f9fa;\r\n+\r\n+            border-radius: 0.375rem;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        .select2-container--default .select2-selection--single .select2-selection__rendered {\r\n+\r\n+            line-height: calc(2.75rem - 2px);\r\n+\r\n+            padding-left: 12px;\r\n+\r\n+            font-weight: bold;\r\n+\r\n+            color: #495057;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        .select2-container--default .select2-selection--single .select2-selection__arrow {\r\n+\r\n+            height: calc(2.75rem - 2px);\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        /* Mobil responsive iyile≈ütirmeler */\r\n+\r\n+        @media (max-width: 992px) {\r\n+\r\n+            #raporTablosu {\r\n+\r\n+                font-size: 12px;\r\n+\r\n+            }\r\n+\r\n+            \r\n+\r\n+            #raporTablosu th,\r\n+\r\n+            #raporTablosu td {\r\n+\r\n+                padding: 6px 3px !important;\r\n+\r\n+            }\r\n+\r\n+        }\r\n+\r\n     </style>\r\n \r\n </head>\r\n \r\n@@ -135,8 +317,70 @@\n                 <!-- /Page Header -->\r\n \r\n \r\n \r\n+            <!-- Aktif Filtre Bildirimi -->\r\n+\r\n+            <?php if (!empty($sehir_id)): ?>\r\n+\r\n+            <div class=\"row mb-3\">\r\n+\r\n+                <div class=\"col-md-12\">\r\n+\r\n+                    <div class=\"alert alert-info alert-dismissible fade show\" role=\"alert\">\r\n+\r\n+                        <i class=\"fas fa-info-circle\"></i>\r\n+\r\n+                        <strong>Filtre Aktif:</strong> Sadece \r\n+\r\n+                        <strong>\r\n+\r\n+                        <?php \r\n+\r\n+                        $secili_sehir_adi = 'Bilinmeyen ≈ûehir';\r\n+\r\n+                        foreach($sehir_listesi as $sehir) {\r\n+\r\n+                            if($sehir->id == $sehir_id) {\r\n+\r\n+                                $secili_sehir_adi = $sehir->sehir_adi;\r\n+\r\n+                                break;\r\n+\r\n+                            }\r\n+\r\n+                        }\r\n+\r\n+                        echo $secili_sehir_adi;\r\n+\r\n+                        ?>\r\n+\r\n+                        </strong> \r\n+\r\n+                        ≈üehrindeki veriler g√∂steriliyor. \r\n+\r\n+                        <a href=\"<?= base_url('raporlar/digiturk-sehir-ciro-adet?baslangic_tarihi='.$baslangic_tarihi.'&bitis_tarihi='.$bitis_tarihi) ?>\" \r\n+\r\n+                           class=\"btn btn-sm btn-outline-primary ml-2\">\r\n+\r\n+                            <i class=\"fas fa-times\"></i> Filtreyi Kaldƒ±r\r\n+\r\n+                        </a>\r\n+\r\n+                        <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\">\r\n+\r\n+                            <span aria-hidden=\"true\">&times;</span>\r\n+\r\n+                        </button>\r\n+\r\n+                    </div>\r\n+\r\n+                </div>\r\n+\r\n+            </div>\r\n+\r\n+            <?php endif; ?>\r\n+\r\n             <!-- Filtreler -->\r\n \r\n             <div class=\"row\">\r\n \r\n@@ -159,17 +403,43 @@\n                                     <div class=\"col-md-3\">\r\n \r\n                                         <div class=\"form-group\">\r\n \r\n+                                            <label for=\"sehir_id\"><i class=\"fas fa-map-marker-alt\"></i> <strong>≈ûehir Se√ß</strong></label>\r\n+\r\n+                                            <select class=\"form-control form-control-lg\" id=\"sehir_id\" name=\"sehir_id\" style=\"border: 2px solid #007bff; background-color: #f8f9fa;\">\r\n+\r\n+                                                <option value=\"\">üèôÔ∏è T√ºm ≈ûehirler</option>\r\n+\r\n+                                                <?php foreach($sehir_listesi as $sehir): ?>\r\n+\r\n+                                                    <option value=\"<?= $sehir->id ?>\" <?= ($sehir_id == $sehir->id) ? 'selected' : '' ?>>\r\n+\r\n+                                                        <?= $sehir->sehir_adi ?>\r\n+\r\n+                                                    </option>\r\n+\r\n+                                                <?php endforeach; ?>\r\n+\r\n+                                            </select>\r\n+\r\n+                                        </div>\r\n+\r\n+                                    </div>\r\n+\r\n+                                    <div class=\"col-md-2\">\r\n+\r\n+                                        <div class=\"form-group\">\r\n+\r\n                                             <label for=\"baslangic_tarihi\">Ba≈ülangƒ±√ß Tarihi</label>\r\n \r\n                                             <input type=\"date\" class=\"form-control\" id=\"baslangic_tarihi\" name=\"baslangic_tarihi\" value=\"<?= $baslangic_tarihi ?>\">\r\n \r\n                                         </div>\r\n \r\n                                     </div>\r\n \r\n-                                    <div class=\"col-md-3\">\r\n+                                    <div class=\"col-md-2\">\r\n \r\n                                         <div class=\"form-group\">\r\n \r\n                                             <label for=\"bitis_tarihi\">Biti≈ü Tarihi</label>\r\n@@ -179,29 +449,29 @@\n                                         </div>\r\n \r\n                                     </div>\r\n \r\n-                                    <div class=\"col-md-4\">\r\n+                                    <div class=\"col-md-3\">\r\n \r\n                                         <div class=\"form-group\">\r\n \r\n-                                            <label for=\"sehir_id\">≈ûehir</label>\r\n+                                            <label>&nbsp;</label>\r\n \r\n-                                            <select class=\"form-control\" id=\"sehir_id\" name=\"sehir_id\">\r\n+                                            <div class=\"d-flex\">\r\n \r\n-                                                <option value=\"\">T√ºm ≈ûehirler</option>\r\n+                                                <button type=\"submit\" class=\"btn btn-primary btn-lg mr-2\">\r\n \r\n-                                                <?php foreach($sehir_listesi as $sehir): ?>\r\n+                                                    <i class=\"fas fa-filter\"></i> Filtrele\r\n \r\n-                                                    <option value=\"<?= $sehir->id ?>\" <?= ($sehir_id == $sehir->id) ? 'selected' : '' ?>>\r\n+                                                </button>\r\n \r\n-                                                        <?= $sehir->sehir_adi ?>\r\n+                                                <button type=\"button\" class=\"btn btn-secondary btn-lg\" onclick=\"resetFilters()\">\r\n \r\n-                                                    </option>\r\n+                                                    <i class=\"fas fa-undo\"></i> Temizle\r\n \r\n-                                                <?php endforeach; ?>\r\n+                                                </button>\r\n \r\n-                                            </select>\r\n+                                            </div>\r\n \r\n                                         </div>\r\n \r\n                                     </div>\r\n@@ -213,11 +483,11 @@\n                                             <label>&nbsp;</label>\r\n \r\n                                             <div>\r\n \r\n-                                                <button type=\"submit\" class=\"btn btn-primary w-100\">\r\n+                                                <button type=\"button\" class=\"btn btn-success btn-lg w-100\" onclick=\"exportToExcel()\">\r\n \r\n-                                                    <i class=\"fas fa-filter\"></i> Filtrele\r\n+                                                    <i class=\"fas fa-file-excel\"></i> Excel\r\n \r\n                                                 </button>\r\n \r\n                                             </div>\r\n@@ -363,27 +633,27 @@\n                             </div>\r\n \r\n                             <div class=\"table-responsive\">\r\n \r\n-                                <table class=\"table table-striped table-hover\" id=\"raporTablosu\">\r\n+                                <table class=\"table table-striped table-hover table-sm\" id=\"raporTablosu\">\r\n \r\n                                     <thead class=\"thead-dark\">\r\n \r\n                                         <tr>\r\n \r\n                                             <th>#</th>\r\n \r\n-                                            <th>≈ûehir</th>\r\n+                                            <th><i class=\"fas fa-map-marker-alt\"></i> ≈ûehir</th>\r\n \r\n-                                            <th>Digiturk Adedi</th>\r\n+                                            <th><i class=\"fas fa-tv\"></i> Digiturk</th>\r\n \r\n-                                            <th>S Sport Adedi</th>\r\n+                                            <th><i class=\"fas fa-futbol\"></i> S Sport</th>\r\n \r\n-                                            <th>Toplam Adedi</th>\r\n+                                            <th><i class=\"fas fa-chart-bar\"></i> Toplam</th>\r\n \r\n-                                            <th>Toplam Ciro (‚Ç∫)</th>\r\n+                                            <th><i class=\"fas fa-lira-sign\"></i> Ciro</th>\r\n \r\n-                                            <th>Ortalama Satƒ±≈ü Tutarƒ± (‚Ç∫)</th>\r\n+                                            <th><i class=\"fas fa-calculator\"></i> Ortalama</th>\r\n \r\n                                         </tr>\r\n \r\n                                     </thead>\r\n@@ -717,48 +987,122 @@\n         <!-- SheetJS i√ßin Excel Export -->\r\n \r\n         <script src=\"https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js\"></script>\r\n \r\n+        \r\n \r\n+        <!-- Select2 for better city selection -->\r\n \r\n+        <link href=\"https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css\" rel=\"stylesheet\" />\r\n+\r\n+        <script src=\"https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js\"></script>\r\n+\r\n+\r\n+\r\n         <?php $this->load->view(\"include/footer-js\"); ?>\r\n \r\n \r\n \r\n         <script>\r\n \r\n         $(document).ready(function() {\r\n \r\n-            // DataTable ba≈ülatma\r\n+            // Select2 ba≈ülatma - ≈ûehir se√ßimi i√ßin arama √∂zelliƒüi\r\n \r\n+            $('#sehir_id').select2({\r\n+\r\n+                placeholder: 'üîç ≈ûehir arayƒ±n veya se√ßin...',\r\n+\r\n+                allowClear: true,\r\n+\r\n+                language: {\r\n+\r\n+                    noResults: function() {\r\n+\r\n+                        return \"Sonu√ß bulunamadƒ±\";\r\n+\r\n+                    },\r\n+\r\n+                    searching: function() {\r\n+\r\n+                        return \"Aranƒ±yor...\";\r\n+\r\n+                    }\r\n+\r\n+                }\r\n+\r\n+            });\r\n+\r\n+\r\n+\r\n+            // DataTable ba≈ülatma - Kompakt g√∂r√ºn√ºm i√ßin optimize edildi\r\n+\r\n             $('#raporTablosu').DataTable({\r\n \r\n                 \"language\": {\r\n \r\n                     \"url\": \"//cdn.datatables.net/plug-ins/1.11.5/i18n/tr.json\"\r\n \r\n                 },\r\n \r\n-                \"pageLength\": 25,\r\n+                \"pageLength\": 50,\r\n \r\n-                \"lengthMenu\": [[10, 25, 50, 100, -1], [10, 25, 50, 100, \"T√ºm√º\"]],\r\n+                \"lengthMenu\": [[25, 50, 100, -1], [25, 50, 100, \"T√ºm√º\"]],\r\n \r\n-                \"order\": [[ 3, \"desc\" ]], // Toplam ciro'ya g√∂re sƒ±rala\r\n+                \"order\": [[ 5, \"desc\" ]], // Toplam ciro'ya g√∂re sƒ±rala (6. s√ºtun, index 5)\r\n \r\n                 \"columnDefs\": [\r\n \r\n                     {\r\n \r\n-                        \"targets\": [2, 3, 4], // Sayƒ±sal s√ºtunlar\r\n+                        \"targets\": [0], // Sƒ±ra numarasƒ±\r\n \r\n-                        \"className\": \"text-right\"\r\n+                        \"className\": \"text-center\",\r\n \r\n+                        \"width\": \"40px\"\r\n+\r\n+                    },\r\n+\r\n+                    {\r\n+\r\n+                        \"targets\": [1], // ≈ûehir adƒ±\r\n+\r\n+                        \"className\": \"text-left\",\r\n+\r\n+                        \"width\": \"150px\"\r\n+\r\n+                    },\r\n+\r\n+                    {\r\n+\r\n+                        \"targets\": [2, 3, 4], // Sayƒ±sal s√ºtunlar (adet)\r\n+\r\n+                        \"className\": \"text-center\",\r\n+\r\n+                        \"width\": \"90px\"\r\n+\r\n+                    },\r\n+\r\n+                    {\r\n+\r\n+                        \"targets\": [5, 6], // Ciro ve ortalama\r\n+\r\n+                        \"className\": \"text-right\",\r\n+\r\n+                        \"width\": \"120px\"\r\n+\r\n                     }\r\n \r\n                 ],\r\n \r\n-                \"dom\": 'Bfrtip',\r\n+                \"dom\": '<\"row\"<\"col-sm-6\"l><\"col-sm-6\"f>>rtip',\r\n \r\n+                \"scrollX\": true,\r\n+\r\n+                \"autoWidth\": false,\r\n+\r\n+                \"responsive\": true,\r\n+\r\n                 \"buttons\": [\r\n \r\n                     'copy', 'csv', 'excel', 'pdf', 'print'\r\n \r\n@@ -769,8 +1113,22 @@\n         });\r\n \r\n \r\n \r\n+        // Filtreleri temizle fonksiyonu\r\n+\r\n+        function resetFilters() {\r\n+\r\n+            document.getElementById('sehir_id').value = '';\r\n+\r\n+            document.getElementById('baslangic_tarihi').value = '<?= date('Y-01-01') ?>';\r\n+\r\n+            document.getElementById('bitis_tarihi').value = '<?= date('Y-m-d') ?>';\r\n+\r\n+        }\r\n+\r\n+\r\n+\r\n         // Excel'e aktarma fonksiyonu\r\n \r\n         function exportToExcel() {\r\n \r\n"
                },
                {
                    "date": 1755677006697,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -37,9 +37,9 @@\n         /* Tablo genel optimizasyonlarƒ± */\r\n \r\n         #raporTablosu {\r\n \r\n-            font-size: 14px;\r\n+            font-size: 12px;\r\n \r\n             white-space: nowrap;\r\n \r\n         }\r\n@@ -49,9 +49,9 @@\n         #raporTablosu th,\r\n \r\n         #raporTablosu td {\r\n \r\n-            padding: 8px 6px !important;\r\n+            padding: 6px 4px !important;\r\n \r\n             vertical-align: middle;\r\n \r\n         }\r\n@@ -63,13 +63,13 @@\n         #raporTablosu th:nth-child(1),\r\n \r\n         #raporTablosu td:nth-child(1) {\r\n \r\n-            width: 40px !important;\r\n+            width: 35px !important;\r\n \r\n-            min-width: 40px !important;\r\n+            min-width: 35px !important;\r\n \r\n-            max-width: 40px !important;\r\n+            max-width: 35px !important;\r\n \r\n             text-align: center !important;\r\n \r\n         }\r\n@@ -81,68 +81,192 @@\n         #raporTablosu th:nth-child(2),\r\n \r\n         #raporTablosu td:nth-child(2) {\r\n \r\n-            width: 150px !important;\r\n+            width: 120px !important;\r\n \r\n-            min-width: 150px !important;\r\n+            min-width: 120px !important;\r\n \r\n-            max-width: 150px !important;\r\n+            max-width: 120px !important;\r\n \r\n         }\r\n \r\n         \r\n \r\n-        /* Sayƒ±sal s√ºtunlar kompakt */\r\n+        /* Digiturk s√ºtunlarƒ± (mor) */\r\n \r\n         #raporTablosu th:nth-child(3),\r\n \r\n-        #raporTablosu th:nth-child(4), \r\n+        #raporTablosu th:nth-child(4),\r\n \r\n         #raporTablosu th:nth-child(5),\r\n \r\n-        #raporTablosu th:nth-child(7),\r\n-\r\n         #raporTablosu td:nth-child(3),\r\n \r\n         #raporTablosu td:nth-child(4),\r\n \r\n-        #raporTablosu td:nth-child(5),\r\n+        #raporTablosu td:nth-child(5) {\r\n \r\n-        #raporTablosu td:nth-child(7) {\r\n+            width: 80px !important;\r\n \r\n-            width: 90px !important;\r\n+            min-width: 80px !important;\r\n \r\n-            min-width: 90px !important;\r\n+            max-width: 80px !important;\r\n \r\n-            max-width: 90px !important;\r\n+        }\r\n \r\n-            padding: 8px 4px !important;\r\n+        \r\n \r\n-            text-align: center !important;\r\n+        /* S Sport s√ºtunlarƒ± (mavi) */\r\n \r\n+        #raporTablosu th:nth-child(6),\r\n+\r\n+        #raporTablosu th:nth-child(7),\r\n+\r\n+        #raporTablosu th:nth-child(8),\r\n+\r\n+        #raporTablosu td:nth-child(6),\r\n+\r\n+        #raporTablosu td:nth-child(7),\r\n+\r\n+        #raporTablosu td:nth-child(8) {\r\n+\r\n+            width: 80px !important;\r\n+\r\n+            min-width: 80px !important;\r\n+\r\n+            max-width: 80px !important;\r\n+\r\n         }\r\n \r\n         \r\n \r\n-        /* Ciro s√ºtunu biraz daha geni≈ü */\r\n+        /* Ortak ve Genel s√ºtunlarƒ± */\r\n \r\n-        #raporTablosu th:nth-child(6),\r\n+        #raporTablosu th:nth-child(9),\r\n \r\n-        #raporTablosu td:nth-child(6) {\r\n+        #raporTablosu th:nth-child(10),\r\n \r\n-            width: 120px !important;\r\n+        #raporTablosu th:nth-child(11),\r\n \r\n-            min-width: 120px !important;\r\n+        #raporTablosu td:nth-child(9),\r\n \r\n-            max-width: 120px !important;\r\n+        #raporTablosu td:nth-child(10),\r\n \r\n-            text-align: right !important;\r\n+        #raporTablosu td:nth-child(11) {\r\n \r\n+            width: 80px !important;\r\n+\r\n+            min-width: 80px !important;\r\n+\r\n+            max-width: 80px !important;\r\n+\r\n         }\r\n \r\n         \r\n \r\n+        /* Renk sƒ±nƒ±flarƒ± - DIGITURK (MOR) */\r\n+\r\n+        .bg-purple {\r\n+\r\n+            background-color: #6f42c1 !important;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        .bg-purple-light {\r\n+\r\n+            background-color: rgba(111, 66, 193, 0.1) !important;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        .text-purple {\r\n+\r\n+            color: #6f42c1 !important;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        .badge-purple {\r\n+\r\n+            background-color: #6f42c1 !important;\r\n+\r\n+            color: white !important;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        /* Renk sƒ±nƒ±flarƒ± - S SPORT (MAVƒ∞) */\r\n+\r\n+        .bg-blue {\r\n+\r\n+            background-color: #007bff !important;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        .bg-blue-light {\r\n+\r\n+            background-color: rgba(0, 123, 255, 0.1) !important;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        .text-blue {\r\n+\r\n+            color: #007bff !important;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        .badge-blue {\r\n+\r\n+            background-color: #007bff !important;\r\n+\r\n+            color: white !important;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        /* Renk sƒ±nƒ±flarƒ± - ORTAK (TURKUAZ) */\r\n+\r\n+        .bg-info-light {\r\n+\r\n+            background-color: rgba(23, 162, 184, 0.1) !important;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        /* Renk sƒ±nƒ±flarƒ± - GENEL TOPLAM (GRƒ∞) */\r\n+\r\n+        .bg-dark-light {\r\n+\r\n+            background-color: rgba(52, 58, 64, 0.1) !important;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        .badge-dark {\r\n+\r\n+            background-color: #343a40 !important;\r\n+\r\n+            color: white !important;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n         /* Tablo responsive container */\r\n \r\n         .table-responsive {\r\n \r\n@@ -229,9 +353,9 @@\n         @media (max-width: 992px) {\r\n \r\n             #raporTablosu {\r\n \r\n-                font-size: 12px;\r\n+                font-size: 11px;\r\n \r\n             }\r\n \r\n             \r\n@@ -239,12 +363,86 @@\n             #raporTablosu th,\r\n \r\n             #raporTablosu td {\r\n \r\n-                padding: 6px 3px !important;\r\n+                padding: 4px 2px !important;\r\n \r\n             }\r\n \r\n+            \r\n+\r\n+            /* Mobilde s√ºtun geni≈üliklerini daha da daralt */\r\n+\r\n+            #raporTablosu th:nth-child(1),\r\n+\r\n+            #raporTablosu td:nth-child(1) {\r\n+\r\n+                width: 25px !important;\r\n+\r\n+                min-width: 25px !important;\r\n+\r\n+            }\r\n+\r\n+            \r\n+\r\n+            #raporTablosu th:nth-child(2),\r\n+\r\n+            #raporTablosu td:nth-child(2) {\r\n+\r\n+                width: 80px !important;\r\n+\r\n+                min-width: 80px !important;\r\n+\r\n+            }\r\n+\r\n+            \r\n+\r\n+            #raporTablosu th:nth-child(3),\r\n+\r\n+            #raporTablosu th:nth-child(5),\r\n+\r\n+            #raporTablosu th:nth-child(7),\r\n+\r\n+            #raporTablosu th:nth-child(8),\r\n+\r\n+            #raporTablosu td:nth-child(3),\r\n+\r\n+            #raporTablosu td:nth-child(5),\r\n+\r\n+            #raporTablosu td:nth-child(7),\r\n+\r\n+            #raporTablosu td:nth-child(8) {\r\n+\r\n+                width: 50px !important;\r\n+\r\n+                min-width: 50px !important;\r\n+\r\n+            }\r\n+\r\n+            \r\n+\r\n+            #raporTablosu th:nth-child(4),\r\n+\r\n+            #raporTablosu th:nth-child(6),\r\n+\r\n+            #raporTablosu th:nth-child(9),\r\n+\r\n+            #raporTablosu th:nth-child(10),\r\n+\r\n+            #raporTablosu td:nth-child(4),\r\n+\r\n+            #raporTablosu td:nth-child(6),\r\n+\r\n+            #raporTablosu td:nth-child(9),\r\n+\r\n+            #raporTablosu td:nth-child(10) {\r\n+\r\n+                width: 60px !important;\r\n+\r\n+                min-width: 60px !important;\r\n+\r\n+            }\r\n+\r\n         }\r\n \r\n     </style>\r\n \r\n@@ -621,12 +819,14 @@\n                                         <span class=\"badge badge-success ml-2\">Digiturk</span> \r\n \r\n                                         <span class=\"badge badge-warning ml-2\">S Sport</span>\r\n \r\n-                                        <span class=\"badge badge-info ml-2\">Toplam</span>\r\n+                                        <span class=\"badge badge-info ml-2\">Ortak</span>\r\n \r\n-                                        <small class=\"text-muted ml-3\">Stok gruplarƒ±na g√∂re kategorilendirme: Digiturk (stok grup ID: 1), S Sport (stok grup ID: 279).</small>\r\n+                                        <span class=\"badge badge-primary ml-2\">Toplam</span>\r\n \r\n+                                        <br><small class=\"text-muted\">Digiturk (stok grup ID: 1), S Sport (stok grup ID: 279), Ortak (hem Digiturk hem S Sport alan m√º≈üteriler)</small>\r\n+\r\n                                     </div>\r\n \r\n                                 </div>\r\n \r\n@@ -639,24 +839,54 @@\n                                     <thead class=\"thead-dark\">\r\n \r\n                                         <tr>\r\n \r\n-                                            <th>#</th>\r\n+                                            <th rowspan=\"2\" class=\"align-middle\">#</th>\r\n \r\n-                                            <th><i class=\"fas fa-map-marker-alt\"></i> ≈ûehir</th>\r\n+                                            <th rowspan=\"2\" class=\"align-middle\"><i class=\"fas fa-map-marker-alt\"></i> ≈ûehir</th>\r\n \r\n-                                            <th><i class=\"fas fa-tv\"></i> Digiturk</th>\r\n+                                            <th colspan=\"3\" class=\"text-center bg-purple text-white\">\r\n \r\n-                                            <th><i class=\"fas fa-futbol\"></i> S Sport</th>\r\n+                                                <i class=\"fas fa-tv\"></i> DIGITURK\r\n \r\n-                                            <th><i class=\"fas fa-chart-bar\"></i> Toplam</th>\r\n+                                            </th>\r\n \r\n-                                            <th><i class=\"fas fa-lira-sign\"></i> Ciro</th>\r\n+                                            <th colspan=\"3\" class=\"text-center bg-blue text-white\">\r\n \r\n-                                            <th><i class=\"fas fa-calculator\"></i> Ortalama</th>\r\n+                                                <i class=\"fas fa-futbol\"></i> S SPORT\r\n \r\n+                                            </th>\r\n+\r\n+                                            <th rowspan=\"2\" class=\"align-middle bg-info text-white\"><i class=\"fas fa-handshake\"></i> Ortak</th>\r\n+\r\n+                                            <th colspan=\"2\" class=\"text-center bg-dark text-white\">\r\n+\r\n+                                                <i class=\"fas fa-chart-bar\"></i> GENEL TOPLAM\r\n+\r\n+                                            </th>\r\n+\r\n                                         </tr>\r\n \r\n+                                        <tr>\r\n+\r\n+                                            <th class=\"bg-purple text-white\">Adet</th>\r\n+\r\n+                                            <th class=\"bg-purple text-white\">Ciro</th>\r\n+\r\n+                                            <th class=\"bg-purple text-white\">Ortalama</th>\r\n+\r\n+                                            <th class=\"bg-blue text-white\">Adet</th>\r\n+\r\n+                                            <th class=\"bg-blue text-white\">Ciro</th>\r\n+\r\n+                                            <th class=\"bg-blue text-white\">Ortalama</th>\r\n+\r\n+                                            <th class=\"bg-dark text-white\">Toplam Adet</th>\r\n+\r\n+                                            <th class=\"bg-dark text-white\">Toplam Ciro</th>\r\n+\r\n+                                        </tr>\r\n+\r\n                                     </thead>\r\n \r\n                                     <tbody>\r\n \r\n@@ -665,10 +895,16 @@\n                                         $toplam_adet = 0;\r\n \r\n                                         $toplam_digiturk = 0;\r\n \r\n+                                        $toplam_digiturk_ciro = 0;\r\n+\r\n                                         $toplam_ssport = 0;\r\n \r\n+                                        $toplam_ssport_ciro = 0;\r\n+\r\n+                                        $toplam_ortak = 0;\r\n+\r\n                                         $toplam_ciro = 0;\r\n \r\n                                         $sira = 1;\r\n \r\n@@ -677,14 +913,30 @@\n                                             $toplam_adet += $veri->toplam_satis_adedi;\r\n \r\n                                             $toplam_digiturk += $veri->digiturk_satis_adedi;\r\n \r\n+                                            $toplam_digiturk_ciro += isset($veri->digiturk_ciro) ? $veri->digiturk_ciro : 0;\r\n+\r\n                                             $toplam_ssport += $veri->ssport_satis_adedi;\r\n \r\n+                                            $toplam_ssport_ciro += isset($veri->ssport_ciro) ? $veri->ssport_ciro : 0;\r\n+\r\n+                                            $toplam_ortak += isset($veri->ortak_satis_adedi) ? $veri->ortak_satis_adedi : 0;\r\n+\r\n                                             $toplam_ciro += $veri->toplam_ciro;\r\n \r\n-                                            $ortalama_satis = $veri->toplam_satis_adedi > 0 ? ($veri->toplam_ciro / $veri->toplam_satis_adedi) : 0;\r\n+                                            \r\n \r\n+                                            // Ortalama hesaplamalarƒ±\r\n+\r\n+                                            $digiturk_ciro_val = isset($veri->digiturk_ciro) ? $veri->digiturk_ciro : 0;\r\n+\r\n+                                            $ssport_ciro_val = isset($veri->ssport_ciro) ? $veri->ssport_ciro : 0;\r\n+\r\n+                                            $digiturk_ortalama = $veri->digiturk_satis_adedi > 0 ? ($digiturk_ciro_val / $veri->digiturk_satis_adedi) : 0;\r\n+\r\n+                                            $ssport_ortalama = $veri->ssport_satis_adedi > 0 ? ($ssport_ciro_val / $veri->ssport_satis_adedi) : 0;\r\n+\r\n                                         ?>\r\n \r\n                                         <tr>\r\n \r\n@@ -695,35 +947,89 @@\n                                                 <strong><?= $veri->sehir_adi ?? 'Belirtilmemi≈ü' ?></strong>\r\n \r\n                                             </td>\r\n \r\n-                                            <td class=\"text-center\">\r\n-                                                <span class=\"badge badge-success\"><?= number_format($veri->digiturk_satis_adedi) ?></span>\r\n+                                            <!-- DIGITURK GRUBU -->\r\n+\r\n+                                            <td class=\"text-center bg-purple-light\">\r\n+\r\n+                                                <span class=\"badge badge-purple\"><?= number_format($veri->digiturk_satis_adedi) ?></span>\r\n+\r\n                                             </td>\r\n-                                            <td class=\"text-center\">\r\n-                                                <span class=\"badge badge-warning\"><?= number_format($veri->ssport_satis_adedi) ?></span>\r\n+\r\n+                                            <td class=\"text-right bg-purple-light\">\r\n+\r\n+                                                <strong class=\"text-purple\"><?= number_format($digiturk_ciro_val, 2) ?> ‚Ç∫</strong>\r\n+\r\n                                             </td>\r\n-                                            <td class=\"text-center\">\r\n+\r\n+                                            <td class=\"text-right bg-purple-light\">\r\n+\r\n+                                                <span class=\"text-purple\"><?= number_format($digiturk_ortalama, 2) ?> ‚Ç∫</span>\r\n+\r\n+                                            </td>\r\n+\r\n+                                            \r\n+\r\n+                                            <!-- S SPORT GRUBU -->\r\n+\r\n+                                            <td class=\"text-center bg-blue-light\">\r\n+\r\n+                                                <span class=\"badge badge-blue\"><?= number_format($veri->ssport_satis_adedi) ?></span>\r\n+\r\n+                                            </td>\r\n+\r\n+                                            <td class=\"text-right bg-blue-light\">\r\n+\r\n+                                                <strong class=\"text-blue\"><?= number_format($ssport_ciro_val, 2) ?> ‚Ç∫</strong>\r\n+\r\n+                                            </td>\r\n+\r\n+                                            <td class=\"text-right bg-blue-light\">\r\n+\r\n+                                                <span class=\"text-blue\"><?= number_format($ssport_ortalama, 2) ?> ‚Ç∫</span>\r\n+\r\n+                                            </td>\r\n+\r\n+                                            \r\n+\r\n+                                            <!-- ORTAK -->\r\n+\r\n+                                            <td class=\"text-center bg-info-light\">\r\n+\r\n+                                                <span class=\"badge badge-info\"><?= number_format(isset($veri->ortak_satis_adedi) ? $veri->ortak_satis_adedi : 0) ?></span>\r\n+\r\n+                                            </td>\r\n+\r\n+                                            \r\n+\r\n+                                            <!-- GENEL TOPLAM GRUBU -->\r\n+\r\n+                                            <td class=\"text-center bg-dark-light\">\r\n+\r\n                                                 <button type=\"button\" \r\n+\r\n                                                         class=\"btn btn-link p-0 satis-detay-btn\" \r\n+\r\n                                                         data-sehir-id=\"<?= $veri->cari_il ?>\" \r\n+\r\n                                                         data-sehir-adi=\"<?= $veri->sehir_adi ?? 'Belirtilmemi≈ü' ?>\"\r\n+\r\n                                                         data-baslangic=\"<?= $baslangic_tarihi ?>\"\r\n+\r\n                                                         data-bitis=\"<?= $bitis_tarihi ?>\"\r\n+\r\n                                                         title=\"M√º≈üteri detaylarƒ±nƒ± g√∂r√ºnt√ºle\">\r\n-                                                    <span class=\"badge badge-primary\"><?= number_format($veri->toplam_satis_adedi) ?></span>\r\n-                                                </button>\r\n-                                            </td>\r\n \r\n-                                            <td class=\"text-right\">\r\n+                                                    <span class=\"badge badge-dark\"><?= number_format($veri->toplam_satis_adedi) ?></span>\r\n \r\n-                                                <strong><?= number_format($veri->toplam_ciro, 2) ?> ‚Ç∫</strong>\r\n+                                                </button>\r\n \r\n                                             </td>\r\n \r\n-                                            <td class=\"text-right\">\r\n+                                            <td class=\"text-right bg-dark-light\">\r\n \r\n-                                                <span class=\"text-muted\"><?= number_format($ortalama_satis, 2) ?> ‚Ç∫</span>\r\n+                                                <strong class=\"text-dark\"><?= number_format($veri->toplam_ciro, 2) ?> ‚Ç∫</strong>\r\n \r\n                                             </td>\r\n \r\n                                         </tr>\r\n@@ -735,9 +1041,9 @@\n                                         <?php if(empty($rapor_verileri)): ?>\r\n \r\n                                         <tr>\r\n \r\n-                                            <td colspan=\"7\" class=\"text-center text-muted\">\r\n+                                            <td colspan=\"11\" class=\"text-center text-muted\">\r\n \r\n                                                 <i class=\"fas fa-info-circle\"></i>\r\n \r\n                                                 Se√ßilen tarih aralƒ±ƒüƒ±nda veri bulunamadƒ±.\r\n@@ -757,42 +1063,78 @@\n                                         <tr>\r\n \r\n                                             <th colspan=\"2\" class=\"text-right\">TOPLAM:</th>\r\n \r\n-                                            <th class=\"text-center\">\r\n+                                            \r\n \r\n-                                                <span class=\"badge badge-success\"><?= number_format($toplam_digiturk) ?></span>\r\n+                                            <!-- DIGITURK TOPLAM -->\r\n \r\n+                                            <th class=\"text-center bg-purple-light\">\r\n+\r\n+                                                <span class=\"badge badge-purple\"><?= number_format($toplam_digiturk) ?></span>\r\n+\r\n                                             </th>\r\n \r\n-                                            <th class=\"text-center\">\r\n+                                            <th class=\"text-right bg-purple-light\">\r\n \r\n-                                                <span class=\"badge badge-warning\"><?= number_format($toplam_ssport) ?></span>\r\n+                                                <strong class=\"text-purple\"><?= number_format($toplam_digiturk_ciro, 2) ?> ‚Ç∫</strong>\r\n \r\n                                             </th>\r\n \r\n-                                            <th class=\"text-center\">\r\n+                                            <th class=\"text-right bg-purple-light\">\r\n \r\n-                                                <span class=\"badge badge-info\"><?= number_format($toplam_adet) ?></span>\r\n+                                                <strong class=\"text-purple\"><?= $toplam_digiturk > 0 ? number_format($toplam_digiturk_ciro / $toplam_digiturk, 2) : '0.00' ?> ‚Ç∫</strong>\r\n \r\n                                             </th>\r\n \r\n-                                            <th class=\"text-right\">\r\n+                                            \r\n \r\n-                                                <strong><?= number_format($toplam_ciro, 2) ?> ‚Ç∫</strong>\r\n+                                            <!-- S SPORT TOPLAM -->\r\n \r\n+                                            <th class=\"text-center bg-blue-light\">\r\n+\r\n+                                                <span class=\"badge badge-blue\"><?= number_format($toplam_ssport) ?></span>\r\n+\r\n                                             </th>\r\n \r\n-                                            <th class=\"text-right\">\r\n+                                            <th class=\"text-right bg-blue-light\">\r\n \r\n-                                                <span class=\"text-success\">\r\n+                                                <strong class=\"text-blue\"><?= number_format($toplam_ssport_ciro, 2) ?> ‚Ç∫</strong>\r\n \r\n-                                                    <strong><?= $toplam_adet > 0 ? number_format($toplam_ciro / $toplam_adet, 2) : '0.00' ?> ‚Ç∫</strong>\r\n+                                            </th>\r\n \r\n-                                                </span>\r\n+                                            <th class=\"text-right bg-blue-light\">\r\n \r\n+                                                <strong class=\"text-blue\"><?= $toplam_ssport > 0 ? number_format($toplam_ssport_ciro / $toplam_ssport, 2) : '0.00' ?> ‚Ç∫</strong>\r\n+\r\n                                             </th>\r\n \r\n+                                            \r\n+\r\n+                                            <!-- ORTAK TOPLAM -->\r\n+\r\n+                                            <th class=\"text-center bg-info-light\">\r\n+\r\n+                                                <span class=\"badge badge-info\"><?= number_format($toplam_ortak) ?></span>\r\n+\r\n+                                            </th>\r\n+\r\n+                                            \r\n+\r\n+                                            <!-- GENEL TOPLAM -->\r\n+\r\n+                                            <th class=\"text-center bg-dark-light\">\r\n+\r\n+                                                <span class=\"badge badge-dark\"><?= number_format($toplam_adet) ?></span>\r\n+\r\n+                                            </th>\r\n+\r\n+                                            <th class=\"text-right bg-dark-light\">\r\n+\r\n+                                                <strong class=\"text-dark\"><?= number_format($toplam_ciro, 2) ?> ‚Ç∫</strong>\r\n+\r\n+                                            </th>\r\n+\r\n                                         </tr>\r\n \r\n                                     </tfoot>\r\n \r\n@@ -1033,9 +1375,9 @@\n             });\r\n \r\n \r\n \r\n-            // DataTable ba≈ülatma - Kompakt g√∂r√ºn√ºm i√ßin optimize edildi\r\n+            // DataTable ba≈ülatma - Gruplandƒ±rƒ±lmƒ±≈ü g√∂r√ºn√ºm i√ßin optimize edildi\r\n \r\n             $('#raporTablosu').DataTable({\r\n \r\n                 \"language\": {\r\n@@ -1047,9 +1389,9 @@\n                 \"pageLength\": 50,\r\n \r\n                 \"lengthMenu\": [[25, 50, 100, -1], [25, 50, 100, \"T√ºm√º\"]],\r\n \r\n-                \"order\": [[ 5, \"desc\" ]], // Toplam ciro'ya g√∂re sƒ±rala (6. s√ºtun, index 5)\r\n+                \"order\": [[ 10, \"desc\" ]], // Toplam ciro'ya g√∂re sƒ±rala (11. s√ºtun, index 10)\r\n \r\n                 \"columnDefs\": [\r\n \r\n                     {\r\n@@ -1057,9 +1399,9 @@\n                         \"targets\": [0], // Sƒ±ra numarasƒ±\r\n \r\n                         \"className\": \"text-center\",\r\n \r\n-                        \"width\": \"40px\"\r\n+                        \"width\": \"35px\"\r\n \r\n                     },\r\n \r\n                     {\r\n@@ -1067,29 +1409,29 @@\n                         \"targets\": [1], // ≈ûehir adƒ±\r\n \r\n                         \"className\": \"text-left\",\r\n \r\n-                        \"width\": \"150px\"\r\n+                        \"width\": \"120px\"\r\n \r\n                     },\r\n \r\n                     {\r\n \r\n-                        \"targets\": [2, 3, 4], // Sayƒ±sal s√ºtunlar (adet)\r\n+                        \"targets\": [2, 5, 8, 9], // Adet s√ºtunlarƒ±\r\n \r\n                         \"className\": \"text-center\",\r\n \r\n-                        \"width\": \"90px\"\r\n+                        \"width\": \"80px\"\r\n \r\n                     },\r\n \r\n                     {\r\n \r\n-                        \"targets\": [5, 6], // Ciro ve ortalama\r\n+                        \"targets\": [3, 4, 6, 7, 10], // Ciro ve ortalama s√ºtunlarƒ±\r\n \r\n                         \"className\": \"text-right\",\r\n \r\n-                        \"width\": \"120px\"\r\n+                        \"width\": \"80px\"\r\n \r\n                     }\r\n \r\n                 ],\r\n@@ -1099,9 +1441,9 @@\n                 \"scrollX\": true,\r\n \r\n                 \"autoWidth\": false,\r\n \r\n-                \"responsive\": true,\r\n+                \"responsive\": false, // Responsive kapatƒ±ldƒ± √ß√ºnk√º gruplandƒ±rma var\r\n \r\n                 \"buttons\": [\r\n \r\n                     'copy', 'csv', 'excel', 'pdf', 'print'\r\n"
                },
                {
                    "date": 1755678676173,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -53,12 +53,26 @@\n             padding: 6px 4px !important;\r\n \r\n             vertical-align: middle;\r\n \r\n+            text-align: center !important;\r\n+\r\n         }\r\n \r\n         \r\n \r\n+        /* ≈ûehir s√ºtunu sol hizalƒ± */\r\n+\r\n+        #raporTablosu th:nth-child(2),\r\n+\r\n+        #raporTablosu td:nth-child(2) {\r\n+\r\n+            text-align: left !important;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n         /* Sƒ±ra numarasƒ± s√ºtunu dar */\r\n \r\n         #raporTablosu th:nth-child(1),\r\n \r\n@@ -75,9 +89,9 @@\n         }\r\n \r\n         \r\n \r\n-        /* ≈ûehir s√ºtunu orta geni≈ülik */\r\n+        /* ≈ûehir s√ºtunu sol hizalƒ± */\r\n \r\n         #raporTablosu th:nth-child(2),\r\n \r\n         #raporTablosu td:nth-child(2) {\r\n@@ -87,8 +101,10 @@\n             min-width: 120px !important;\r\n \r\n             max-width: 120px !important;\r\n \r\n+            text-align: left !important;\r\n+\r\n         }\r\n \r\n         \r\n \r\n@@ -145,16 +161,12 @@\n         #raporTablosu th:nth-child(9),\r\n \r\n         #raporTablosu th:nth-child(10),\r\n \r\n-        #raporTablosu th:nth-child(11),\r\n-\r\n         #raporTablosu td:nth-child(9),\r\n \r\n-        #raporTablosu td:nth-child(10),\r\n+        #raporTablosu td:nth-child(10) {\r\n \r\n-        #raporTablosu td:nth-child(11) {\r\n-\r\n             width: 80px !important;\r\n \r\n             min-width: 80px !important;\r\n \r\n@@ -401,18 +413,14 @@\n             #raporTablosu th:nth-child(5),\r\n \r\n             #raporTablosu th:nth-child(7),\r\n \r\n-            #raporTablosu th:nth-child(8),\r\n-\r\n             #raporTablosu td:nth-child(3),\r\n \r\n             #raporTablosu td:nth-child(5),\r\n \r\n-            #raporTablosu td:nth-child(7),\r\n+            #raporTablosu td:nth-child(7) {\r\n \r\n-            #raporTablosu td:nth-child(8) {\r\n-\r\n                 width: 50px !important;\r\n \r\n                 min-width: 50px !important;\r\n \r\n@@ -423,19 +431,19 @@\n             #raporTablosu th:nth-child(4),\r\n \r\n             #raporTablosu th:nth-child(6),\r\n \r\n+            #raporTablosu th:nth-child(8),\r\n+\r\n             #raporTablosu th:nth-child(9),\r\n \r\n-            #raporTablosu th:nth-child(10),\r\n-\r\n             #raporTablosu td:nth-child(4),\r\n \r\n             #raporTablosu td:nth-child(6),\r\n \r\n-            #raporTablosu td:nth-child(9),\r\n+            #raporTablosu td:nth-child(8),\r\n \r\n-            #raporTablosu td:nth-child(10) {\r\n+            #raporTablosu td:nth-child(9) {\r\n \r\n                 width: 60px !important;\r\n \r\n                 min-width: 60px !important;\r\n@@ -819,13 +827,11 @@\n                                         <span class=\"badge badge-success ml-2\">Digiturk</span> \r\n \r\n                                         <span class=\"badge badge-warning ml-2\">S Sport</span>\r\n \r\n-                                        <span class=\"badge badge-info ml-2\">Ortak</span>\r\n-\r\n                                         <span class=\"badge badge-primary ml-2\">Toplam</span>\r\n \r\n-                                        <br><small class=\"text-muted\">Digiturk (stok grup ID: 1), S Sport (stok grup ID: 279), Ortak (hem Digiturk hem S Sport alan m√º≈üteriler)</small>\r\n+                                        <br><small class=\"text-muted\">Digiturk (stok grup ID: 1), S Sport (stok grup ID: 279)</small>\r\n \r\n                                     </div>\r\n \r\n                                 </div>\r\n@@ -855,10 +861,8 @@\n                                                 <i class=\"fas fa-futbol\"></i> S SPORT\r\n \r\n                                             </th>\r\n \r\n-                                            <th rowspan=\"2\" class=\"align-middle bg-info text-white\"><i class=\"fas fa-handshake\"></i> Ortak</th>\r\n-\r\n                                             <th colspan=\"2\" class=\"text-center bg-dark text-white\">\r\n \r\n                                                 <i class=\"fas fa-chart-bar\"></i> GENEL TOPLAM\r\n \r\n@@ -949,21 +953,21 @@\n                                             </td>\r\n \r\n                                             <!-- DIGITURK GRUBU -->\r\n \r\n-                                            <td class=\"text-center bg-purple-light\">\r\n+                                            <td class=\"bg-purple-light\">\r\n \r\n                                                 <span class=\"badge badge-purple\"><?= number_format($veri->digiturk_satis_adedi) ?></span>\r\n \r\n                                             </td>\r\n \r\n-                                            <td class=\"text-right bg-purple-light\">\r\n+                                            <td class=\"bg-purple-light\">\r\n \r\n                                                 <strong class=\"text-purple\"><?= number_format($digiturk_ciro_val, 2) ?> ‚Ç∫</strong>\r\n \r\n                                             </td>\r\n \r\n-                                            <td class=\"text-right bg-purple-light\">\r\n+                                            <td class=\"bg-purple-light\">\r\n \r\n                                                 <span class=\"text-purple\"><?= number_format($digiturk_ortalama, 2) ?> ‚Ç∫</span>\r\n \r\n                                             </td>\r\n@@ -971,41 +975,31 @@\n                                             \r\n \r\n                                             <!-- S SPORT GRUBU -->\r\n \r\n-                                            <td class=\"text-center bg-blue-light\">\r\n+                                            <td class=\"bg-blue-light\">\r\n \r\n                                                 <span class=\"badge badge-blue\"><?= number_format($veri->ssport_satis_adedi) ?></span>\r\n \r\n                                             </td>\r\n \r\n-                                            <td class=\"text-right bg-blue-light\">\r\n+                                            <td class=\"bg-blue-light\">\r\n \r\n                                                 <strong class=\"text-blue\"><?= number_format($ssport_ciro_val, 2) ?> ‚Ç∫</strong>\r\n \r\n                                             </td>\r\n \r\n-                                            <td class=\"text-right bg-blue-light\">\r\n+                                            <td class=\"bg-blue-light\">\r\n \r\n                                                 <span class=\"text-blue\"><?= number_format($ssport_ortalama, 2) ?> ‚Ç∫</span>\r\n \r\n                                             </td>\r\n \r\n                                             \r\n \r\n-                                            <!-- ORTAK -->\r\n-\r\n-                                            <td class=\"text-center bg-info-light\">\r\n-\r\n-                                                <span class=\"badge badge-info\"><?= number_format(isset($veri->ortak_satis_adedi) ? $veri->ortak_satis_adedi : 0) ?></span>\r\n-\r\n-                                            </td>\r\n-\r\n-                                            \r\n-\r\n                                             <!-- GENEL TOPLAM GRUBU -->\r\n \r\n-                                            <td class=\"text-center bg-dark-light\">\r\n+                                            <td class=\"bg-dark-light\">\r\n \r\n                                                 <button type=\"button\" \r\n \r\n                                                         class=\"btn btn-link p-0 satis-detay-btn\" \r\n@@ -1025,9 +1019,9 @@\n                                                 </button>\r\n \r\n                                             </td>\r\n \r\n-                                            <td class=\"text-right bg-dark-light\">\r\n+                                            <td class=\"bg-dark-light\">\r\n \r\n                                                 <strong class=\"text-dark\"><?= number_format($veri->toplam_ciro, 2) ?> ‚Ç∫</strong>\r\n \r\n                                             </td>\r\n@@ -1041,9 +1035,9 @@\n                                         <?php if(empty($rapor_verileri)): ?>\r\n \r\n                                         <tr>\r\n \r\n-                                            <td colspan=\"11\" class=\"text-center text-muted\">\r\n+                                            <td colspan=\"10\" class=\"text-center text-muted\">\r\n \r\n                                                 <i class=\"fas fa-info-circle\"></i>\r\n \r\n                                                 Se√ßilen tarih aralƒ±ƒüƒ±nda veri bulunamadƒ±.\r\n@@ -1061,27 +1055,27 @@\n                                     <tfoot class=\"thead-light\">\r\n \r\n                                         <tr>\r\n \r\n-                                            <th colspan=\"2\" class=\"text-right\">TOPLAM:</th>\r\n+                                            <th colspan=\"2\" class=\"text-center\">TOPLAM:</th>\r\n \r\n                                             \r\n \r\n                                             <!-- DIGITURK TOPLAM -->\r\n \r\n-                                            <th class=\"text-center bg-purple-light\">\r\n+                                            <th class=\"bg-purple-light\">\r\n \r\n                                                 <span class=\"badge badge-purple\"><?= number_format($toplam_digiturk) ?></span>\r\n \r\n                                             </th>\r\n \r\n-                                            <th class=\"text-right bg-purple-light\">\r\n+                                            <th class=\"bg-purple-light\">\r\n \r\n                                                 <strong class=\"text-purple\"><?= number_format($toplam_digiturk_ciro, 2) ?> ‚Ç∫</strong>\r\n \r\n                                             </th>\r\n \r\n-                                            <th class=\"text-right bg-purple-light\">\r\n+                                            <th class=\"bg-purple-light\">\r\n \r\n                                                 <strong class=\"text-purple\"><?= $toplam_digiturk > 0 ? number_format($toplam_digiturk_ciro / $toplam_digiturk, 2) : '0.00' ?> ‚Ç∫</strong>\r\n \r\n                                             </th>\r\n@@ -1089,47 +1083,37 @@\n                                             \r\n \r\n                                             <!-- S SPORT TOPLAM -->\r\n \r\n-                                            <th class=\"text-center bg-blue-light\">\r\n+                                            <th class=\"bg-blue-light\">\r\n \r\n                                                 <span class=\"badge badge-blue\"><?= number_format($toplam_ssport) ?></span>\r\n \r\n                                             </th>\r\n \r\n-                                            <th class=\"text-right bg-blue-light\">\r\n+                                            <th class=\"bg-blue-light\">\r\n \r\n                                                 <strong class=\"text-blue\"><?= number_format($toplam_ssport_ciro, 2) ?> ‚Ç∫</strong>\r\n \r\n                                             </th>\r\n \r\n-                                            <th class=\"text-right bg-blue-light\">\r\n+                                            <th class=\"bg-blue-light\">\r\n \r\n                                                 <strong class=\"text-blue\"><?= $toplam_ssport > 0 ? number_format($toplam_ssport_ciro / $toplam_ssport, 2) : '0.00' ?> ‚Ç∫</strong>\r\n \r\n                                             </th>\r\n \r\n                                             \r\n \r\n-                                            <!-- ORTAK TOPLAM -->\r\n-\r\n-                                            <th class=\"text-center bg-info-light\">\r\n-\r\n-                                                <span class=\"badge badge-info\"><?= number_format($toplam_ortak) ?></span>\r\n-\r\n-                                            </th>\r\n-\r\n-                                            \r\n-\r\n                                             <!-- GENEL TOPLAM -->\r\n \r\n-                                            <th class=\"text-center bg-dark-light\">\r\n+                                            <th class=\"bg-dark-light\">\r\n \r\n                                                 <span class=\"badge badge-dark\"><?= number_format($toplam_adet) ?></span>\r\n \r\n                                             </th>\r\n \r\n-                                            <th class=\"text-right bg-dark-light\">\r\n+                                            <th class=\"bg-dark-light\">\r\n \r\n                                                 <strong class=\"text-dark\"><?= number_format($toplam_ciro, 2) ?> ‚Ç∫</strong>\r\n \r\n                                             </th>\r\n@@ -1389,9 +1373,9 @@\n                 \"pageLength\": 50,\r\n \r\n                 \"lengthMenu\": [[25, 50, 100, -1], [25, 50, 100, \"T√ºm√º\"]],\r\n \r\n-                \"order\": [[ 10, \"desc\" ]], // Toplam ciro'ya g√∂re sƒ±rala (11. s√ºtun, index 10)\r\n+                \"order\": [[ 9, \"desc\" ]], // Toplam ciro'ya g√∂re sƒ±rala (10. s√ºtun, index 9)\r\n \r\n                 \"columnDefs\": [\r\n \r\n                     {\r\n@@ -1405,9 +1389,9 @@\n                     },\r\n \r\n                     {\r\n \r\n-                        \"targets\": [1], // ≈ûehir adƒ±\r\n+                        \"targets\": [1], // ≈ûehir adƒ± - sol hizalƒ±\r\n \r\n                         \"className\": \"text-left\",\r\n \r\n                         \"width\": \"120px\"\r\n@@ -1415,24 +1399,14 @@\n                     },\r\n \r\n                     {\r\n \r\n-                        \"targets\": [2, 5, 8, 9], // Adet s√ºtunlarƒ±\r\n+                        \"targets\": [2, 3, 4, 5, 6, 7, 8, 9], // T√ºm diƒüer s√ºtunlar - ortalƒ±\r\n \r\n                         \"className\": \"text-center\",\r\n \r\n                         \"width\": \"80px\"\r\n \r\n-                    },\r\n-\r\n-                    {\r\n-\r\n-                        \"targets\": [3, 4, 6, 7, 10], // Ciro ve ortalama s√ºtunlarƒ±\r\n-\r\n-                        \"className\": \"text-right\",\r\n-\r\n-                        \"width\": \"80px\"\r\n-\r\n                     }\r\n \r\n                 ],\r\n \r\n"
                },
                {
                    "date": 1755695954287,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -274,8 +274,29 @@\n \r\n             color: white !important;\r\n \r\n         }\r\n+        \r\n+        /* Modal i√ßindeki badge stilleri */\r\n+        .badge-purple {\r\n+            background-color: #6f42c1 !important;\r\n+            color: white !important;\r\n+        }\r\n+        \r\n+        .badge-primary {\r\n+            background-color: #007bff !important;\r\n+            color: white !important;\r\n+        }\r\n+        \r\n+        .badge-secondary {\r\n+            background-color: #6c757d !important;\r\n+            color: white !important;\r\n+        }\r\n+        \r\n+        .badge-info {\r\n+            background-color: #17a2b8 !important;\r\n+            color: white !important;\r\n+        }\r\n \r\n         \r\n \r\n         /* Tablo responsive container */\r\n@@ -955,10 +976,26 @@\n                                             <!-- DIGITURK GRUBU -->\r\n \r\n                                             <td class=\"bg-purple-light\">\r\n \r\n-                                                <span class=\"badge badge-purple\"><?= number_format($veri->digiturk_satis_adedi) ?></span>\r\n+                                                <button type=\"button\" \r\n \r\n+                                                        class=\"btn btn-link p-0 digiturk-detay-btn\" \r\n+\r\n+                                                        data-sehir-id=\"<?= $veri->cari_il ?>\" \r\n+\r\n+                                                        data-sehir-adi=\"<?= $veri->sehir_adi ?? 'Belirtilmemi≈ü' ?>\"\r\n+\r\n+                                                        data-baslangic=\"<?= $baslangic_tarihi ?>\"\r\n+\r\n+                                                        data-bitis=\"<?= $bitis_tarihi ?>\"\r\n+\r\n+                                                        title=\"Digiturk m√º≈üteri detaylarƒ±nƒ± g√∂r√ºnt√ºle\">\r\n+\r\n+                                                    <span class=\"badge badge-purple\"><?= number_format($veri->digiturk_satis_adedi) ?></span>\r\n+\r\n+                                                </button>\r\n+\r\n                                             </td>\r\n \r\n                                             <td class=\"bg-purple-light\">\r\n \r\n@@ -977,10 +1014,26 @@\n                                             <!-- S SPORT GRUBU -->\r\n \r\n                                             <td class=\"bg-blue-light\">\r\n \r\n-                                                <span class=\"badge badge-blue\"><?= number_format($veri->ssport_satis_adedi) ?></span>\r\n+                                                <button type=\"button\" \r\n \r\n+                                                        class=\"btn btn-link p-0 ssport-detay-btn\" \r\n+\r\n+                                                        data-sehir-id=\"<?= $veri->cari_il ?>\" \r\n+\r\n+                                                        data-sehir-adi=\"<?= $veri->sehir_adi ?? 'Belirtilmemi≈ü' ?>\"\r\n+\r\n+                                                        data-baslangic=\"<?= $baslangic_tarihi ?>\"\r\n+\r\n+                                                        data-bitis=\"<?= $bitis_tarihi ?>\"\r\n+\r\n+                                                        title=\"S Sport m√º≈üteri detaylarƒ±nƒ± g√∂r√ºnt√ºle\">\r\n+\r\n+                                                    <span class=\"badge badge-blue\"><?= number_format($veri->ssport_satis_adedi) ?></span>\r\n+\r\n+                                                </button>\r\n+\r\n                                             </td>\r\n \r\n                                             <td class=\"bg-blue-light\">\r\n \r\n@@ -1668,95 +1721,145 @@\n         </div>\r\n \r\n         <script>\r\n         $(document).ready(function() {\r\n-            // Satƒ±≈ü detay butonlarƒ±na tƒ±klama olayƒ±\r\n+            // Genel Toplam - Satƒ±≈ü detay butonlarƒ±na tƒ±klama olayƒ±\r\n             $('.satis-detay-btn').on('click', function() {\r\n                 var sehirId = $(this).data('sehir-id');\r\n                 var sehirAdi = $(this).data('sehir-adi');\r\n                 var baslangic = $(this).data('baslangic');\r\n                 var bitis = $(this).data('bitis');\r\n                 \r\n-                // Modal ba≈ülƒ±ƒüƒ±nƒ± g√ºncelle\r\n-                $('#musteriDetayModalLabel').text(sehirAdi + ' - M√º≈üteri Detaylarƒ±');\r\n+                openModal(sehirAdi + ' - T√ºm M√º≈üteri Detaylarƒ±', sehirId, baslangic, bitis, 'all');\r\n+            });\r\n+\r\n+            // Digiturk detay butonlarƒ±na tƒ±klama olayƒ±\r\n+            $('.digiturk-detay-btn').on('click', function() {\r\n+                var sehirId = $(this).data('sehir-id');\r\n+                var sehirAdi = $(this).data('sehir-adi');\r\n+                var baslangic = $(this).data('baslangic');\r\n+                var bitis = $(this).data('bitis');\r\n                 \r\n-                // Modal i√ßeriƒüini temizle ve loading g√∂ster\r\n-                $('#musteriDetayIcerik').html('<div class=\"text-center\"><i class=\"fas fa-spinner fa-spin\"></i> Y√ºkleniyor...</div>');\r\n+                openModal(sehirAdi + ' - Digiturk M√º≈üteri Detaylarƒ±', sehirId, baslangic, bitis, 'digiturk');\r\n+            });\r\n+\r\n+            // S Sport detay butonlarƒ±na tƒ±klama olayƒ±\r\n+            $('.ssport-detay-btn').on('click', function() {\r\n+                var sehirId = $(this).data('sehir-id');\r\n+                var sehirAdi = $(this).data('sehir-adi');\r\n+                var baslangic = $(this).data('baslangic');\r\n+                var bitis = $(this).data('bitis');\r\n                 \r\n-                // Modal'ƒ± a√ß\r\n-                $('#musteriDetayModal').modal('show');\r\n-                \r\n-                // AJAX ile m√º≈üteri detaylarƒ±nƒ± getir\r\n-                $.ajax({\r\n-                    url: '<?= base_url(\"raporlar/digiturk_sehir_cari_detay\") ?>',\r\n-                    type: 'POST',\r\n-                    data: {\r\n-                        sehir_id: sehirId,\r\n-                        baslangic_tarihi: baslangic,\r\n-                        bitis_tarihi: bitis\r\n-                    },\r\n-                    dataType: 'json',\r\n-                    success: function(response) {\r\n-                        console.log('AJAX Response:', response);\r\n+                openModal(sehirAdi + ' - S Sport M√º≈üteri Detaylarƒ±', sehirId, baslangic, bitis, 'ssport');\r\n+            });\r\n+        });\r\n+\r\n+        // Modal a√ßma fonksiyonu\r\n+        function openModal(title, sehirId, baslangic, bitis, type) {\r\n+            // Modal ba≈ülƒ±ƒüƒ±nƒ± g√ºncelle\r\n+            $('#musteriDetayModalLabel').text(title);\r\n+            \r\n+            // Modal i√ßeriƒüini temizle ve loading g√∂ster\r\n+            $('#musteriDetayIcerik').html('<div class=\"text-center\"><i class=\"fas fa-spinner fa-spin\"></i> Y√ºkleniyor...</div>');\r\n+            \r\n+            // Modal'ƒ± a√ß\r\n+            $('#musteriDetayModal').modal('show');\r\n+            \r\n+            // AJAX ile m√º≈üteri detaylarƒ±nƒ± getir\r\n+            $.ajax({\r\n+                url: '<?= base_url(\"raporlar/digiturk_sehir_cari_detay\") ?>',\r\n+                type: 'POST',\r\n+                data: {\r\n+                    sehir_id: sehirId,\r\n+                    baslangic_tarihi: baslangic,\r\n+                    bitis_tarihi: bitis,\r\n+                    product_type: type\r\n+                },\r\n+                dataType: 'json',\r\n+                success: function(response) {\r\n+                    console.log('AJAX Response:', response);\r\n+                    \r\n+                    if (response.error) {\r\n+                        $('#musteriDetayIcerik').html('<div class=\"alert alert-danger\">' + response.error + '</div>');\r\n+                        return;\r\n+                    }\r\n+                    \r\n+                    if (response.success && response.data && response.data.length > 0) {\r\n+                        var html = '<div class=\"table-responsive\">';\r\n+                        html += '<table class=\"table table-striped table-hover\">';\r\n+                        html += '<thead class=\"thead-dark\">';\r\n+                        html += '<tr>';\r\n+                        html += '<th>Cari Ad</th>';\r\n+                        html += '<th>ƒ∞l</th>';\r\n+                        html += '<th>ƒ∞l√ße</th>';\r\n+                        html += '<th>Telefon</th>';\r\n+                        html += '<th>Personel</th>';\r\n+                        html += '<th>√úr√ºn Tipi</th>';\r\n+                        html += '<th>Toplam Tutar</th>';\r\n+                        html += '</tr>';\r\n+                        html += '</thead>';\r\n+                        html += '<tbody>';\r\n                         \r\n-                        if (response.error) {\r\n-                            $('#musteriDetayIcerik').html('<div class=\"alert alert-danger\">' + response.error + '</div>');\r\n-                            return;\r\n-                        }\r\n+                        var toplamTutar = 0;\r\n                         \r\n-                        if (response.success && response.data && response.data.length > 0) {\r\n-                            var html = '<div class=\"table-responsive\">';\r\n-                            html += '<table class=\"table table-striped table-hover\">';\r\n-                            html += '<thead class=\"thead-dark\">';\r\n-                            html += '<tr>';\r\n-                            html += '<th>Cari Ad</th>';\r\n-                            html += '<th>ƒ∞l</th>';\r\n-                            html += '<th>ƒ∞l√ße</th>';\r\n-                            html += '<th>Telefon</th>';\r\n-                            html += '<th>Personel</th>';\r\n-                            html += '<th>Toplam Tutar</th>';\r\n-                            html += '</tr>';\r\n-                            html += '</thead>';\r\n-                            html += '<tbody>';\r\n+                        response.data.forEach(function(item) {\r\n+                            toplamTutar += parseFloat(item.toplam_tutar);\r\n                             \r\n-                            var toplamTutar = 0;\r\n-                            \r\n-                            response.data.forEach(function(item) {\r\n-                                toplamTutar += parseFloat(item.toplam_tutar);\r\n-                                \r\n-                                html += '<tr>';\r\n-                                html += '<td>' + (item.cari_ad || '-') + '</td>';\r\n-                                html += '<td>' + (item.il_adi || '-') + '</td>';\r\n-                                html += '<td>' + (item.ilce_adi || '-') + '</td>';\r\n-                                html += '<td>' + (item.cari_firmaTelefon || '-') + '</td>';\r\n-                                html += '<td>' + (item.personel_adsoyad || '-') + '</td>';\r\n-                                html += '<td class=\"text-right\">' + parseFloat(item.toplam_tutar).toLocaleString('tr-TR', {minimumFractionDigits: 2}) + ' ‚Ç∫</td>';\r\n-                                html += '</tr>';\r\n-                            });\r\n-                            \r\n-                            html += '</tbody>';\r\n-                            html += '<tfoot class=\"thead-light\">';\r\n                             html += '<tr>';\r\n-                            html += '<th colspan=\"5\" class=\"text-right\">TOPLAM:</th>';\r\n-                            html += '<th class=\"text-right\">' + toplamTutar.toLocaleString('tr-TR', {minimumFractionDigits: 2}) + ' ‚Ç∫</th>';\r\n+                            html += '<td>' + (item.cari_ad || '-') + '</td>';\r\n+                            html += '<td>' + (item.il_adi || '-') + '</td>';\r\n+                            html += '<td>' + (item.ilce_adi || '-') + '</td>';\r\n+                            html += '<td>' + (item.cari_firmaTelefon || '-') + '</td>';\r\n+                            html += '<td>' + (item.personel_adsoyad || '-') + '</td>';\r\n+                            html += '<td>';\r\n+                            // Backend'den gelen urun_tipi alanƒ±nƒ± kontrol et\r\n+                            if (item.urun_tipi) {\r\n+                                if (item.urun_tipi === 'Digiturk') {\r\n+                                    html += '<span class=\"badge badge-purple\">Digiturk</span>';\r\n+                                } else if (item.urun_tipi === 'S Sport') {\r\n+                                    html += '<span class=\"badge badge-primary\">S Sport</span>';\r\n+                                } else {\r\n+                                    html += '<span class=\"badge badge-secondary\">' + item.urun_tipi + '</span>';\r\n+                                }\r\n+                            } else if (response.product_type) {\r\n+                                // Eƒüer urun_tipi yoksa product_type parametresinden √ßƒ±kart\r\n+                                if (response.product_type === 'digiturk') {\r\n+                                    html += '<span class=\"badge badge-purple\">Digiturk</span>';\r\n+                                } else if (response.product_type === 'ssport') {\r\n+                                    html += '<span class=\"badge badge-primary\">S Sport</span>';\r\n+                                } else {\r\n+                                    html += '<span class=\"badge badge-secondary\">' + response.product_type + '</span>';\r\n+                                }\r\n+                            } else {\r\n+                                html += '<span class=\"badge badge-info\">Genel</span>';\r\n+                            }\r\n+                            html += '</td>';\r\n+                            html += '<td class=\"text-right\">' + parseFloat(item.toplam_tutar).toLocaleString('tr-TR', {minimumFractionDigits: 2}) + ' ‚Ç∫</td>';\r\n                             html += '</tr>';\r\n-                            html += '</tfoot>';\r\n-                            html += '</table>';\r\n-                            html += '</div>';\r\n-                            \r\n-                            $('#musteriDetayIcerik').html(html);\r\n-                        } else {\r\n-                            $('#musteriDetayIcerik').html('<div class=\"alert alert-info\">Bu ≈üehir i√ßin m√º≈üteri bulunamadƒ±.</div>');\r\n-                        }\r\n-                    },\r\n-                    error: function(xhr, status, error) {\r\n-                        console.log('AJAX Error:', error);\r\n-                        console.log('Response:', xhr.responseText);\r\n-                        $('#musteriDetayIcerik').html('<div class=\"alert alert-danger\">Veriler y√ºklenirken bir hata olu≈ütu: ' + error + '</div>');\r\n+                        });\r\n+                        \r\n+                        html += '</tbody>';\r\n+                        html += '<tfoot class=\"thead-light\">';\r\n+                        html += '<tr>';\r\n+                        html += '<th colspan=\"6\" class=\"text-right\">TOPLAM:</th>';\r\n+                        html += '<th class=\"text-right\">' + toplamTutar.toLocaleString('tr-TR', {minimumFractionDigits: 2}) + ' ‚Ç∫</th>';\r\n+                        html += '</tr>';\r\n+                        html += '</tfoot>';\r\n+                        html += '</table>';\r\n+                        html += '</div>';\r\n+                        \r\n+                        $('#musteriDetayIcerik').html(html);\r\n+                    } else {\r\n+                        $('#musteriDetayIcerik').html('<div class=\"alert alert-info\">Bu ≈üehir i√ßin m√º≈üteri bulunamadƒ±.</div>');\r\n                     }\r\n-                });\r\n+                },\r\n+                error: function(xhr, status, error) {\r\n+                    console.log('AJAX Error:', error);\r\n+                    console.log('Response:', xhr.responseText);\r\n+                    $('#musteriDetayIcerik').html('<div class=\"alert alert-danger\">Veriler y√ºklenirken bir hata olu≈ütu: ' + error + '</div>');\r\n+                }\r\n             });\r\n-        });\r\n+        }\r\n \r\n         // Modal i√ßindeki tabloyu Excel'e aktarma fonksiyonu\r\n         function exportModalToExcel() {\r\n             var modalTable = $('#musteriDetayIcerik table');\r\n@@ -1810,8 +1913,9 @@\n                 {wch: 15}, // ƒ∞l\r\n                 {wch: 15}, // ƒ∞l√ße\r\n                 {wch: 15}, // Telefon\r\n                 {wch: 20}, // Personel\r\n+                {wch: 12}, // √úr√ºn Tipi\r\n                 {wch: 15}  // Toplam Tutar\r\n             ];\r\n             ws['!cols'] = colWidths;\r\n             \r\n"
                },
                {
                    "date": 1755698217654,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1108,9 +1108,10 @@\n                                     <tfoot class=\"thead-light\">\r\n \r\n                                         <tr>\r\n \r\n-                                            <th colspan=\"2\" class=\"text-center\">TOPLAM:</th>\r\n+                                            <th class=\"text-center\">TOPLAM:</th>\r\n+                                            <th></th>\r\n \r\n                                             \r\n \r\n                                             <!-- DIGITURK TOPLAM -->\r\n"
                },
                {
                    "date": 1755698530522,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1117,10 +1117,26 @@\n                                             <!-- DIGITURK TOPLAM -->\r\n \r\n                                             <th class=\"bg-purple-light\">\r\n \r\n-                                                <span class=\"badge badge-purple\"><?= number_format($toplam_digiturk) ?></span>\r\n+                                                <button type=\"button\" \r\n \r\n+                                                        class=\"btn btn-link p-0 digiturk-detay-btn\" \r\n+\r\n+                                                        data-sehir-id=\"\" \r\n+\r\n+                                                        data-sehir-adi=\"T√ºm ≈ûehirler\"\r\n+\r\n+                                                        data-baslangic=\"<?= $baslangic_tarihi ?>\"\r\n+\r\n+                                                        data-bitis=\"<?= $bitis_tarihi ?>\"\r\n+\r\n+                                                        title=\"T√ºm ≈üehirler i√ßin Digiturk m√º≈üteri detaylarƒ±nƒ± g√∂r√ºnt√ºle\">\r\n+\r\n+                                                    <span class=\"badge badge-purple\"><?= number_format($toplam_digiturk) ?></span>\r\n+\r\n+                                                </button>\r\n+\r\n                                             </th>\r\n \r\n                                             <th class=\"bg-purple-light\">\r\n \r\n@@ -1139,10 +1155,26 @@\n                                             <!-- S SPORT TOPLAM -->\r\n \r\n                                             <th class=\"bg-blue-light\">\r\n \r\n-                                                <span class=\"badge badge-blue\"><?= number_format($toplam_ssport) ?></span>\r\n+                                                <button type=\"button\" \r\n \r\n+                                                        class=\"btn btn-link p-0 ssport-detay-btn\" \r\n+\r\n+                                                        data-sehir-id=\"\" \r\n+\r\n+                                                        data-sehir-adi=\"T√ºm ≈ûehirler\"\r\n+\r\n+                                                        data-baslangic=\"<?= $baslangic_tarihi ?>\"\r\n+\r\n+                                                        data-bitis=\"<?= $bitis_tarihi ?>\"\r\n+\r\n+                                                        title=\"T√ºm ≈üehirler i√ßin S Sport m√º≈üteri detaylarƒ±nƒ± g√∂r√ºnt√ºle\">\r\n+\r\n+                                                    <span class=\"badge badge-blue\"><?= number_format($toplam_ssport) ?></span>\r\n+\r\n+                                                </button>\r\n+\r\n                                             </th>\r\n \r\n                                             <th class=\"bg-blue-light\">\r\n \r\n@@ -1161,10 +1193,26 @@\n                                             <!-- GENEL TOPLAM -->\r\n \r\n                                             <th class=\"bg-dark-light\">\r\n \r\n-                                                <span class=\"badge badge-dark\"><?= number_format($toplam_adet) ?></span>\r\n+                                                <button type=\"button\" \r\n \r\n+                                                        class=\"btn btn-link p-0 satis-detay-btn\" \r\n+\r\n+                                                        data-sehir-id=\"\" \r\n+\r\n+                                                        data-sehir-adi=\"T√ºm ≈ûehirler\"\r\n+\r\n+                                                        data-baslangic=\"<?= $baslangic_tarihi ?>\"\r\n+\r\n+                                                        data-bitis=\"<?= $bitis_tarihi ?>\"\r\n+\r\n+                                                        title=\"T√ºm ≈üehirler i√ßin m√º≈üteri detaylarƒ±nƒ± g√∂r√ºnt√ºle\">\r\n+\r\n+                                                    <span class=\"badge badge-dark\"><?= number_format($toplam_adet) ?></span>\r\n+\r\n+                                                </button>\r\n+\r\n                                             </th>\r\n \r\n                                             <th class=\"bg-dark-light\">\r\n \r\n"
                },
                {
                    "date": 1755698692696,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1739,19 +1739,68 @@\n             font-size: 13px;\r\n \r\n         }\r\n \r\n+        \r\n+        /* Modal d√ºzenlemeleri */\r\n+        .modal-header {\r\n+            display: flex;\r\n+            justify-content: space-between;\r\n+            align-items: center;\r\n+        }\r\n+\r\n+        .modal-header-buttons {\r\n+            display: flex;\r\n+            align-items: center;\r\n+        }\r\n+\r\n+        .badge-sm {\r\n+            font-size: 0.75em;\r\n+            padding: 0.25em 0.5em;\r\n+        }\r\n+\r\n+        /* Modal tablo stil d√ºzenlemeleri */\r\n+        .table-container {\r\n+            overflow-x: hidden;\r\n+            max-width: 100%;\r\n+        }\r\n+\r\n+        .table-container .table {\r\n+            margin-bottom: 0;\r\n+            table-layout: fixed;\r\n+            width: 100%;\r\n+        }\r\n+\r\n+        .table-container .table th,\r\n+        .table-container .table td {\r\n+            padding: 8px 6px;\r\n+            vertical-align: middle;\r\n+            border-top: 1px solid #dee2e6;\r\n+            overflow: hidden;\r\n+            text-overflow: ellipsis;\r\n+        }\r\n+\r\n+        .table-container .table th {\r\n+            font-size: 11px;\r\n+            font-weight: 600;\r\n+        }\r\n+\r\n         </style>\r\n \r\n         <!-- M√º≈üteri Detay Modal -->\r\n         <div class=\"modal fade\" id=\"musteriDetayModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"musteriDetayModalLabel\" aria-hidden=\"true\">\r\n-            <div class=\"modal-dialog modal-lg\" role=\"document\">\r\n+            <div class=\"modal-dialog modal-xl\" role=\"document\">\r\n                 <div class=\"modal-content\">\r\n                     <div class=\"modal-header\">\r\n                         <h5 class=\"modal-title\" id=\"musteriDetayModalLabel\">M√º≈üteri Detaylarƒ±</h5>\r\n-                        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\r\n-                            <span aria-hidden=\"true\">&times;</span>\r\n-                        </button>\r\n+                        <div class=\"modal-header-buttons\">\r\n+                            <button type=\"button\" class=\"btn btn-success btn-sm mr-2\" id=\"excelIndir\" onclick=\"exportModalToExcel()\">\r\n+                                <i class=\"fas fa-file-excel\"></i> Excel'e ƒ∞ndir\r\n+                            </button>\r\n+                            <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\r\n+                                <span aria-hidden=\"true\">&times;</span>\r\n+                            </button>\r\n+                        </div>\r\n                     </div>\r\n                     <div class=\"modal-body\">\r\n                         <div id=\"musteriDetayIcerik\">\r\n                             <div class=\"text-center\">\r\n@@ -1759,11 +1808,8 @@\n                             </div>\r\n                         </div>\r\n                     </div>\r\n                     <div class=\"modal-footer\">\r\n-                        <button type=\"button\" class=\"btn btn-success\" id=\"excelIndir\" onclick=\"exportModalToExcel()\">\r\n-                            <i class=\"fas fa-file-excel\"></i> Excel'e ƒ∞ndir\r\n-                        </button>\r\n                         <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">Kapat</button>\r\n                     </div>\r\n                 </div>\r\n             </div>\r\n@@ -1832,19 +1878,19 @@\n                         return;\r\n                     }\r\n                     \r\n                     if (response.success && response.data && response.data.length > 0) {\r\n-                        var html = '<div class=\"table-responsive\">';\r\n-                        html += '<table class=\"table table-striped table-hover\">';\r\n+                        var html = '<div class=\"table-container\">';\r\n+                        html += '<table class=\"table table-striped table-hover table-sm\" style=\"font-size: 12px;\">';\r\n                         html += '<thead class=\"thead-dark\">';\r\n                         html += '<tr>';\r\n-                        html += '<th>Cari Ad</th>';\r\n-                        html += '<th>ƒ∞l</th>';\r\n-                        html += '<th>ƒ∞l√ße</th>';\r\n-                        html += '<th>Telefon</th>';\r\n-                        html += '<th>Personel</th>';\r\n-                        html += '<th>√úr√ºn Tipi</th>';\r\n-                        html += '<th>Toplam Tutar</th>';\r\n+                        html += '<th style=\"width: 25%;\">Cari Ad</th>';\r\n+                        html += '<th style=\"width: 10%;\">ƒ∞l</th>';\r\n+                        html += '<th style=\"width: 12%;\">ƒ∞l√ße</th>';\r\n+                        html += '<th style=\"width: 12%;\">Telefon</th>';\r\n+                        html += '<th style=\"width: 15%;\">Personel</th>';\r\n+                        html += '<th style=\"width: 10%;\">√úr√ºn Tipi</th>';\r\n+                        html += '<th style=\"width: 16%; text-align: right;\">Toplam Tutar</th>';\r\n                         html += '</tr>';\r\n                         html += '</thead>';\r\n                         html += '<tbody>';\r\n                         \r\n@@ -1853,45 +1899,45 @@\n                         response.data.forEach(function(item) {\r\n                             toplamTutar += parseFloat(item.toplam_tutar);\r\n                             \r\n                             html += '<tr>';\r\n-                            html += '<td>' + (item.cari_ad || '-') + '</td>';\r\n+                            html += '<td style=\"word-wrap: break-word; max-width: 150px;\">' + (item.cari_ad || '-') + '</td>';\r\n                             html += '<td>' + (item.il_adi || '-') + '</td>';\r\n                             html += '<td>' + (item.ilce_adi || '-') + '</td>';\r\n                             html += '<td>' + (item.cari_firmaTelefon || '-') + '</td>';\r\n-                            html += '<td>' + (item.personel_adsoyad || '-') + '</td>';\r\n-                            html += '<td>';\r\n+                            html += '<td style=\"font-size: 11px;\">' + (item.personel_adsoyad || '-') + '</td>';\r\n+                            html += '<td style=\"text-align: center;\">';\r\n                             // Backend'den gelen urun_tipi alanƒ±nƒ± kontrol et\r\n                             if (item.urun_tipi) {\r\n                                 if (item.urun_tipi === 'Digiturk') {\r\n-                                    html += '<span class=\"badge badge-purple\">Digiturk</span>';\r\n+                                    html += '<span class=\"badge badge-purple badge-sm\">Digiturk</span>';\r\n                                 } else if (item.urun_tipi === 'S Sport') {\r\n-                                    html += '<span class=\"badge badge-primary\">S Sport</span>';\r\n+                                    html += '<span class=\"badge badge-primary badge-sm\">S Sport</span>';\r\n                                 } else {\r\n-                                    html += '<span class=\"badge badge-secondary\">' + item.urun_tipi + '</span>';\r\n+                                    html += '<span class=\"badge badge-secondary badge-sm\">' + item.urun_tipi + '</span>';\r\n                                 }\r\n                             } else if (response.product_type) {\r\n                                 // Eƒüer urun_tipi yoksa product_type parametresinden √ßƒ±kart\r\n                                 if (response.product_type === 'digiturk') {\r\n-                                    html += '<span class=\"badge badge-purple\">Digiturk</span>';\r\n+                                    html += '<span class=\"badge badge-purple badge-sm\">Digiturk</span>';\r\n                                 } else if (response.product_type === 'ssport') {\r\n-                                    html += '<span class=\"badge badge-primary\">S Sport</span>';\r\n+                                    html += '<span class=\"badge badge-primary badge-sm\">S Sport</span>';\r\n                                 } else {\r\n-                                    html += '<span class=\"badge badge-secondary\">' + response.product_type + '</span>';\r\n+                                    html += '<span class=\"badge badge-secondary badge-sm\">' + response.product_type + '</span>';\r\n                                 }\r\n                             } else {\r\n-                                html += '<span class=\"badge badge-info\">Genel</span>';\r\n+                                html += '<span class=\"badge badge-info badge-sm\">Genel</span>';\r\n                             }\r\n                             html += '</td>';\r\n-                            html += '<td class=\"text-right\">' + parseFloat(item.toplam_tutar).toLocaleString('tr-TR', {minimumFractionDigits: 2}) + ' ‚Ç∫</td>';\r\n+                            html += '<td class=\"text-right\"><strong>' + parseFloat(item.toplam_tutar).toLocaleString('tr-TR', {minimumFractionDigits: 2}) + ' ‚Ç∫</strong></td>';\r\n                             html += '</tr>';\r\n                         });\r\n                         \r\n                         html += '</tbody>';\r\n                         html += '<tfoot class=\"thead-light\">';\r\n                         html += '<tr>';\r\n-                        html += '<th colspan=\"6\" class=\"text-right\">TOPLAM:</th>';\r\n-                        html += '<th class=\"text-right\">' + toplamTutar.toLocaleString('tr-TR', {minimumFractionDigits: 2}) + ' ‚Ç∫</th>';\r\n+                        html += '<th colspan=\"6\" class=\"text-right\"><strong>TOPLAM:</strong></th>';\r\n+                        html += '<th class=\"text-right\"><strong class=\"text-primary\">' + toplamTutar.toLocaleString('tr-TR', {minimumFractionDigits: 2}) + ' ‚Ç∫</strong></th>';\r\n                         html += '</tr>';\r\n                         html += '</tfoot>';\r\n                         html += '</table>';\r\n                         html += '</div>';\r\n"
                },
                {
                    "date": 1755698699349,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -836,30 +836,8 @@\n                         <div class=\"card-body\">\r\n \r\n                             <!-- Legend -->\r\n \r\n-                            <div class=\"row mb-3\">\r\n-\r\n-                                <div class=\"col-12\">\r\n-\r\n-                                    <div class=\"alert alert-info\">\r\n-\r\n-                                        <strong>A√ßƒ±klama:</strong> \r\n-\r\n-                                        <span class=\"badge badge-success ml-2\">Digiturk</span> \r\n-\r\n-                                        <span class=\"badge badge-warning ml-2\">S Sport</span>\r\n-\r\n-                                        <span class=\"badge badge-primary ml-2\">Toplam</span>\r\n-\r\n-                                        <br><small class=\"text-muted\">Digiturk (stok grup ID: 1), S Sport (stok grup ID: 279)</small>\r\n-\r\n-                                    </div>\r\n-\r\n-                                </div>\r\n-\r\n-                            </div>\r\n-\r\n                             <div class=\"table-responsive\">\r\n \r\n                                 <table class=\"table table-striped table-hover table-sm\" id=\"raporTablosu\">\r\n \r\n"
                },
                {
                    "date": 1755698860064,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1898,13 +1898,15 @@\n                                 if (response.product_type === 'digiturk') {\r\n                                     html += '<span class=\"badge badge-purple badge-sm\">Digiturk</span>';\r\n                                 } else if (response.product_type === 'ssport') {\r\n                                     html += '<span class=\"badge badge-primary badge-sm\">S Sport</span>';\r\n+                                } else if (response.product_type === 'all') {\r\n+                                    html += '<span class=\"badge badge-success badge-sm\">DG + SS</span>';\r\n                                 } else {\r\n                                     html += '<span class=\"badge badge-secondary badge-sm\">' + response.product_type + '</span>';\r\n                                 }\r\n                             } else {\r\n-                                html += '<span class=\"badge badge-info badge-sm\">Genel</span>';\r\n+                                html += '<span class=\"badge badge-success badge-sm\">DG + SS</span>';\r\n                             }\r\n                             html += '</td>';\r\n                             html += '<td class=\"text-right\"><strong>' + parseFloat(item.toplam_tutar).toLocaleString('tr-TR', {minimumFractionDigits: 2}) + ' ‚Ç∫</strong></td>';\r\n                             html += '</tr>';\r\n"
                },
                {
                    "date": 1755699137964,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1527,43 +1527,44 @@\n         // Excel'e aktarma fonksiyonu\r\n \r\n         function exportToExcel() {\r\n \r\n+            // DataTable kontrol√º\r\n+            if (typeof $.fn.DataTable === 'undefined' || !$.fn.DataTable.isDataTable('#raporTablosu')) {\r\n+                console.log('DataTable y√ºklenmemi≈ü, manuel export yapƒ±lƒ±yor');\r\n+                manualExportToExcel();\r\n+                return;\r\n+            }\r\n+            \r\n             var table = $('#raporTablosu').DataTable();\r\n \r\n             var data = [];\r\n \r\n             \r\n \r\n-            // Ba≈ülƒ±k satƒ±rƒ±\r\n+            // Ba≈ülƒ±k satƒ±rƒ± - gruplandƒ±rƒ±lmƒ±≈ü header i√ßin\r\n \r\n-            var headers = [];\r\n+            data.push(['#', '≈ûehir', 'DG Adet', 'DG Ciro', 'DG Ortalama', 'SS Adet', 'SS Ciro', 'SS Ortalama', 'Toplam Adet', 'Toplam Ciro']);\r\n \r\n-            $('#raporTablosu thead th').each(function() {\r\n-\r\n-                headers.push($(this).text());\r\n-\r\n-            });\r\n-\r\n-            data.push(headers);\r\n-\r\n             \r\n \r\n             // Veri satƒ±rlarƒ±\r\n \r\n             table.rows().every(function() {\r\n \r\n                 var rowData = [];\r\n \r\n-                var row = this.data();\r\n-\r\n                 $(this.node()).find('td').each(function() {\r\n \r\n-                    rowData.push($(this).text().replace('‚Ç∫', '').trim());\r\n+                    var cellText = $(this).text().replace('‚Ç∫', '').replace(/,/g, '').trim();\r\n \r\n+                    rowData.push(cellText);\r\n+\r\n                 });\r\n \r\n-                data.push(rowData);\r\n+                if (rowData.length > 0) {\r\n+                    data.push(rowData);\r\n+                }\r\n \r\n             });\r\n \r\n             \r\n@@ -1572,15 +1573,69 @@\n \r\n             var wb = XLSX.utils.book_new();\r\n \r\n             var ws = XLSX.utils.aoa_to_sheet(data);\r\n+            \r\n+            // S√ºtun geni≈üliklerini ayarla\r\n+            var colWidths = [\r\n+                {wch: 5}, {wch: 20}, {wch: 10}, {wch: 15}, {wch: 12},\r\n+                {wch: 10}, {wch: 15}, {wch: 12}, {wch: 12}, {wch: 15}\r\n+            ];\r\n+            ws['!cols'] = colWidths;\r\n \r\n-            XLSX.utils.book_append_sheet(wb, ws, \"Digiturk ≈ûehir Raporu\");\r\n+            XLSX.utils.book_append_sheet(wb, ws, \"DG SS Sehir Raporu\"); // 31 karakter altƒ±nda\r\n \r\n-            XLSX.writeFile(wb, \"digiturk_sehir_ciro_adet_raporu_\" + new Date().toISOString().slice(0,10) + \".xlsx\");\r\n+            XLSX.writeFile(wb, \"digiturk_ssport_sehir_raporu_\" + new Date().toISOString().slice(0,10) + \".xlsx\");\r\n \r\n         }\r\n+        \r\n+        // Manuel export fonksiyonu (DataTable yoksa)\r\n+        function manualExportToExcel() {\r\n+            var data = [];\r\n+            \r\n+            // Ba≈ülƒ±k satƒ±rƒ±\r\n+            data.push(['#', '≈ûehir', 'DG Adet', 'DG Ciro', 'DG Ortalama', 'SS Adet', 'SS Ciro', 'SS Ortalama', 'Toplam Adet', 'Toplam Ciro']);\r\n+            \r\n+            // Veri satƒ±rlarƒ±\r\n+            $('#raporTablosu tbody tr').each(function() {\r\n+                var rowData = [];\r\n+                $(this).find('td').each(function() {\r\n+                    var cellText = $(this).text().replace('‚Ç∫', '').replace(/,/g, '').trim();\r\n+                    rowData.push(cellText);\r\n+                });\r\n+                if (rowData.length > 0) {\r\n+                    data.push(rowData);\r\n+                }\r\n+            });\r\n+            \r\n+            // Toplam satƒ±rƒ±\r\n+            $('#raporTablosu tfoot tr').each(function() {\r\n+                var footerData = [];\r\n+                $(this).find('th').each(function() {\r\n+                    var cellText = $(this).text().replace('‚Ç∫', '').replace(/,/g, '').trim();\r\n+                    footerData.push(cellText);\r\n+                });\r\n+                if (footerData.length > 0) {\r\n+                    data.push(footerData);\r\n+                }\r\n+            });\r\n+            \r\n+            // Excel dosyasƒ± olu≈ütur\r\n+            var wb = XLSX.utils.book_new();\r\n+            var ws = XLSX.utils.aoa_to_sheet(data);\r\n+            \r\n+            // S√ºtun geni≈üliklerini ayarla\r\n+            var colWidths = [\r\n+                {wch: 5}, {wch: 20}, {wch: 10}, {wch: 15}, {wch: 12},\r\n+                {wch: 10}, {wch: 15}, {wch: 12}, {wch: 12}, {wch: 15}\r\n+            ];\r\n+            ws['!cols'] = colWidths;\r\n+            \r\n+            XLSX.utils.book_append_sheet(wb, ws, \"DG SS Sehir Raporu\");\r\n+            XLSX.writeFile(wb, \"digiturk_ssport_sehir_raporu_\" + new Date().toISOString().slice(0,10) + \".xlsx\");\r\n \r\n+        }\r\n+\r\n         </script>\r\n \r\n \r\n \r\n@@ -1993,9 +2048,11 @@\n                 {wch: 15}  // Toplam Tutar\r\n             ];\r\n             ws['!cols'] = colWidths;\r\n             \r\n-            XLSX.utils.book_append_sheet(wb, ws, sehirAdi + \" Detayƒ±\");\r\n+            // ≈ûehir adƒ±nƒ± kƒ±saltarak sheet adƒ± olu≈ütur (31 karakter sƒ±nƒ±rƒ±)\r\n+            var sheetName = (sehirAdi + \" Detay\").substring(0, 31);\r\n+            XLSX.utils.book_append_sheet(wb, ws, sheetName);\r\n             \r\n             // Dosya adƒ±nƒ± olu≈ütur\r\n             var fileName = sehirAdi.replace(/[^a-zA-Z0-9]/g, '_') + \"_musteri_detaylari_\" + new Date().toISOString().slice(0,10) + \".xlsx\";\r\n             \r\n"
                },
                {
                    "date": 1755699574750,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1231,10 +1231,12 @@\n                         </div>\r\n \r\n                         <div class=\"card-body\">\r\n \r\n-                            <div class=\"row\">\r\n+                            <!-- ƒ∞lk Satƒ±r - Genel Bilgiler -->\r\n \r\n+                            <div class=\"row mb-3\">\r\n+\r\n                                 <div class=\"col-md-3\">\r\n \r\n                                     <div class=\"info-box bg-primary\">\r\n \r\n@@ -1259,9 +1261,9 @@\n                                         <span class=\"info-box-icon\"><i class=\"fas fa-trophy\"></i></span>\r\n \r\n                                         <div class=\"info-box-content\">\r\n \r\n-                                            <span class=\"info-box-text\">En Y√ºksek Ciro</span>\r\n+                                            <span class=\"info-box-text\">En Y√ºksek Toplam Ciro</span>\r\n \r\n                                             <span class=\"info-box-number\">\r\n \r\n                                                 <?php \r\n@@ -1287,20 +1289,66 @@\n                                 </div>\r\n \r\n                                 <div class=\"col-md-3\">\r\n \r\n-                                    <div class=\"info-box bg-warning\">\r\n+                                    <div class=\"info-box bg-dark\">\r\n \r\n-                                        <span class=\"info-box-icon\"><i class=\"fas fa-chart-line\"></i></span>\r\n+                                        <span class=\"info-box-icon\"><i class=\"fas fa-calculator\"></i></span>\r\n \r\n                                         <div class=\"info-box-content\">\r\n \r\n-                                            <span class=\"info-box-text\">Ortalama Ciro</span>\r\n+                                            <span class=\"info-box-text\">Toplam Adet</span>\r\n \r\n-                                            <span class=\"info-box-number\">\r\n+                                            <span class=\"info-box-number\"><?= number_format($toplam_adet) ?></span>\r\n \r\n-                                                <?= count($rapor_verileri) > 0 ? number_format($toplam_ciro / count($rapor_verileri), 0) . ' ‚Ç∫' : '0 ‚Ç∫' ?>\r\n+                                        </div>\r\n \r\n+                                    </div>\r\n+\r\n+                                </div>\r\n+\r\n+                                <div class=\"col-md-3\">\r\n+\r\n+                                    <div class=\"info-box bg-secondary\">\r\n+\r\n+                                        <span class=\"info-box-icon\"><i class=\"fas fa-coins\"></i></span>\r\n+\r\n+                                        <div class=\"info-box-content\">\r\n+\r\n+                                            <span class=\"info-box-text\">Toplam Ciro</span>\r\n+\r\n+                                            <span class=\"info-box-number\"><?= number_format($toplam_ciro, 0) ?> ‚Ç∫</span>\r\n+\r\n+                                        </div>\r\n+\r\n+                                    </div>\r\n+\r\n+                                </div>\r\n+\r\n+                            </div>\r\n+\r\n+                            \r\n+\r\n+                            <!-- ƒ∞kinci Satƒ±r - Digiturk ve S Sport Kar≈üƒ±la≈ütƒ±rmasƒ± -->\r\n+\r\n+                            <div class=\"row\">\r\n+\r\n+                                <div class=\"col-md-3\">\r\n+\r\n+                                    <div class=\"info-box\" style=\"background-color: #6f42c1; color: white;\">\r\n+\r\n+                                        <span class=\"info-box-icon\"><i class=\"fas fa-tv\"></i></span>\r\n+\r\n+                                        <div class=\"info-box-content\">\r\n+\r\n+                                            <span class=\"info-box-text\">Digiturk Adet</span>\r\n+\r\n+                                            <span class=\"info-box-number\"><?= number_format($toplam_digiturk) ?></span>\r\n+\r\n+                                            <span class=\"info-box-more\">\r\n+\r\n+                                                <?= $toplam_adet > 0 ? number_format(($toplam_digiturk / $toplam_adet) * 100, 1) . '% oranƒ±' : '0% oranƒ±' ?>\r\n+\r\n                                             </span>\r\n \r\n                                         </div>\r\n \r\n@@ -1309,34 +1357,70 @@\n                                 </div>\r\n \r\n                                 <div class=\"col-md-3\">\r\n \r\n+                                    <div class=\"info-box\" style=\"background-color: #6f42c1; color: white;\">\r\n+\r\n+                                        <span class=\"info-box-icon\"><i class=\"fas fa-lira-sign\"></i></span>\r\n+\r\n+                                        <div class=\"info-box-content\">\r\n+\r\n+                                            <span class=\"info-box-text\">Digiturk Ciro</span>\r\n+\r\n+                                            <span class=\"info-box-number\"><?= number_format($toplam_digiturk_ciro, 0) ?> ‚Ç∫</span>\r\n+\r\n+                                            <span class=\"info-box-more\">\r\n+\r\n+                                                Ort: <?= $toplam_digiturk > 0 ? number_format($toplam_digiturk_ciro / $toplam_digiturk, 0) . ' ‚Ç∫' : '0 ‚Ç∫' ?>\r\n+\r\n+                                            </span>\r\n+\r\n+                                        </div>\r\n+\r\n+                                    </div>\r\n+\r\n+                                </div>\r\n+\r\n+                                <div class=\"col-md-3\">\r\n+\r\n                                     <div class=\"info-box bg-info\">\r\n \r\n-                                        <span class=\"info-box-icon\"><i class=\"fas fa-percentage\"></i></span>\r\n+                                        <span class=\"info-box-icon\"><i class=\"fas fa-futbol\"></i></span>\r\n \r\n                                         <div class=\"info-box-content\">\r\n \r\n-                                            <span class=\"info-box-text\">En Y√ºksek Pay</span>\r\n+                                            <span class=\"info-box-text\">S Sport Adet</span>\r\n \r\n-                                            <span class=\"info-box-number\">\r\n+                                            <span class=\"info-box-number\"><?= number_format($toplam_ssport) ?></span>\r\n \r\n-                                                <?php \r\n+                                            <span class=\"info-box-more\">\r\n \r\n-                                                if($en_yuksek && $toplam_ciro > 0) {\r\n+                                                <?= $toplam_adet > 0 ? number_format(($toplam_ssport / $toplam_adet) * 100, 1) . '% oranƒ±' : '0% oranƒ±' ?>\r\n \r\n-                                                    $pay = ($en_yuksek->toplam_ciro / $toplam_ciro) * 100;\r\n+                                            </span>\r\n \r\n-                                                    echo number_format($pay, 1) . '%';\r\n+                                        </div>\r\n \r\n-                                                } else {\r\n+                                    </div>\r\n \r\n-                                                    echo '0%';\r\n+                                </div>\r\n \r\n-                                                }\r\n+                                <div class=\"col-md-3\">\r\n \r\n-                                                ?>\r\n+                                    <div class=\"info-box bg-info\">\r\n \r\n+                                        <span class=\"info-box-icon\"><i class=\"fas fa-lira-sign\"></i></span>\r\n+\r\n+                                        <div class=\"info-box-content\">\r\n+\r\n+                                            <span class=\"info-box-text\">S Sport Ciro</span>\r\n+\r\n+                                            <span class=\"info-box-number\"><?= number_format($toplam_ssport_ciro, 0) ?> ‚Ç∫</span>\r\n+\r\n+                                            <span class=\"info-box-more\">\r\n+\r\n+                                                Ort: <?= $toplam_ssport > 0 ? number_format($toplam_ssport_ciro / $toplam_ssport, 0) . ' ‚Ç∫' : '0 ‚Ç∫' ?>\r\n+\r\n                                             </span>\r\n \r\n                                         </div>\r\n \r\n"
                },
                {
                    "date": 1755699924996,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1289,9 +1289,9 @@\n                                 </div>\r\n \r\n                                 <div class=\"col-md-3\">\r\n \r\n-                                    <div class=\"info-box bg-dark\">\r\n+                                    <div class=\"info-box\" style=\"background-color: #495057; color: white;\">\r\n \r\n                                         <span class=\"info-box-icon\"><i class=\"fas fa-calculator\"></i></span>\r\n \r\n                                         <div class=\"info-box-content\">\r\n@@ -1307,9 +1307,9 @@\n                                 </div>\r\n \r\n                                 <div class=\"col-md-3\">\r\n \r\n-                                    <div class=\"info-box bg-secondary\">\r\n+                                    <div class=\"info-box\" style=\"background-color: #6c757d; color: white;\">\r\n \r\n                                         <span class=\"info-box-icon\"><i class=\"fas fa-coins\"></i></span>\r\n \r\n                                         <div class=\"info-box-content\">\r\n"
                },
                {
                    "date": 1756390660422,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2000,13 +2000,13 @@\n                         html += '<table class=\"table table-striped table-hover table-sm\" style=\"font-size: 12px;\">';\r\n                         html += '<thead class=\"thead-dark\">';\r\n                         html += '<tr>';\r\n                         html += '<th style=\"width: 25%;\">Cari Ad</th>';\r\n-                        html += '<th style=\"width: 10%;\">ƒ∞l</th>';\r\n+                        html += '<th style=\"width: 12%;\">Telefon</th>';\r\n+                        html += '<th style=\"width: 10%;\">≈ûehir</th>';\r\n                         html += '<th style=\"width: 12%;\">ƒ∞l√ße</th>';\r\n-                        html += '<th style=\"width: 12%;\">Telefon</th>';\r\n+                        html += '<th style=\"width: 15%;\">√úr√ºn Tipi</th>';\r\n                         html += '<th style=\"width: 15%;\">Personel</th>';\r\n-                        html += '<th style=\"width: 10%;\">√úr√ºn Tipi</th>';\r\n                         html += '<th style=\"width: 16%; text-align: right;\">Toplam Tutar</th>';\r\n                         html += '</tr>';\r\n                         html += '</thead>';\r\n                         html += '<tbody>';\r\n@@ -2017,24 +2017,30 @@\n                             toplamTutar += parseFloat(item.toplam_tutar);\r\n                             \r\n                             html += '<tr>';\r\n                             html += '<td style=\"word-wrap: break-word; max-width: 150px;\">' + (item.cari_ad || '-') + '</td>';\r\n+                            html += '<td>' + (item.cari_firmaTelefon || '-') + '</td>';\r\n                             html += '<td>' + (item.il_adi || '-') + '</td>';\r\n                             html += '<td>' + (item.ilce_adi || '-') + '</td>';\r\n-                            html += '<td>' + (item.cari_firmaTelefon || '-') + '</td>';\r\n-                            html += '<td style=\"font-size: 11px;\">' + (item.personel_adsoyad || '-') + '</td>';\r\n                             html += '<td style=\"text-align: center;\">';\r\n-                            // Backend'den gelen urun_tipi alanƒ±nƒ± kontrol et\r\n+                            // √úr√ºn tipi g√∂sterimi - stok_ad kullanƒ±lƒ±yor artƒ±k\r\n                             if (item.urun_tipi) {\r\n-                                if (item.urun_tipi === 'Digiturk') {\r\n-                                    html += '<span class=\"badge badge-purple badge-sm\">Digiturk</span>';\r\n-                                } else if (item.urun_tipi === 'S Sport') {\r\n-                                    html += '<span class=\"badge badge-primary badge-sm\">S Sport</span>';\r\n-                                } else {\r\n+                                // Digiturk √ºr√ºnleri i√ßin mor badge\r\n+                                if (item.urun_tipi.toLowerCase().includes('digiturk') || \r\n+                                    item.urun_tipi.toLowerCase().includes('digi')) {\r\n+                                    html += '<span class=\"badge badge-purple badge-sm\">' + item.urun_tipi + '</span>';\r\n+                                }\r\n+                                // S Sport √ºr√ºnleri i√ßin mavi badge\r\n+                                else if (item.urun_tipi.toLowerCase().includes('sport') || \r\n+                                         item.urun_tipi.toLowerCase().includes('ss')) {\r\n+                                    html += '<span class=\"badge badge-primary badge-sm\">' + item.urun_tipi + '</span>';\r\n+                                }\r\n+                                // Diƒüer √ºr√ºnler i√ßin gri badge\r\n+                                else {\r\n                                     html += '<span class=\"badge badge-secondary badge-sm\">' + item.urun_tipi + '</span>';\r\n                                 }\r\n                             } else if (response.product_type) {\r\n-                                // Eƒüer urun_tipi yoksa product_type parametresinden √ßƒ±kart\r\n+                                // Fallback - product_type parametresinden √ßƒ±kart\r\n                                 if (response.product_type === 'digiturk') {\r\n                                     html += '<span class=\"badge badge-purple badge-sm\">Digiturk</span>';\r\n                                 } else if (response.product_type === 'ssport') {\r\n                                     html += '<span class=\"badge badge-primary badge-sm\">S Sport</span>';\r\n@@ -2043,11 +2049,12 @@\n                                 } else {\r\n                                     html += '<span class=\"badge badge-secondary badge-sm\">' + response.product_type + '</span>';\r\n                                 }\r\n                             } else {\r\n-                                html += '<span class=\"badge badge-success badge-sm\">DG + SS</span>';\r\n+                                html += '<span class=\"badge badge-success badge-sm\">Belirtilmemi≈ü</span>';\r\n                             }\r\n                             html += '</td>';\r\n+                            html += '<td style=\"font-size: 11px;\">' + (item.personel_adsoyad || '-') + '</td>';\r\n                             html += '<td class=\"text-right\"><strong>' + parseFloat(item.toplam_tutar).toLocaleString('tr-TR', {minimumFractionDigits: 2}) + ' ‚Ç∫</strong></td>';\r\n                             html += '</tr>';\r\n                         });\r\n                         \r\n@@ -2123,13 +2130,13 @@\n             \r\n             // S√ºtun geni≈üliklerini ayarla\r\n             var colWidths = [\r\n                 {wch: 25}, // Cari Ad\r\n-                {wch: 15}, // ƒ∞l\r\n+                {wch: 15}, // Telefon\r\n+                {wch: 12}, // ≈ûehir\r\n                 {wch: 15}, // ƒ∞l√ße\r\n-                {wch: 15}, // Telefon\r\n+                {wch: 15}, // √úr√ºn Tipi\r\n                 {wch: 20}, // Personel\r\n-                {wch: 12}, // √úr√ºn Tipi\r\n                 {wch: 15}  // Toplam Tutar\r\n             ];\r\n             ws['!cols'] = colWidths;\r\n             \r\n"
                },
                {
                    "date": 1757432844866,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -155,18 +155,22 @@\n         }\r\n \r\n         \r\n \r\n-        /* Ortak ve Genel s√ºtunlarƒ± */\r\n+        /* TABII s√ºtunlarƒ± (ye≈üil) */\r\n \r\n         #raporTablosu th:nth-child(9),\r\n \r\n         #raporTablosu th:nth-child(10),\r\n \r\n+        #raporTablosu th:nth-child(11),\r\n+\r\n         #raporTablosu td:nth-child(9),\r\n \r\n-        #raporTablosu td:nth-child(10) {\r\n+        #raporTablosu td:nth-child(10),\r\n \r\n+        #raporTablosu td:nth-child(11) {\r\n+\r\n             width: 80px !important;\r\n \r\n             min-width: 80px !important;\r\n \r\n@@ -175,8 +179,28 @@\n         }\r\n \r\n         \r\n \r\n+        /* Ortak ve Genel s√ºtunlarƒ± */\r\n+\r\n+        #raporTablosu th:nth-child(12),\r\n+\r\n+        #raporTablosu th:nth-child(13),\r\n+\r\n+        #raporTablosu td:nth-child(12),\r\n+\r\n+        #raporTablosu td:nth-child(13) {\r\n+\r\n+            width: 80px !important;\r\n+\r\n+            min-width: 80px !important;\r\n+\r\n+            max-width: 80px !important;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n         /* Renk sƒ±nƒ±flarƒ± - DIGITURK (MOR) */\r\n \r\n         .bg-purple {\r\n \r\n@@ -247,8 +271,44 @@\n         }\r\n \r\n         \r\n \r\n+        /* Renk sƒ±nƒ±flarƒ± - TABII (YE≈ûƒ∞L) */\r\n+\r\n+        .bg-green {\r\n+\r\n+            background-color: #28a745 !important;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        .bg-green-light {\r\n+\r\n+            background-color: rgba(40, 167, 69, 0.1) !important;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        .text-green {\r\n+\r\n+            color: #28a745 !important;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n+        .badge-green {\r\n+\r\n+            background-color: #28a745 !important;\r\n+\r\n+            color: white !important;\r\n+\r\n+        }\r\n+\r\n+        \r\n+\r\n         /* Renk sƒ±nƒ±flarƒ± - ORTAK (TURKUAZ) */\r\n \r\n         .bg-info-light {\r\n \r\n@@ -860,8 +920,14 @@\n                                                 <i class=\"fas fa-futbol\"></i> S SPORT\r\n \r\n                                             </th>\r\n \r\n+                                            <th colspan=\"3\" class=\"text-center bg-green text-white\">\r\n+\r\n+                                                <i class=\"fas fa-play-circle\"></i> TABII\r\n+\r\n+                                            </th>\r\n+\r\n                                             <th colspan=\"2\" class=\"text-center bg-dark text-white\">\r\n \r\n                                                 <i class=\"fas fa-chart-bar\"></i> GENEL TOPLAM\r\n \r\n@@ -882,8 +948,14 @@\n                                             <th class=\"bg-blue text-white\">Ciro</th>\r\n \r\n                                             <th class=\"bg-blue text-white\">Ortalama</th>\r\n \r\n+                                            <th class=\"bg-green text-white\">Adet</th>\r\n+\r\n+                                            <th class=\"bg-green text-white\">Ciro</th>\r\n+\r\n+                                            <th class=\"bg-green text-white\">Ortalama</th>\r\n+\r\n                                             <th class=\"bg-dark text-white\">Toplam Adet</th>\r\n \r\n                                             <th class=\"bg-dark text-white\">Toplam Ciro</th>\r\n \r\n@@ -904,8 +976,12 @@\n                                         $toplam_ssport = 0;\r\n \r\n                                         $toplam_ssport_ciro = 0;\r\n \r\n+                                        $toplam_tabii = 0;\r\n+\r\n+                                        $toplam_tabii_ciro = 0;\r\n+\r\n                                         $toplam_ortak = 0;\r\n \r\n                                         $toplam_ciro = 0;\r\n \r\n@@ -922,8 +998,12 @@\n                                             $toplam_ssport += $veri->ssport_satis_adedi;\r\n \r\n                                             $toplam_ssport_ciro += isset($veri->ssport_ciro) ? $veri->ssport_ciro : 0;\r\n \r\n+                                            $toplam_tabii += isset($veri->tabii_satis_adedi) ? $veri->tabii_satis_adedi : 0;\r\n+\r\n+                                            $toplam_tabii_ciro += isset($veri->tabii_ciro) ? $veri->tabii_ciro : 0;\r\n+\r\n                                             $toplam_ortak += isset($veri->ortak_satis_adedi) ? $veri->ortak_satis_adedi : 0;\r\n \r\n                                             $toplam_ciro += $veri->toplam_ciro;\r\n \r\n@@ -934,12 +1014,18 @@\n                                             $digiturk_ciro_val = isset($veri->digiturk_ciro) ? $veri->digiturk_ciro : 0;\r\n \r\n                                             $ssport_ciro_val = isset($veri->ssport_ciro) ? $veri->ssport_ciro : 0;\r\n \r\n+                                            $tabii_ciro_val = isset($veri->tabii_ciro) ? $veri->tabii_ciro : 0;\r\n+\r\n                                             $digiturk_ortalama = $veri->digiturk_satis_adedi > 0 ? ($digiturk_ciro_val / $veri->digiturk_satis_adedi) : 0;\r\n \r\n                                             $ssport_ortalama = $veri->ssport_satis_adedi > 0 ? ($ssport_ciro_val / $veri->ssport_satis_adedi) : 0;\r\n \r\n+                                            $tabii_satis_adedi = isset($veri->tabii_satis_adedi) ? $veri->tabii_satis_adedi : 0;\r\n+\r\n+                                            $tabii_ortalama = $tabii_satis_adedi > 0 ? ($tabii_ciro_val / $tabii_satis_adedi) : 0;\r\n+\r\n                                         ?>\r\n \r\n                                         <tr>\r\n \r\n@@ -1026,8 +1112,46 @@\n                                             </td>\r\n \r\n                                             \r\n \r\n+                                            <!-- TABII GRUBU -->\r\n+\r\n+                                            <td class=\"bg-green-light\">\r\n+\r\n+                                                <button type=\"button\" \r\n+\r\n+                                                        class=\"btn btn-link p-0 tabii-detay-btn\" \r\n+\r\n+                                                        data-sehir-id=\"<?= $veri->cari_il ?>\" \r\n+\r\n+                                                        data-sehir-adi=\"<?= $veri->sehir_adi ?? 'Belirtilmemi≈ü' ?>\"\r\n+\r\n+                                                        data-baslangic=\"<?= $baslangic_tarihi ?>\"\r\n+\r\n+                                                        data-bitis=\"<?= $bitis_tarihi ?>\"\r\n+\r\n+                                                        title=\"TABII m√º≈üteri detaylarƒ±nƒ± g√∂r√ºnt√ºle\">\r\n+\r\n+                                                    <span class=\"badge badge-green\"><?= number_format($tabii_satis_adedi) ?></span>\r\n+\r\n+                                                </button>\r\n+\r\n+                                            </td>\r\n+\r\n+                                            <td class=\"bg-green-light\">\r\n+\r\n+                                                <strong class=\"text-green\"><?= number_format($tabii_ciro_val, 2) ?> ‚Ç∫</strong>\r\n+\r\n+                                            </td>\r\n+\r\n+                                            <td class=\"bg-green-light\">\r\n+\r\n+                                                <span class=\"text-green\"><?= number_format($tabii_ortalama, 2) ?> ‚Ç∫</span>\r\n+\r\n+                                            </td>\r\n+\r\n+                                            \r\n+\r\n                                             <!-- GENEL TOPLAM GRUBU -->\r\n \r\n                                             <td class=\"bg-dark-light\">\r\n \r\n@@ -1066,9 +1190,9 @@\n                                         <?php if(empty($rapor_verileri)): ?>\r\n \r\n                                         <tr>\r\n \r\n-                                            <td colspan=\"10\" class=\"text-center text-muted\">\r\n+                                            <td colspan=\"13\" class=\"text-center text-muted\">\r\n \r\n                                                 <i class=\"fas fa-info-circle\"></i>\r\n \r\n                                                 Se√ßilen tarih aralƒ±ƒüƒ±nda veri bulunamadƒ±.\r\n@@ -1167,8 +1291,46 @@\n                                             </th>\r\n \r\n                                             \r\n \r\n+                                            <!-- TABII TOPLAM -->\r\n+\r\n+                                            <th class=\"bg-green-light\">\r\n+\r\n+                                                <button type=\"button\" \r\n+\r\n+                                                        class=\"btn btn-link p-0 tabii-detay-btn\" \r\n+\r\n+                                                        data-sehir-id=\"\" \r\n+\r\n+                                                        data-sehir-adi=\"T√ºm ≈ûehirler\"\r\n+\r\n+                                                        data-baslangic=\"<?= $baslangic_tarihi ?>\"\r\n+\r\n+                                                        data-bitis=\"<?= $bitis_tarihi ?>\"\r\n+\r\n+                                                        title=\"T√ºm ≈üehirler i√ßin TABII m√º≈üteri detaylarƒ±nƒ± g√∂r√ºnt√ºle\">\r\n+\r\n+                                                    <span class=\"badge badge-green\"><?= number_format($toplam_tabii) ?></span>\r\n+\r\n+                                                </button>\r\n+\r\n+                                            </th>\r\n+\r\n+                                            <th class=\"bg-green-light\">\r\n+\r\n+                                                <strong class=\"text-green\"><?= number_format($toplam_tabii_ciro, 2) ?> ‚Ç∫</strong>\r\n+\r\n+                                            </th>\r\n+\r\n+                                            <th class=\"bg-green-light\">\r\n+\r\n+                                                <strong class=\"text-green\"><?= $toplam_tabii > 0 ? number_format($toplam_tabii_ciro / $toplam_tabii, 2) : '0.00' ?> ‚Ç∫</strong>\r\n+\r\n+                                            </th>\r\n+\r\n+                                            \r\n+\r\n                                             <!-- GENEL TOPLAM -->\r\n \r\n                                             <th class=\"bg-dark-light\">\r\n \r\n@@ -1962,8 +2124,18 @@\n                 var bitis = $(this).data('bitis');\r\n                 \r\n                 openModal(sehirAdi + ' - S Sport M√º≈üteri Detaylarƒ±', sehirId, baslangic, bitis, 'ssport');\r\n             });\r\n+\r\n+            // TABII detay butonlarƒ±na tƒ±klama olayƒ±\r\n+            $('.tabii-detay-btn').on('click', function() {\r\n+                var sehirId = $(this).data('sehir-id');\r\n+                var sehirAdi = $(this).data('sehir-adi');\r\n+                var baslangic = $(this).data('baslangic');\r\n+                var bitis = $(this).data('bitis');\r\n+                \r\n+                openModal(sehirAdi + ' - TABII M√º≈üteri Detaylarƒ±', sehirId, baslangic, bitis, 'tabii');\r\n+            });\r\n         });\r\n \r\n         // Modal a√ßma fonksiyonu\r\n         function openModal(title, sehirId, baslangic, bitis, type) {\r\n@@ -2033,8 +2205,13 @@\n                                 else if (item.urun_tipi.toLowerCase().includes('sport') || \r\n                                          item.urun_tipi.toLowerCase().includes('ss')) {\r\n                                     html += '<span class=\"badge badge-primary badge-sm\">' + item.urun_tipi + '</span>';\r\n                                 }\r\n+                                // TABII √ºr√ºnleri i√ßin ye≈üil badge\r\n+                                else if (item.urun_tipi.toLowerCase().includes('tabii') || \r\n+                                         item.urun_tipi.toLowerCase().includes('tab')) {\r\n+                                    html += '<span class=\"badge badge-success badge-sm\">' + item.urun_tipi + '</span>';\r\n+                                }\r\n                                 // Diƒüer √ºr√ºnler i√ßin gri badge\r\n                                 else {\r\n                                     html += '<span class=\"badge badge-secondary badge-sm\">' + item.urun_tipi + '</span>';\r\n                                 }\r\n@@ -2043,10 +2220,12 @@\n                                 if (response.product_type === 'digiturk') {\r\n                                     html += '<span class=\"badge badge-purple badge-sm\">Digiturk</span>';\r\n                                 } else if (response.product_type === 'ssport') {\r\n                                     html += '<span class=\"badge badge-primary badge-sm\">S Sport</span>';\r\n+                                } else if (response.product_type === 'tabii') {\r\n+                                    html += '<span class=\"badge badge-success badge-sm\">TABII</span>';\r\n                                 } else if (response.product_type === 'all') {\r\n-                                    html += '<span class=\"badge badge-success badge-sm\">DG + SS</span>';\r\n+                                    html += '<span class=\"badge badge-success badge-sm\">DG + SS + TABII</span>';\r\n                                 } else {\r\n                                     html += '<span class=\"badge badge-secondary badge-sm\">' + response.product_type + '</span>';\r\n                                 }\r\n                             } else {\r\n"
                },
                {
                    "date": 1758030807298,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2171,15 +2171,16 @@\n                         var html = '<div class=\"table-container\">';\r\n                         html += '<table class=\"table table-striped table-hover table-sm\" style=\"font-size: 12px;\">';\r\n                         html += '<thead class=\"thead-dark\">';\r\n                         html += '<tr>';\r\n-                        html += '<th style=\"width: 25%;\">Cari Ad</th>';\r\n-                        html += '<th style=\"width: 12%;\">Telefon</th>';\r\n-                        html += '<th style=\"width: 10%;\">≈ûehir</th>';\r\n-                        html += '<th style=\"width: 12%;\">ƒ∞l√ße</th>';\r\n-                        html += '<th style=\"width: 15%;\">√úr√ºn Tipi</th>';\r\n-                        html += '<th style=\"width: 15%;\">Personel</th>';\r\n-                        html += '<th style=\"width: 16%; text-align: right;\">Toplam Tutar</th>';\r\n+                        html += '<th style=\"width: 10%;\">Fatura Tarihi</th>';\r\n+                        html += '<th style=\"width: 22%;\">Cari Ad</th>';\r\n+                        html += '<th style=\"width: 11%;\">Telefon</th>';\r\n+                        html += '<th style=\"width: 9%;\">≈ûehir</th>';\r\n+                        html += '<th style=\"width: 11%;\">ƒ∞l√ße</th>';\r\n+                        html += '<th style=\"width: 13%;\">√úr√ºn Tipi</th>';\r\n+                        html += '<th style=\"width: 13%;\">Personel</th>';\r\n+                        html += '<th style=\"width: 14%; text-align: right;\">Toplam Tutar</th>';\r\n                         html += '</tr>';\r\n                         html += '</thead>';\r\n                         html += '<tbody>';\r\n                         \r\n@@ -2188,9 +2189,16 @@\n                         response.data.forEach(function(item) {\r\n                             toplamTutar += parseFloat(item.toplam_tutar);\r\n                             \r\n                             html += '<tr>';\r\n-                            html += '<td style=\"word-wrap: break-word; max-width: 150px;\">' + (item.cari_ad || '-') + '</td>';\r\n+                            // Fatura tarihi - formatla\r\n+                            var faturaTarihi = '-';\r\n+                            if (item.fatura_tarihi) {\r\n+                                var tarihObj = new Date(item.fatura_tarihi);\r\n+                                faturaTarihi = tarihObj.toLocaleDateString('tr-TR');\r\n+                            }\r\n+                            html += '<td style=\"font-size: 11px;\">' + faturaTarihi + '</td>';\r\n+                            html += '<td style=\"word-wrap: break-word; max-width: 130px;\">' + (item.cari_ad || '-') + '</td>';\r\n                             html += '<td>' + (item.cari_firmaTelefon || '-') + '</td>';\r\n                             html += '<td>' + (item.il_adi || '-') + '</td>';\r\n                             html += '<td>' + (item.ilce_adi || '-') + '</td>';\r\n                             html += '<td style=\"text-align: center;\">';\r\n@@ -2239,9 +2247,9 @@\n                         \r\n                         html += '</tbody>';\r\n                         html += '<tfoot class=\"thead-light\">';\r\n                         html += '<tr>';\r\n-                        html += '<th colspan=\"6\" class=\"text-right\"><strong>TOPLAM:</strong></th>';\r\n+                        html += '<th colspan=\"7\" class=\"text-right\"><strong>TOPLAM:</strong></th>';\r\n                         html += '<th class=\"text-right\"><strong class=\"text-primary\">' + toplamTutar.toLocaleString('tr-TR', {minimumFractionDigits: 2}) + ' ‚Ç∫</strong></th>';\r\n                         html += '</tr>';\r\n                         html += '</tfoot>';\r\n                         html += '</table>';\r\n@@ -2308,15 +2316,16 @@\n             var ws = XLSX.utils.aoa_to_sheet(data);\r\n             \r\n             // S√ºtun geni≈üliklerini ayarla\r\n             var colWidths = [\r\n-                {wch: 25}, // Cari Ad\r\n-                {wch: 15}, // Telefon\r\n-                {wch: 12}, // ≈ûehir\r\n-                {wch: 15}, // ƒ∞l√ße\r\n-                {wch: 15}, // √úr√ºn Tipi\r\n-                {wch: 20}, // Personel\r\n-                {wch: 15}  // Toplam Tutar\r\n+                {wch: 12}, // Fatura Tarihi\r\n+                {wch: 22}, // Cari Ad\r\n+                {wch: 13}, // Telefon\r\n+                {wch: 10}, // ≈ûehir\r\n+                {wch: 13}, // ƒ∞l√ße\r\n+                {wch: 13}, // √úr√ºn Tipi\r\n+                {wch: 18}, // Personel\r\n+                {wch: 13}  // Toplam Tutar\r\n             ];\r\n             ws['!cols'] = colWidths;\r\n             \r\n             // ≈ûehir adƒ±nƒ± kƒ±saltarak sheet adƒ± olu≈ütur (31 karakter sƒ±nƒ±rƒ±)\r\n"
                }
            ],
            "date": 1755008783241,
            "name": "Commit-0",
            "content": "<!DOCTYPE html>\r\n\r\n<html lang=\"tr\">\r\n\r\n<head>\r\n\r\n    <?php $this->load->view(\"include/head-tags\"); ?>\r\n\r\n    <!-- DataTables CSS -->\r\n\r\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.datatables.net/1.11.5/css/dataTables.bootstrap4.min.css\">\r\n\r\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.datatables.net/buttons/2.2.3/css/buttons.bootstrap4.min.css\">\r\n\r\n    <style>\r\n\r\n        /* Mobil cihazlarda destek butonu ile √ßakƒ±≈ümayƒ± √∂nlemek i√ßin */\r\n\r\n        @media (max-width: 768px) {\r\n\r\n            .content {\r\n\r\n                padding-bottom: 80px !important;\r\n\r\n            }\r\n\r\n            .card:last-child {\r\n\r\n                margin-bottom: 80px !important;\r\n\r\n            }\r\n\r\n        }\r\n\r\n    </style>\r\n\r\n</head>\r\n\r\n<body>\r\n\r\n    <!-- Main Wrapper -->\r\n\r\n    <div class=\"main-wrapper\">\r\n\r\n    \r\n\r\n        <!-- Header -->\r\n\r\n        <?php $this->load->view(\"include/header\"); ?>\r\n\r\n        <!-- /Header -->\r\n\r\n        \r\n\r\n        <!-- Sidebar -->\r\n\r\n        <?php $this->load->view(\"include/sidebar\"); ?>\r\n\r\n        <!-- /Sidebar -->\r\n\r\n        \r\n\r\n        <!-- Page Wrapper -->\r\n\r\n        <div class=\"page-wrapper\">\r\n\r\n            <div class=\"content container-fluid\">\r\n\r\n            \r\n\r\n                <!-- Page Header -->\r\n\r\n                <div class=\"page-header\">\r\n\r\n                    <div class=\"row\">\r\n\r\n                        <div class=\"col-sm-10\">\r\n\r\n                            <h3 class=\"page-title\"><?= $baslik ?></h3>\r\n\r\n                            <ul class=\"breadcrumb\">\r\n\r\n                                <li class=\"breadcrumb-item\"><a href=\"<?= base_url() ?>\">Anasayfa</a></li>\r\n\r\n                                <li class=\"breadcrumb-item\"><a href=\"<?= base_url('raporlar') ?>\">Raporlar</a></li>\r\n\r\n                                <li class=\"breadcrumb-item active\">Digiturk ≈ûehir Ciro/Adet</li>\r\n\r\n                            </ul>\r\n\r\n                        </div>\r\n\r\n                        <div class=\"d-flex justify-content-end text-align-center col-sm-2\">\r\n\r\n                            <a class=\"btn btn-outline-light\" href=\"javascript:history.back()\"><i class=\"fa fa-history\"></i> <br>√ñnceki Sayfa</a>\r\n\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                </div>\r\n\r\n                <!-- /Page Header -->\r\n\r\n\r\n\r\n            <!-- Filtreler -->\r\n\r\n            <div class=\"row\">\r\n\r\n                <div class=\"col-md-12\">\r\n\r\n                    <div class=\"card\">\r\n\r\n                        <div class=\"card-header\">\r\n\r\n                            <h5 class=\"card-title\">Filtreler</h5>\r\n\r\n                        </div>\r\n\r\n                        <div class=\"card-body\">\r\n\r\n                            <form method=\"GET\" action=\"<?= base_url('raporlar/digiturk-sehir-ciro-adet') ?>\">\r\n\r\n                                <div class=\"row\">\r\n\r\n                                    <div class=\"col-md-3\">\r\n\r\n                                        <div class=\"form-group\">\r\n\r\n                                            <label for=\"baslangic_tarihi\">Ba≈ülangƒ±√ß Tarihi</label>\r\n\r\n                                            <input type=\"date\" class=\"form-control\" id=\"baslangic_tarihi\" name=\"baslangic_tarihi\" value=\"<?= $baslangic_tarihi ?>\">\r\n\r\n                                        </div>\r\n\r\n                                    </div>\r\n\r\n                                    <div class=\"col-md-3\">\r\n\r\n                                        <div class=\"form-group\">\r\n\r\n                                            <label for=\"bitis_tarihi\">Biti≈ü Tarihi</label>\r\n\r\n                                            <input type=\"date\" class=\"form-control\" id=\"bitis_tarihi\" name=\"bitis_tarihi\" value=\"<?= $bitis_tarihi ?>\">\r\n\r\n                                        </div>\r\n\r\n                                    </div>\r\n\r\n                                    <div class=\"col-md-4\">\r\n\r\n                                        <div class=\"form-group\">\r\n\r\n                                            <label for=\"sehir_id\">≈ûehir</label>\r\n\r\n                                            <select class=\"form-control\" id=\"sehir_id\" name=\"sehir_id\">\r\n\r\n                                                <option value=\"\">T√ºm ≈ûehirler</option>\r\n\r\n                                                <?php foreach($sehir_listesi as $sehir): ?>\r\n\r\n                                                    <option value=\"<?= $sehir->id ?>\" <?= ($sehir_id == $sehir->id) ? 'selected' : '' ?>>\r\n\r\n                                                        <?= $sehir->sehir_adi ?>\r\n\r\n                                                    </option>\r\n\r\n                                                <?php endforeach; ?>\r\n\r\n                                            </select>\r\n\r\n                                        </div>\r\n\r\n                                    </div>\r\n\r\n                                    <div class=\"col-md-2\">\r\n\r\n                                        <div class=\"form-group\">\r\n\r\n                                            <label>&nbsp;</label>\r\n\r\n                                            <div>\r\n\r\n                                                <button type=\"submit\" class=\"btn btn-primary w-100\">\r\n\r\n                                                    <i class=\"fas fa-filter\"></i> Filtrele\r\n\r\n                                                </button>\r\n\r\n                                            </div>\r\n\r\n                                        </div>\r\n\r\n                                    </div>\r\n\r\n                                </div>\r\n\r\n                            </form>\r\n\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                </div>\r\n\r\n            </div>\r\n\r\n\r\n\r\n            <!-- Rapor Tablosu -->\r\n\r\n            <div class=\"row\">\r\n\r\n                <div class=\"col-md-12\">\r\n\r\n                    <!-- Debug Bilgileri - Ge√ßici olarak gizlendi (sorun √ß√∂z√ºld√º) -->\r\n\r\n                    <?php if(false && isset($debug_info)): ?>\r\n\r\n                    <div class=\"card mb-3\">\r\n\r\n                        <div class=\"card-header bg-warning\">\r\n\r\n                            <h5 class=\"card-title text-dark\">\r\n\r\n                                <i class=\"fas fa-bug\"></i> Debug Bilgileri (Geli≈ütirme Ama√ßlƒ±)\r\n\r\n                            </h5>\r\n\r\n                        </div>\r\n\r\n                        <div class=\"card-body\">\r\n\r\n                            <div class=\"row\">\r\n\r\n                                <div class=\"col-md-2\">\r\n\r\n                                    <strong>Aktivasyon Kayƒ±tlarƒ±:</strong> <?= $debug_info['aktivasyon_count'] ?>\r\n\r\n                                </div>\r\n\r\n                                <div class=\"col-md-3\">\r\n\r\n                                    <strong>Satƒ±≈ü Kayƒ±tlarƒ± (<?= $baslangic_tarihi ?> - <?= $bitis_tarihi ?>):</strong> <?= $debug_info['satis_count'] ?>\r\n\r\n                                </div>\r\n\r\n                                <div class=\"col-md-2\">\r\n\r\n                                    <strong>≈ûehir Bilgisi Olan Cariler:</strong> <?= $debug_info['cari_sehir_count'] ?>\r\n\r\n                                </div>\r\n\r\n                                <div class=\"col-md-2\">\r\n\r\n                                    <strong>JOIN Sonucu:</strong> <?= $debug_info['join_test_count'] ?>\r\n\r\n                                </div>\r\n\r\n                                <div class=\"col-md-3\">\r\n\r\n                                    <strong>Alternatif Sorgu Kullanƒ±ldƒ±:</strong> \r\n\r\n                                    <?= isset($debug_info['used_alternative']) ? ($debug_info['used_alternative'] ? 'Evet' : 'Hayƒ±r') : 'Bilinmiyor' ?>\r\n\r\n                                    <br>\r\n\r\n                                    <strong>Bulunan Kayƒ±t:</strong> <?= count($rapor_verileri) ?>\r\n\r\n                                </div>\r\n\r\n                            </div>\r\n\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                    <?php endif; ?>\r\n\r\n                    \r\n\r\n                    <div class=\"card\">\r\n\r\n                        <div class=\"card-header\">\r\n\r\n                            <h5 class=\"card-title\">\r\n\r\n                                Digiturk ≈ûehir Ciro/Adet Raporu\r\n\r\n                                <span class=\"badge badge-info ml-2\"><?= count($rapor_verileri) ?> ≈üehir</span>\r\n\r\n                            </h5>\r\n\r\n                            <div class=\"card-tools\">\r\n\r\n                                <button type=\"button\" class=\"btn btn-sm btn-success\" onclick=\"exportToExcel()\">\r\n\r\n                                    <i class=\"fas fa-file-excel\"></i> Excel'e Aktar\r\n\r\n                                </button>\r\n\r\n                            </div>\r\n\r\n                        </div>\r\n\r\n                        <div class=\"card-body\">\r\n\r\n                            <div class=\"table-responsive\">\r\n\r\n                                <table class=\"table table-striped table-hover\" id=\"raporTablosu\">\r\n\r\n                                    <thead class=\"thead-dark\">\r\n\r\n                                        <tr>\r\n\r\n                                            <th>#</th>\r\n\r\n                                            <th>≈ûehir</th>\r\n\r\n                                            <th>Toplam Satƒ±≈ü Adedi</th>\r\n\r\n                                            <th>Toplam Ciro (‚Ç∫)</th>\r\n\r\n                                            <th>Ortalama Satƒ±≈ü Tutarƒ± (‚Ç∫)</th>\r\n\r\n                                        </tr>\r\n\r\n                                    </thead>\r\n\r\n                                    <tbody>\r\n\r\n                                        <?php \r\n\r\n                                        $toplam_adet = 0;\r\n\r\n                                        $toplam_ciro = 0;\r\n\r\n                                        $sira = 1;\r\n\r\n                                        foreach($rapor_verileri as $veri): \r\n\r\n                                            $toplam_adet += $veri->toplam_satis_adedi;\r\n\r\n                                            $toplam_ciro += $veri->toplam_ciro;\r\n\r\n                                            $ortalama_satis = $veri->toplam_satis_adedi > 0 ? ($veri->toplam_ciro / $veri->toplam_satis_adedi) : 0;\r\n\r\n                                        ?>\r\n\r\n                                        <tr>\r\n\r\n                                            <td><?= $sira++ ?></td>\r\n\r\n                                            <td>\r\n\r\n                                                <strong><?= $veri->sehir_adi ?? 'Belirtilmemi≈ü' ?></strong>\r\n\r\n                                            </td>\r\n\r\n                                            <td class=\"text-center\">\r\n                                                <button type=\"button\" \r\n                                                        class=\"btn btn-link p-0 satis-detay-btn\" \r\n                                                        data-sehir-id=\"<?= $veri->cari_il ?>\" \r\n                                                        data-sehir-adi=\"<?= $veri->sehir_adi ?? 'Belirtilmemi≈ü' ?>\"\r\n                                                        data-baslangic=\"<?= $baslangic_tarihi ?>\"\r\n                                                        data-bitis=\"<?= $bitis_tarihi ?>\"\r\n                                                        title=\"M√º≈üteri detaylarƒ±nƒ± g√∂r√ºnt√ºle\">\r\n                                                    <span class=\"badge badge-primary\"><?= number_format($veri->toplam_satis_adedi) ?></span>\r\n                                                </button>\r\n                                            </td>\r\n\r\n                                            <td class=\"text-right\">\r\n\r\n                                                <strong><?= number_format($veri->toplam_ciro, 2) ?> ‚Ç∫</strong>\r\n\r\n                                            </td>\r\n\r\n                                            <td class=\"text-right\">\r\n\r\n                                                <span class=\"text-muted\"><?= number_format($ortalama_satis, 2) ?> ‚Ç∫</span>\r\n\r\n                                            </td>\r\n\r\n                                        </tr>\r\n\r\n                                        <?php endforeach; ?>\r\n\r\n                                        \r\n\r\n                                        <?php if(empty($rapor_verileri)): ?>\r\n\r\n                                        <tr>\r\n\r\n                                            <td colspan=\"5\" class=\"text-center text-muted\">\r\n\r\n                                                <i class=\"fas fa-info-circle\"></i>\r\n\r\n                                                Se√ßilen tarih aralƒ±ƒüƒ±nda veri bulunamadƒ±.\r\n\r\n                                            </td>\r\n\r\n                                        </tr>\r\n\r\n                                        <?php endif; ?>\r\n\r\n                                    </tbody>\r\n\r\n                                    <?php if(!empty($rapor_verileri)): ?>\r\n\r\n                                    <tfoot class=\"thead-light\">\r\n\r\n                                        <tr>\r\n\r\n                                            <th colspan=\"2\" class=\"text-right\">TOPLAM:</th>\r\n\r\n                                            <th class=\"text-center\">\r\n\r\n                                                <span class=\"badge badge-success\"><?= number_format($toplam_adet) ?></span>\r\n\r\n                                            </th>\r\n\r\n                                            <th class=\"text-right\">\r\n\r\n                                                <strong><?= number_format($toplam_ciro, 2) ?> ‚Ç∫</strong>\r\n\r\n                                            </th>\r\n\r\n                                            <th class=\"text-right\">\r\n\r\n                                                <span class=\"text-success\">\r\n\r\n                                                    <strong><?= $toplam_adet > 0 ? number_format($toplam_ciro / $toplam_adet, 2) : '0.00' ?> ‚Ç∫</strong>\r\n\r\n                                                </span>\r\n\r\n                                            </th>\r\n\r\n                                        </tr>\r\n\r\n                                    </tfoot>\r\n\r\n                                    <?php endif; ?>\r\n\r\n                                </table>\r\n\r\n                            </div>\r\n\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                    \r\n\r\n                    <!-- ≈ûehir Performans √ñzeti -->\r\n\r\n                    <?php if(!empty($rapor_verileri)): ?>\r\n\r\n                    <div class=\"card mt-3\">\r\n\r\n                        <div class=\"card-header\">\r\n\r\n                            <h5 class=\"card-title\">\r\n\r\n                                <i class=\"fas fa-chart-bar\"></i> ≈ûehir Performans √ñzeti\r\n\r\n                            </h5>\r\n\r\n                        </div>\r\n\r\n                        <div class=\"card-body\">\r\n\r\n                            <div class=\"row\">\r\n\r\n                                <div class=\"col-md-3\">\r\n\r\n                                    <div class=\"info-box bg-primary\">\r\n\r\n                                        <span class=\"info-box-icon\"><i class=\"fas fa-city\"></i></span>\r\n\r\n                                        <div class=\"info-box-content\">\r\n\r\n                                            <span class=\"info-box-text\">Toplam ≈ûehir</span>\r\n\r\n                                            <span class=\"info-box-number\"><?= count($rapor_verileri) ?></span>\r\n\r\n                                        </div>\r\n\r\n                                    </div>\r\n\r\n                                </div>\r\n\r\n                                <div class=\"col-md-3\">\r\n\r\n                                    <div class=\"info-box bg-success\">\r\n\r\n                                        <span class=\"info-box-icon\"><i class=\"fas fa-trophy\"></i></span>\r\n\r\n                                        <div class=\"info-box-content\">\r\n\r\n                                            <span class=\"info-box-text\">En Y√ºksek Ciro</span>\r\n\r\n                                            <span class=\"info-box-number\">\r\n\r\n                                                <?php \r\n\r\n                                                $en_yuksek = !empty($rapor_verileri) ? $rapor_verileri[0] : null;\r\n\r\n                                                echo $en_yuksek ? number_format($en_yuksek->toplam_ciro, 0) . ' ‚Ç∫' : '0 ‚Ç∫';\r\n\r\n                                                ?>\r\n\r\n                                            </span>\r\n\r\n                                            <span class=\"info-box-more\">\r\n\r\n                                                <?= $en_yuksek ? $en_yuksek->sehir_adi : '' ?>\r\n\r\n                                            </span>\r\n\r\n                                        </div>\r\n\r\n                                    </div>\r\n\r\n                                </div>\r\n\r\n                                <div class=\"col-md-3\">\r\n\r\n                                    <div class=\"info-box bg-warning\">\r\n\r\n                                        <span class=\"info-box-icon\"><i class=\"fas fa-chart-line\"></i></span>\r\n\r\n                                        <div class=\"info-box-content\">\r\n\r\n                                            <span class=\"info-box-text\">Ortalama Ciro</span>\r\n\r\n                                            <span class=\"info-box-number\">\r\n\r\n                                                <?= count($rapor_verileri) > 0 ? number_format($toplam_ciro / count($rapor_verileri), 0) . ' ‚Ç∫' : '0 ‚Ç∫' ?>\r\n\r\n                                            </span>\r\n\r\n                                        </div>\r\n\r\n                                    </div>\r\n\r\n                                </div>\r\n\r\n                                <div class=\"col-md-3\">\r\n\r\n                                    <div class=\"info-box bg-info\">\r\n\r\n                                        <span class=\"info-box-icon\"><i class=\"fas fa-percentage\"></i></span>\r\n\r\n                                        <div class=\"info-box-content\">\r\n\r\n                                            <span class=\"info-box-text\">En Y√ºksek Pay</span>\r\n\r\n                                            <span class=\"info-box-number\">\r\n\r\n                                                <?php \r\n\r\n                                                if($en_yuksek && $toplam_ciro > 0) {\r\n\r\n                                                    $pay = ($en_yuksek->toplam_ciro / $toplam_ciro) * 100;\r\n\r\n                                                    echo number_format($pay, 1) . '%';\r\n\r\n                                                } else {\r\n\r\n                                                    echo '0%';\r\n\r\n                                                }\r\n\r\n                                                ?>\r\n\r\n                                            </span>\r\n\r\n                                        </div>\r\n\r\n                                    </div>\r\n\r\n                                </div>\r\n\r\n                            </div>\r\n\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                    <?php endif; ?>\r\n\r\n                </div>\r\n\r\n            </div>\r\n\r\n            </div>\r\n\r\n            <!-- /Page Wrapper -->\r\n\r\n        </div>\r\n\r\n        <!-- /Main Wrapper -->\r\n\r\n\r\n\r\n        <!-- DataTables JS -->\r\n\r\n        <script type=\"text/javascript\" charset=\"utf8\" src=\"https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js\"></script>\r\n\r\n        <script type=\"text/javascript\" charset=\"utf8\" src=\"https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap4.min.js\"></script>\r\n\r\n        <script type=\"text/javascript\" charset=\"utf8\" src=\"https://cdn.datatables.net/buttons/2.2.3/js/dataTables.buttons.min.js\"></script>\r\n\r\n        <script type=\"text/javascript\" charset=\"utf8\" src=\"https://cdn.datatables.net/buttons/2.2.3/js/buttons.bootstrap4.min.js\"></script>\r\n\r\n        <script type=\"text/javascript\" charset=\"utf8\" src=\"https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js\"></script>\r\n\r\n        <script type=\"text/javascript\" charset=\"utf8\" src=\"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js\"></script>\r\n\r\n        <script type=\"text/javascript\" charset=\"utf8\" src=\"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js\"></script>\r\n\r\n        <script type=\"text/javascript\" charset=\"utf8\" src=\"https://cdn.datatables.net/buttons/2.2.3/js/buttons.html5.min.js\"></script>\r\n\r\n        <script type=\"text/javascript\" charset=\"utf8\" src=\"https://cdn.datatables.net/buttons/2.2.3/js/buttons.print.min.js\"></script>\r\n\r\n        <script type=\"text/javascript\" charset=\"utf8\" src=\"https://cdn.datatables.net/buttons/2.2.3/js/buttons.colVis.min.js\"></script>\r\n\r\n\r\n\r\n        <!-- SheetJS i√ßin Excel Export -->\r\n\r\n        <script src=\"https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js\"></script>\r\n\r\n\r\n\r\n        <?php $this->load->view(\"include/footer-js\"); ?>\r\n\r\n\r\n\r\n        <script>\r\n\r\n        $(document).ready(function() {\r\n\r\n            // DataTable ba≈ülatma\r\n\r\n            $('#raporTablosu').DataTable({\r\n\r\n                \"language\": {\r\n\r\n                    \"url\": \"//cdn.datatables.net/plug-ins/1.11.5/i18n/tr.json\"\r\n\r\n                },\r\n\r\n                \"pageLength\": 25,\r\n\r\n                \"lengthMenu\": [[10, 25, 50, 100, -1], [10, 25, 50, 100, \"T√ºm√º\"]],\r\n\r\n                \"order\": [[ 3, \"desc\" ]], // Toplam ciro'ya g√∂re sƒ±rala\r\n\r\n                \"columnDefs\": [\r\n\r\n                    {\r\n\r\n                        \"targets\": [2, 3, 4], // Sayƒ±sal s√ºtunlar\r\n\r\n                        \"className\": \"text-right\"\r\n\r\n                    }\r\n\r\n                ],\r\n\r\n                \"dom\": 'Bfrtip',\r\n\r\n                \"buttons\": [\r\n\r\n                    'copy', 'csv', 'excel', 'pdf', 'print'\r\n\r\n                ]\r\n\r\n            });\r\n\r\n        });\r\n\r\n\r\n\r\n        // Excel'e aktarma fonksiyonu\r\n\r\n        function exportToExcel() {\r\n\r\n            var table = $('#raporTablosu').DataTable();\r\n\r\n            var data = [];\r\n\r\n            \r\n\r\n            // Ba≈ülƒ±k satƒ±rƒ±\r\n\r\n            var headers = [];\r\n\r\n            $('#raporTablosu thead th').each(function() {\r\n\r\n                headers.push($(this).text());\r\n\r\n            });\r\n\r\n            data.push(headers);\r\n\r\n            \r\n\r\n            // Veri satƒ±rlarƒ±\r\n\r\n            table.rows().every(function() {\r\n\r\n                var rowData = [];\r\n\r\n                var row = this.data();\r\n\r\n                $(this.node()).find('td').each(function() {\r\n\r\n                    rowData.push($(this).text().replace('‚Ç∫', '').trim());\r\n\r\n                });\r\n\r\n                data.push(rowData);\r\n\r\n            });\r\n\r\n            \r\n\r\n            // Excel dosyasƒ± olu≈ütur\r\n\r\n            var wb = XLSX.utils.book_new();\r\n\r\n            var ws = XLSX.utils.aoa_to_sheet(data);\r\n\r\n            XLSX.utils.book_append_sheet(wb, ws, \"Digiturk ≈ûehir Raporu\");\r\n\r\n            XLSX.writeFile(wb, \"digiturk_sehir_ciro_adet_raporu_\" + new Date().toISOString().slice(0,10) + \".xlsx\");\r\n\r\n        }\r\n\r\n        </script>\r\n\r\n\r\n\r\n        <style>\r\n\r\n        .info-box {\r\n\r\n            display: block;\r\n\r\n            min-height: 90px;\r\n\r\n            background: #fff;\r\n\r\n            width: 100%;\r\n\r\n            box-shadow: 0 1px 1px rgba(0,0,0,0.1);\r\n\r\n            border-radius: 2px;\r\n\r\n            margin-bottom: 15px;\r\n\r\n        }\r\n\r\n        \r\n\r\n        .info-box.bg-primary {\r\n\r\n            background-color: #007bff !important;\r\n\r\n            color: #fff;\r\n\r\n        }\r\n\r\n        \r\n\r\n        .info-box.bg-success {\r\n\r\n            background-color: #28a745 !important;\r\n\r\n            color: #fff;\r\n\r\n        }\r\n\r\n        \r\n\r\n        .info-box.bg-warning {\r\n\r\n            background-color: #ffc107 !important;\r\n\r\n            color: #212529;\r\n\r\n        }\r\n\r\n        \r\n\r\n        .info-box.bg-info {\r\n\r\n            background-color: #17a2b8 !important;\r\n\r\n            color: #fff;\r\n\r\n        }\r\n\r\n        \r\n\r\n        .info-box-icon {\r\n\r\n            border-top-left-radius: 2px;\r\n\r\n            border-top-right-radius: 0;\r\n\r\n            border-bottom-right-radius: 0;\r\n\r\n            border-bottom-left-radius: 2px;\r\n\r\n            display: block;\r\n\r\n            float: left;\r\n\r\n            height: 90px;\r\n\r\n            width: 90px;\r\n\r\n            text-align: center;\r\n\r\n            font-size: 45px;\r\n\r\n            line-height: 90px;\r\n\r\n            background: rgba(0,0,0,0.2);\r\n\r\n        }\r\n\r\n        \r\n\r\n        .info-box-content {\r\n\r\n            padding: 5px 10px;\r\n\r\n            margin-left: 90px;\r\n\r\n        }\r\n\r\n        \r\n\r\n        .info-box-text {\r\n\r\n            text-transform: uppercase;\r\n\r\n            font-weight: bold;\r\n\r\n            font-size: 13px;\r\n\r\n        }\r\n\r\n        \r\n\r\n        .info-box-number {\r\n\r\n            display: block;\r\n\r\n            font-weight: bold;\r\n\r\n            font-size: 18px;\r\n\r\n        }\r\n\r\n        \r\n\r\n        .info-box-more {\r\n\r\n            display: block;\r\n\r\n            font-size: 13px;\r\n\r\n        }\r\n\r\n        </style>\r\n\r\n        <!-- M√º≈üteri Detay Modal -->\r\n        <div class=\"modal fade\" id=\"musteriDetayModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"musteriDetayModalLabel\" aria-hidden=\"true\">\r\n            <div class=\"modal-dialog modal-lg\" role=\"document\">\r\n                <div class=\"modal-content\">\r\n                    <div class=\"modal-header\">\r\n                        <h5 class=\"modal-title\" id=\"musteriDetayModalLabel\">M√º≈üteri Detaylarƒ±</h5>\r\n                        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\r\n                            <span aria-hidden=\"true\">&times;</span>\r\n                        </button>\r\n                    </div>\r\n                    <div class=\"modal-body\">\r\n                        <div id=\"musteriDetayIcerik\">\r\n                            <div class=\"text-center\">\r\n                                <i class=\"fas fa-spinner fa-spin\"></i> Y√ºkleniyor...\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"modal-footer\">\r\n                        <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">Kapat</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <script>\r\n        $(document).ready(function() {\r\n            // Satƒ±≈ü detay butonlarƒ±na tƒ±klama olayƒ±\r\n            $('.satis-detay-btn').on('click', function() {\r\n                var sehirId = $(this).data('sehir-id');\r\n                var sehirAdi = $(this).data('sehir-adi');\r\n                var baslangic = $(this).data('baslangic');\r\n                var bitis = $(this).data('bitis');\r\n                \r\n                // Modal ba≈ülƒ±ƒüƒ±nƒ± g√ºncelle\r\n                $('#musteriDetayModalLabel').text(sehirAdi + ' - M√º≈üteri Detaylarƒ±');\r\n                \r\n                // Modal i√ßeriƒüini temizle ve loading g√∂ster\r\n                $('#musteriDetayIcerik').html('<div class=\"text-center\"><i class=\"fas fa-spinner fa-spin\"></i> Y√ºkleniyor...</div>');\r\n                \r\n                // Modal'ƒ± a√ß\r\n                $('#musteriDetayModal').modal('show');\r\n                \r\n                // AJAX ile m√º≈üteri detaylarƒ±nƒ± getir\r\n                $.ajax({\r\n                    url: '<?= base_url(\"raporlar/digiturk_sehir_cari_detay\") ?>',\r\n                    type: 'POST',\r\n                    data: {\r\n                        sehir_id: sehirId,\r\n                        baslangic_tarihi: baslangic,\r\n                        bitis_tarihi: bitis\r\n                    },\r\n                    dataType: 'json',\r\n                    success: function(response) {\r\n                        if (response.error) {\r\n                            $('#musteriDetayIcerik').html('<div class=\"alert alert-danger\">' + response.error + '</div>');\r\n                            return;\r\n                        }\r\n                        \r\n                        if (response.data && response.data.length > 0) {\r\n                            var html = '<div class=\"table-responsive\">';\r\n                            html += '<table class=\"table table-striped table-hover\">';\r\n                            html += '<thead class=\"thead-dark\">';\r\n                            html += '<tr>';\r\n                            html += '<th>Cari Ad</th>';\r\n                            html += '<th>ƒ∞l</th>';\r\n                            html += '<th>ƒ∞l√ße</th>';\r\n                            html += '<th>Telefon</th>';\r\n                            html += '<th>Satƒ±≈ü Adedi</th>';\r\n                            html += '<th>Toplam Tutar</th>';\r\n                            html += '</tr>';\r\n                            html += '</thead>';\r\n                            html += '<tbody>';\r\n                            \r\n                            var toplamAdet = 0;\r\n                            var toplamTutar = 0;\r\n                            \r\n                            response.data.forEach(function(item) {\r\n                                toplamAdet += parseInt(item.satis_adedi);\r\n                                toplamTutar += parseFloat(item.toplam_tutar);\r\n                                \r\n                                html += '<tr>';\r\n                                html += '<td>' + (item.cari_ad || '-') + '</td>';\r\n                                html += '<td>' + (item.il_adi || '-') + '</td>';\r\n                                html += '<td>' + (item.ilce_adi || '-') + '</td>';\r\n                                html += '<td>' + (item.cari_firmaTelefon || '-') + '</td>';\r\n                                html += '<td class=\"text-center\"><span class=\"badge badge-info\">' + item.satis_adedi + '</span></td>';\r\n                                html += '<td class=\"text-right\">' + parseFloat(item.toplam_tutar).toLocaleString('tr-TR', {minimumFractionDigits: 2}) + ' ‚Ç∫</td>';\r\n                                html += '</tr>';\r\n                            });\r\n                            \r\n                            html += '</tbody>';\r\n                            html += '<tfoot class=\"thead-light\">';\r\n                            html += '<tr>';\r\n                            html += '<th colspan=\"4\" class=\"text-right\">TOPLAM:</th>';\r\n                            html += '<th class=\"text-center\"><span class=\"badge badge-success\">' + toplamAdet + '</span></th>';\r\n                            html += '<th class=\"text-right\">' + toplamTutar.toLocaleString('tr-TR', {minimumFractionDigits: 2}) + ' ‚Ç∫</th>';\r\n                            html += '</tr>';\r\n                            html += '</tfoot>';\r\n                            html += '</table>';\r\n                            html += '</div>';\r\n                            \r\n                            $('#musteriDetayIcerik').html(html);\r\n                        } else {\r\n                            $('#musteriDetayIcerik').html('<div class=\"alert alert-info\">Bu ≈üehir i√ßin m√º≈üteri bulunamadƒ±.</div>');\r\n                        }\r\n                    },\r\n                    error: function(xhr, status, error) {\r\n                        console.log('AJAX Error:', error);\r\n                        console.log('Response:', xhr.responseText);\r\n                        $('#musteriDetayIcerik').html('<div class=\"alert alert-danger\">Veriler y√ºklenirken bir hata olu≈ütu: ' + error + '</div>');\r\n                    }\r\n                });\r\n            });\r\n        });\r\n        </script>\r\n\r\n    </body>\r\n\r\n</html>\r\n\r\n"
        }
    ]
}