{
    "sourceFile": "application/views/illegal/illegal_tespit_olustur.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1759159922556,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1759834348403,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -156,23 +156,9 @@\n                                         <label for=\"illegal_cari_ulke\">\r\n                                             <i class=\"fa fa-globe\"></i> Ülke\r\n                                         </label>\r\n                                         <select class=\"form-control country-select\" id=\"illegal_cari_ulke\" name=\"illegal_cari_ulke\">\r\n-                                            <option value=\"TR\" selected>Türkiye</option>\r\n-                                            <option value=\"US\">Amerika Birleşik Devletleri</option>\r\n-                                            <option value=\"DE\">Almanya</option>\r\n-                                            <option value=\"FR\">Fransa</option>\r\n-                                            <option value=\"GB\">İngiltere</option>\r\n-                                            <option value=\"IT\">İtalya</option>\r\n-                                            <option value=\"ES\">İspanya</option>\r\n-                                            <option value=\"NL\">Hollanda</option>\r\n-                                            <option value=\"BE\">Belçika</option>\r\n-                                            <option value=\"CH\">İsviçre</option>\r\n-                                            <option value=\"AT\">Avusturya</option>\r\n-                                            <option value=\"SE\">İsveç</option>\r\n-                                            <option value=\"NO\">Norveç</option>\r\n-                                            <option value=\"DK\">Danimarka</option>\r\n-                                            <option value=\"FI\">Finlandiya</option>\r\n+                                            <option value=\"\">Ülke Seçiniz</option>\r\n                                         </select>\r\n                                     </div>\r\n                                 </div>\r\n                                 <div class=\"col-md-3\">\r\n@@ -238,15 +224,46 @@\n         crossorigin=\"anonymous\" referrerpolicy=\"no-referrer\"></script>\r\n \r\n <script>\r\n $(document).ready(function() {\r\n-    // İlleri yükle\r\n-    loadIller();\r\n+    // Ülkeleri yükle\r\n+    loadUlkeler();\r\n+    // İlleri yükle (sadece Türkiye için başlangıçta)\r\n     \r\n-    function loadIller() {\r\n+    function loadUlkeler() {\r\n         $.ajax({\r\n+            url: '<?= base_url(\"home/get_ulkeler\") ?>',\r\n+            type: 'POST',\r\n+            dataType: 'json',\r\n+            success: function(result) {\r\n+                if(result && result.status !== 'error') {\r\n+                    var options = '<option value=\"\">Ülke Seçiniz</option>';\r\n+                    $.each(result.data, function(i, ulke) {\r\n+                        // Türkiye'yi varsayılan olarak seç\r\n+                        var selected = ulke.ulke_kodu === 'TR' ? ' selected' : '';\r\n+                        options += '<option value=\"'+ulke.id+'\"'+selected+'>'+ulke.ulke_adi+'</option>';\r\n+                    });\r\n+                    $('#illegal_cari_ulke').html(options);\r\n+                    \r\n+                    // Türkiye seçiliyse illeri yükle\r\n+                    if ($('#illegal_cari_ulke').val()) {\r\n+                        loadIllerByUlke($('#illegal_cari_ulke').val());\r\n+                    }\r\n+                } else {\r\n+                    $('#illegal_cari_ulke').html('<option value=\"\">Ülke yüklenemedi</option>');\r\n+                }\r\n+            },\r\n+            error: function() {\r\n+                $('#illegal_cari_ulke').html('<option value=\"\">Hata oluştu</option>');\r\n+            }\r\n+        });\r\n+    }\r\n+    \r\n+    function loadIllerByUlke(ulke_id) {\r\n+        $.ajax({\r\n             url: '<?= base_url(\"home/get_iller\") ?>',\r\n             type: 'POST',\r\n+            data: {ulke_id: ulke_id},\r\n             dataType: 'json',\r\n             success: function(result) {\r\n                 if(result && result.status !== 'error') {\r\n                     var options = '<option value=\"\">İl Seçiniz</option>';\r\n@@ -254,17 +271,30 @@\n                         options += '<option value=\"'+il.id+'\">'+il.il+'</option>';\r\n                     });\r\n                     $('#illegal_cari_il').html(options);\r\n                 } else {\r\n-                    $('#illegal_cari_il').html('<option value=\"\">İl yüklenemedi</option>');\r\n+                    $('#illegal_cari_il').html('<option value=\"\">İl bulunamadı</option>');\r\n                 }\r\n             },\r\n             error: function() {\r\n                 $('#illegal_cari_il').html('<option value=\"\">Hata oluştu</option>');\r\n             }\r\n         });\r\n     }\r\n \r\n+    // Ülke değişikliğinde illeri yükle\r\n+    $('#illegal_cari_ulke').on('change', function() {\r\n+        var ulke_id = $(this).val();\r\n+        if (ulke_id) {\r\n+            loadIllerByUlke(ulke_id);\r\n+            // İlçe dropdown'ını sıfırla\r\n+            $('#illegal_cari_ilce').prop('disabled', true).html('<option value=\"\">Önce il seçiniz</option>');\r\n+        } else {\r\n+            $('#illegal_cari_il').html('<option value=\"\">Önce ülke seçiniz</option>');\r\n+            $('#illegal_cari_ilce').prop('disabled', true).html('<option value=\"\">Önce il seçiniz</option>');\r\n+        }\r\n+    });\r\n+\r\n     // İl değiştiğinde ilçeleri yükle\r\n     $('#illegal_cari_il').on('change', function() {\r\n         var il_id = $(this).val();\r\n         if(il_id) {\r\n"
                }
            ],
            "date": 1759159922556,
            "name": "Commit-0",
            "content": "<!DOCTYPE html>\r\n<html lang=\"tr\">\r\n<head>\r\n    <title>İllegal Tespit Oluştur | İlekaSoft CRM</title>\r\n    <link rel=\"icon\" type=\"image/png\" href=\"/assets/favicon.png\">\r\n    <?php $this->load->view(\"include/head-tags\"); ?>\r\n    <link rel=\"icon\" type=\"image/x-icon\" href=\"<?= base_url('assets/favicon.ico'); ?>\" />\r\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css\"\r\n          integrity=\"sha512-vKMx8UnXk60zUwyUnUPM3HbQo8QfmNx7+ltw8Pm5zLusl1XIfwcxo8DbWCqMGKaWeNxWA8yrx5v3SaVpMvR3CA==\"\r\n          crossorigin=\"anonymous\" referrerpolicy=\"no-referrer\"/>\r\n    <style>\r\n        .form-container {\r\n            background: #fff;\r\n            padding: 30px;\r\n            border-radius: 10px;\r\n            box-shadow: 0 0 20px rgba(0,0,0,0.1);\r\n            margin-bottom: 30px;\r\n        }\r\n        .form-title {\r\n            color: #2c3e50;\r\n            font-size: 24px;\r\n            font-weight: 600;\r\n            margin-bottom: 30px;\r\n            text-align: center;\r\n            border-bottom: 2px solid #e74c3c;\r\n            padding-bottom: 15px;\r\n        }\r\n        .btn-submit {\r\n            background: linear-gradient(45deg, #e74c3c, #c0392b);\r\n            border: none;\r\n            padding: 12px 40px;\r\n            color: white;\r\n            font-weight: 600;\r\n            border-radius: 25px;\r\n            transition: all 0.3s ease;\r\n        }\r\n        .btn-submit:hover {\r\n            background: linear-gradient(45deg, #c0392b, #a93226);\r\n            transform: translateY(-2px);\r\n            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4);\r\n        }\r\n        .form-group label {\r\n            font-weight: 600;\r\n            color: #2c3e50;\r\n            margin-bottom: 8px;\r\n        }\r\n        .form-control {\r\n            border: 2px solid #ecf0f1;\r\n            border-radius: 8px;\r\n            padding: 12px;\r\n            transition: all 0.3s ease;\r\n        }\r\n        .form-control:focus {\r\n            border-color: #e74c3c;\r\n            box-shadow: 0 0 0 0.2rem rgba(231, 76, 60, 0.25);\r\n        }\r\n        .alert-info {\r\n            background-color: #d5f2ff;\r\n            border-color: #bee5eb;\r\n            color: #0c5460;\r\n            border-radius: 10px;\r\n        }\r\n        .country-select {\r\n            background-image: url('data:image/svg+xml;charset=US-ASCII,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 4 5\"><path fill=\"%23666\" d=\"M2 0L0 2h4zm0 5L0 3h4z\"/></svg>');\r\n            background-repeat: no-repeat;\r\n            background-position: right 12px center;\r\n            background-size: 12px;\r\n        }\r\n        .success-message {\r\n            display: none;\r\n            background: linear-gradient(45deg, #27ae60, #2ecc71);\r\n            color: white;\r\n            padding: 20px;\r\n            border-radius: 10px;\r\n            margin-top: 20px;\r\n            text-align: center;\r\n            font-weight: 600;\r\n        }\r\n    </style>\r\n</head>\r\n<body>\r\n<?php\r\n$firmaID = getirFirma();\r\n$firma_ID = $firmaID->ayarlar_id;\r\n?>\r\n\r\n<div class=\"main-wrapper\">\r\n    <?php $this->load->view(\"include/header\"); ?>\r\n    <?php $this->load->view(\"include/sidebar\"); ?>\r\n    <div class=\"page-wrapper\">\r\n        <div class=\"content container-fluid\">\r\n            <!-- Page Header -->\r\n            <div class=\"page-header\">\r\n                <div class=\"row\">\r\n                    <div class=\"col-sm-10\">\r\n                        <h3 class=\"page-title\">İllegal Tespit</h3>\r\n                        <ul class=\"breadcrumb\">\r\n                            <li class=\"breadcrumb-item\"><a href=\"<?= base_url(); ?>\">Anasayfa</a></li>\r\n                            <li class=\"breadcrumb-item\">İllegal</li>\r\n                            <li class=\"breadcrumb-item active\">İllegal Tespit Oluştur</li>\r\n                        </ul>\r\n                    </div>\r\n                    <div class=\"d-flex justify-content-end text-align-center col-sm-2\">\r\n                        <a class=\"btn btn-outline-light\" href=\"javascript:history.back()\"><i class=\"fa fa-history\"></i> <br>Önceki Sayfa</a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <!-- /Page Header -->\r\n\r\n            <div class=\"row\">\r\n                <div class=\"col-12\">\r\n                    <div class=\"form-container\">\r\n                        <h2 class=\"form-title\">\r\n                            <i class=\"fa fa-plus-circle\"></i> İllegal Tespit Oluştur\r\n                        </h2>\r\n                        \r\n                        <div class=\"alert alert-info\">\r\n                            <i class=\"fa fa-info-circle\"></i> \r\n                            <strong>Bilgi:</strong> Bu form ile yeni bir illegal cari kaydı oluşturabilirsiniz. Tüm alanları doğru şekilde doldurunuz.\r\n                        </div>\r\n\r\n                        <form id=\"illegalCariForm\" method=\"post\">\r\n                            <div class=\"row\">\r\n                                <div class=\"col-md-6\">\r\n                                    <div class=\"form-group\">\r\n                                        <label for=\"illegal_cari_isletme_adi\">\r\n                                            <i class=\"fa fa-building\"></i> İşletme Adı\r\n                                        </label>\r\n                                        <input type=\"text\" class=\"form-control\" id=\"illegal_cari_isletme_adi\" \r\n                                               name=\"illegal_cari_isletme_adi\" placeholder=\"İşletme adını giriniz...\">\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"col-md-3\">\r\n                                    <div class=\"form-group\">\r\n                                        <label for=\"illegal_cari_ad\">\r\n                                            <i class=\"fa fa-user\"></i> Adı <span class=\"text-danger\">*</span>\r\n                                        </label>\r\n                                        <input type=\"text\" class=\"form-control\" id=\"illegal_cari_ad\" \r\n                                               name=\"illegal_cari_ad\" placeholder=\"Adını giriniz...\" required>\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"col-md-3\">\r\n                                    <div class=\"form-group\">\r\n                                        <label for=\"illegal_cari_soyad\">\r\n                                            <i class=\"fa fa-user\"></i> Soyadı <span class=\"text-danger\">*</span>\r\n                                        </label>\r\n                                        <input type=\"text\" class=\"form-control\" id=\"illegal_cari_soyad\" \r\n                                               name=\"illegal_cari_soyad\" placeholder=\"Soyadını giriniz...\" required>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div class=\"row\">\r\n                                <div class=\"col-md-2\">\r\n                                    <div class=\"form-group\">\r\n                                        <label for=\"illegal_cari_ulke\">\r\n                                            <i class=\"fa fa-globe\"></i> Ülke\r\n                                        </label>\r\n                                        <select class=\"form-control country-select\" id=\"illegal_cari_ulke\" name=\"illegal_cari_ulke\">\r\n                                            <option value=\"TR\" selected>Türkiye</option>\r\n                                            <option value=\"US\">Amerika Birleşik Devletleri</option>\r\n                                            <option value=\"DE\">Almanya</option>\r\n                                            <option value=\"FR\">Fransa</option>\r\n                                            <option value=\"GB\">İngiltere</option>\r\n                                            <option value=\"IT\">İtalya</option>\r\n                                            <option value=\"ES\">İspanya</option>\r\n                                            <option value=\"NL\">Hollanda</option>\r\n                                            <option value=\"BE\">Belçika</option>\r\n                                            <option value=\"CH\">İsviçre</option>\r\n                                            <option value=\"AT\">Avusturya</option>\r\n                                            <option value=\"SE\">İsveç</option>\r\n                                            <option value=\"NO\">Norveç</option>\r\n                                            <option value=\"DK\">Danimarka</option>\r\n                                            <option value=\"FI\">Finlandiya</option>\r\n                                        </select>\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"col-md-3\">\r\n                                    <div class=\"form-group\">\r\n                                        <label for=\"illegal_cari_il\">\r\n                                            <i class=\"fa fa-map-marker\"></i> İl\r\n                                        </label>\r\n                                        <select class=\"form-control\" id=\"illegal_cari_il\" name=\"illegal_cari_il\">\r\n                                            <option value=\"\">İl Seçiniz</option>\r\n                                        </select>\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"col-md-3\">\r\n                                    <div class=\"form-group\">\r\n                                        <label for=\"illegal_cari_ilce\">\r\n                                            <i class=\"fa fa-map-marker\"></i> İlçe\r\n                                        </label>\r\n                                        <select class=\"form-control\" id=\"illegal_cari_ilce\" name=\"illegal_cari_ilce\" disabled>\r\n                                            <option value=\"\">Önce il seçiniz</option>\r\n                                        </select>\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"col-md-4\">\r\n                                    <div class=\"form-group\">\r\n                                        <label for=\"illegal_cari_durum\">\r\n                                            <i class=\"fa fa-toggle-on\"></i> Durum\r\n                                        </label>\r\n                                        <select class=\"form-control\" id=\"illegal_cari_durum\" name=\"illegal_cari_durum\">\r\n                                            <option value=\"1\" selected>Aktif</option>\r\n                                            <option value=\"0\">Pasif</option>\r\n                                        </select>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div class=\"row mt-4\">\r\n                                <div class=\"col-12 text-center\">\r\n                                    <button type=\"submit\" class=\"btn btn-submit\">\r\n                                        <i class=\"fa fa-save\"></i> İllegal Cari Kaydet\r\n                                    </button>\r\n                                    <button type=\"reset\" class=\"btn btn-secondary ml-3\">\r\n                                        <i class=\"fa fa-refresh\"></i> Formu Temizle\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div class=\"success-message\" id=\"successMessage\">\r\n                                <i class=\"fa fa-check-circle fa-2x\"></i>\r\n                                <div class=\"mt-2\">İllegal cari başarıyla kaydedildi!</div>\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<?php $this->load->view(\"include/footer-js\"); ?>\r\n\r\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js\" \r\n        integrity=\"sha512-VEd+nq25CkR676O+pLBnDW09R7VQX9Mdiij052gVCp5yVH3jGtH70Ho/UUv4mJDsEdTvqRCFZg0NKGiojGnUCw==\" \r\n        crossorigin=\"anonymous\" referrerpolicy=\"no-referrer\"></script>\r\n\r\n<script>\r\n$(document).ready(function() {\r\n    // İlleri yükle\r\n    loadIller();\r\n    \r\n    function loadIller() {\r\n        $.ajax({\r\n            url: '<?= base_url(\"home/get_iller\") ?>',\r\n            type: 'POST',\r\n            dataType: 'json',\r\n            success: function(result) {\r\n                if(result && result.status !== 'error') {\r\n                    var options = '<option value=\"\">İl Seçiniz</option>';\r\n                    $.each(result.data, function(i, il) {\r\n                        options += '<option value=\"'+il.id+'\">'+il.il+'</option>';\r\n                    });\r\n                    $('#illegal_cari_il').html(options);\r\n                } else {\r\n                    $('#illegal_cari_il').html('<option value=\"\">İl yüklenemedi</option>');\r\n                }\r\n            },\r\n            error: function() {\r\n                $('#illegal_cari_il').html('<option value=\"\">Hata oluştu</option>');\r\n            }\r\n        });\r\n    }\r\n\r\n    // İl değiştiğinde ilçeleri yükle\r\n    $('#illegal_cari_il').on('change', function() {\r\n        var il_id = $(this).val();\r\n        if(il_id) {\r\n            $('#illegal_cari_ilce').prop('disabled', false);\r\n            $('#illegal_cari_ilce').html('<option>Yükleniyor...</option>');\r\n            $.ajax({\r\n                url: '<?= base_url(\"home/get_ilceler\") ?>',\r\n                type: 'POST',\r\n                data: {il_id: il_id},\r\n                dataType: 'json',\r\n                success: function(result) {\r\n                    if(result && result.status !== 'error') {\r\n                        var options = '<option value=\"\">İlçe Seçiniz</option>';\r\n                        $.each(result.data, function(i, ilce) {\r\n                            options += '<option value=\"'+ilce.id+'\">'+ilce.ilce+'</option>';\r\n                        });\r\n                        $('#illegal_cari_ilce').html(options);\r\n                    } else {\r\n                        $('#illegal_cari_ilce').html('<option value=\"\">İlçe bulunamadı</option>');\r\n                    }\r\n                },\r\n                error: function() {\r\n                    $('#illegal_cari_ilce').html('<option value=\"\">Hata oluştu</option>');\r\n                }\r\n            });\r\n        } else {\r\n            $('#illegal_cari_ilce').prop('disabled', true).html('<option value=\"\">Önce il seçiniz</option>');\r\n        }\r\n    });\r\n\r\n    // Form gönderimi\r\n    $('#illegalCariForm').on('submit', function(e) {\r\n        e.preventDefault();\r\n        \r\n        // Gerekli alanları kontrol et\r\n        var ad = $('#illegal_cari_ad').val().trim();\r\n        var soyad = $('#illegal_cari_soyad').val().trim();\r\n        \r\n        if (!ad || !soyad) {\r\n            toastr.error('Ad ve Soyad alanları zorunludur!');\r\n            return;\r\n        }\r\n\r\n        // Submit butonunu devre dışı bırak\r\n        var submitBtn = $(this).find('button[type=\"submit\"]');\r\n        var originalText = submitBtn.html();\r\n        submitBtn.prop('disabled', true).html('<i class=\"fa fa-spinner fa-spin\"></i> Kaydediliyor...');\r\n\r\n        // AJAX ile form gönder\r\n        $.ajax({\r\n            url: '<?= base_url(\"illegal/illegal_cari_kaydet\") ?>',\r\n            type: 'POST',\r\n            data: {\r\n                illegal_cari_isletme_adi: $('#illegal_cari_isletme_adi').val(),\r\n                illegal_cari_ad: $('#illegal_cari_ad').val(),\r\n                illegal_cari_soyad: $('#illegal_cari_soyad').val(),\r\n                illegal_cari_ulke: $('#illegal_cari_ulke').val(),\r\n                illegal_cari_il: $('#illegal_cari_il').val(),\r\n                illegal_cari_ilce: $('#illegal_cari_ilce').val(),\r\n                illegal_cari_durum: $('#illegal_cari_durum').val()\r\n            },\r\n            dataType: 'json',\r\n            success: function(response) {\r\n                submitBtn.prop('disabled', false).html(originalText);\r\n                \r\n                if (response.status === 'success') {\r\n                    $('#successMessage').fadeIn();\r\n                    toastr.success('İllegal cari başarıyla kaydedildi!');\r\n                    $('#illegalCariForm')[0].reset();\r\n                    $('#illegal_cari_ilce').prop('disabled', true).html('<option value=\"\">Önce il seçiniz</option>');\r\n                    \r\n                    setTimeout(function() {\r\n                        $('#successMessage').fadeOut();\r\n                    }, 3000);\r\n                } else {\r\n                    toastr.error(response.message || 'Kayıt sırasında hata oluştu!');\r\n                }\r\n            },\r\n            error: function() {\r\n                submitBtn.prop('disabled', false).html(originalText);\r\n                toastr.error('Sunucu hatası oluştu!');\r\n            }\r\n        });\r\n    });\r\n\r\n    // Form temizleme\r\n    $('button[type=\"reset\"]').on('click', function() {\r\n        $('#successMessage').hide();\r\n        $('#illegal_cari_ilce').prop('disabled', true).html('<option value=\"\">Önce il seçiniz</option>');\r\n        toastr.info('Form temizlendi');\r\n    });\r\n});\r\n</script>\r\n\r\n</body>\r\n</html>"
        }
    ]
}