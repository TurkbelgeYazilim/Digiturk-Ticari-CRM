{
    "sourceFile": "application/views/tahsilat/tahsilat-listesi.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1756213124134,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1756214554950,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -928,9 +928,9 @@\n \r\n \t\t\t\t\t\t\t\t\t\t\t<td>\r\n \r\n \t\t\t\t\t\t\t\t\t\t\t\t<div class=\"btn-group\" role=\"group\">\r\n-\r\n+\t\t\t\t\t\t\t\t\t\t\t\t\t<?php if (grup_modul_yetkisi_var(511, 3)): ?>\r\n \t\t\t\t\t\t\t\t\t\t\t\t\t<button type=\"button\"\r\n \r\n \t\t\t\t\t\t\t\t\t\t\t\t\t    class=\"btn btn-sm btn-outline-warning tahsilat-edit-btn\"\r\n \r\n@@ -1004,9 +1004,9 @@\n \r\n \t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-edit\"></i>\r\n \r\n \t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n-\r\n+\t\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n \t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n \r\n \t\t\t\t\t\t\t\t\t\t\t</td>\r\n \r\n"
                }
            ],
            "date": 1756213124134,
            "name": "Commit-0",
            "content": "<!DOCTYPE html>\r\n\r\n<html lang=\"tr\">\r\n\r\n<head>\r\n\r\n\t<?php $this->load->view(\"include/head-tags\"); ?>\r\n\r\n\t<title>Tahsilat Listesi | İlekaSoft CRM</title>\r\n\r\n\t<link rel=\"icon\" type=\"image/x-icon\" href=\"<?= base_url('assets/favicon.ico'); ?>\" />\r\n\r\n\t<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/datatables.net-bs4@1.13.6/css/dataTables.bootstrap4.min.css\"/>\r\n\r\n\t\r\n\r\n\t<style>\r\n\r\n\t\t.tahsilat-onay-bekleyen {\r\n\r\n\t\t\tbackground-color: #fff3cd;\r\n\r\n\t\t\tborder-left: 4px solid #ffc107;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.tahsilat-onaylanan {\r\n\r\n\t\t\tbackground-color: #d4edda;\r\n\r\n\t\t\tborder-left: 4px solid #28a745;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.tahsilat-reddedilen {\r\n\r\n\t\t\tbackground-color: #f8d7da;\r\n\r\n\t\t\tborder-left: 4px solid #dc3545;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.tutar-buyuk {\r\n\r\n\t\t\tfont-size: 1.2em;\r\n\r\n\t\t\tfont-weight: bold;\r\n\r\n\t\t\tcolor: #28a745;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.card-stats {\r\n\r\n\t\t\tbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n\r\n\t\t\tcolor: white;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.card-stats.card-warning {\r\n\r\n\t\t\tbackground: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.card-stats.card-success {\r\n\r\n\t\t\tbackground: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.card-stats.card-danger {\r\n\r\n\t\t\tbackground: linear-gradient(135deg, #fa709a 0%, #fee140 100%);\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.card-stats .card-body {\r\n\r\n\t\t\tpadding: 1.5rem;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.stats-number {\r\n\r\n\t\t\tfont-size: 2rem;\r\n\r\n\t\t\tfont-weight: bold;\r\n\r\n\t\t\tmargin-bottom: 0.5rem;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.stats-label {\r\n\r\n\t\t\tfont-size: 0.9rem;\r\n\r\n\t\t\topacity: 0.9;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.cek-detaylari {\r\n\r\n\t\t\tbackground-color: #f8f9fa;\r\n\r\n\t\t\tborder: 1px solid #e9ecef;\r\n\r\n\t\t\tborder-radius: 4px;\r\n\r\n\t\t\tpadding: 8px;\r\n\r\n\t\t\tmargin: 2px 0;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.cek-detaylari small {\r\n\r\n\t\t\tmargin-bottom: 2px;\r\n\r\n\t\t\tcolor: #495057;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.cek-detaylari .badge {\r\n\r\n\t\t\tfont-size: 0.75em;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.banka-detaylari {\r\n\r\n\t\t\tbackground-color: #e8f4fd;\r\n\r\n\t\t\tborder: 1px solid #bee5eb;\r\n\r\n\t\t\tborder-radius: 4px;\r\n\r\n\t\t\tpadding: 8px;\r\n\r\n\t\t\tmargin: 2px 0;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.banka-detaylari small {\r\n\r\n\t\t\tmargin-bottom: 2px;\r\n\r\n\t\t\tcolor: #055160;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.banka-detaylari .badge {\r\n\r\n\t\t\tfont-size: 0.75em;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.kasa-detaylari {\r\n\r\n\t\t\tbackground-color: #fff3cd;\r\n\r\n\t\t\tborder: 1px solid #ffeaa7;\r\n\r\n\t\t\tborder-radius: 4px;\r\n\r\n\t\t\tpadding: 8px;\r\n\r\n\t\t\tmargin: 2px 0;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.kasa-detaylari small {\r\n\r\n\t\t\tmargin-bottom: 2px;\r\n\r\n\t\t\tcolor: #856404;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.kasa-detaylari .badge {\r\n\r\n\t\t\tfont-size: 0.75em;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.senet-detaylari {\r\n\r\n\t\t\tbackground-color: #e8f5e8;\r\n\r\n\t\t\tborder: 1px solid #c3e6c3;\r\n\r\n\t\t\tborder-radius: 4px;\r\n\r\n\t\t\tpadding: 8px;\r\n\r\n\t\t\tmargin: 2px 0;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.senet-detaylari small {\r\n\r\n\t\t\tmargin-bottom: 2px;\r\n\r\n\t\t\tcolor: #155724;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.senet-detaylari .badge {\r\n\r\n\t\t\tfont-size: 0.75em;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t@media (max-width: 768px) {\r\n\r\n\t\t\t.table-responsive {\r\n\r\n\t\t\t\tfont-size: 0.875rem;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t\r\n\r\n\t\t\t.btn-group .btn {\r\n\r\n\t\t\t\tpadding: 0.25rem 0.5rem;\r\n\r\n\t\t\t\tfont-size: 0.8rem;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t\r\n\r\n\t\t\t.cek-detaylari {\r\n\r\n\t\t\t\tpadding: 4px;\r\n\r\n\t\t\t\tfont-size: 0.8rem;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t\r\n\r\n\t\t\t.banka-detaylari {\r\n\r\n\t\t\t\tpadding: 4px;\r\n\r\n\t\t\t\tfont-size: 0.8rem;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t\r\n\r\n\t\t\t.kasa-detaylari {\r\n\r\n\t\t\t\tpadding: 4px;\r\n\r\n\t\t\t\tfont-size: 0.8rem;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t\r\n\r\n\t\t\t.senet-detaylari {\r\n\r\n\t\t\t\tpadding: 4px;\r\n\r\n\t\t\t\tfont-size: 0.8rem;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t</style>\r\n\r\n</head>\r\n\r\n<body>\r\n\r\n<div class=\"main-wrapper\">\r\n\r\n\t<?php $this->load->view(\"include/header\"); ?>\r\n\r\n\t<?php $this->load->view(\"include/sidebar\"); ?>\r\n\r\n\t<div class=\"page-wrapper\">\r\n\r\n\t\t<div class=\"content container-fluid\">\r\n\r\n\t\t\t<!-- Page Header -->\r\n\r\n\t\t\t<div class=\"page-header\">\r\n\r\n\t\t\t\t<div class=\"row\">\r\n\r\n\t\t\t\t\t<div class=\"col-sm-10\">\r\n\r\n\t\t\t\t\t\t<h3 class=\"page-title\">Tahsilat Listesi</h3>\r\n\r\n\t\t\t\t\t\t<ul class=\"breadcrumb\">\r\n\r\n\t\t\t\t\t\t\t<li class=\"breadcrumb-item\"><a href=\"<?= base_url(); ?>\">Anasayfa</a></li>\r\n\r\n\t\t\t\t\t\t\t<li class=\"breadcrumb-item\">Tahsilat</li>\r\n\r\n\t\t\t\t\t\t\t<li class=\"breadcrumb-item active\">Tahsilat Listesi</li>\r\n\r\n\t\t\t\t\t\t</ul>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"d-flex justify-content-end text-align-center col-sm-2\">\r\n\r\n\t\t\t\t\t\t<a class=\"btn btn-outline-light\" href=\"javascript:history.back()\">\r\n\r\n\t\t\t\t\t\t\t<i class=\"fa fa-history\"></i> <br>Önceki Sayfa\r\n\r\n\t\t\t\t\t\t</a>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t\t<!-- /Page Header -->\r\n\r\n\r\n\r\n\t\t\t<!-- İstatistikler -->\r\n\r\n\t\t\t<div class=\"row mb-4\">\r\n\r\n\t\t\t\t<div class=\"col-xl-3 col-sm-6 col-12\">\r\n\r\n\t\t\t\t\t<div class=\"card card-stats\">\r\n\r\n\t\t\t\t\t\t<div class=\"card-body\">\r\n\r\n\t\t\t\t\t\t\t<div class=\"stats-number\">\r\n\r\n\t\t\t\t\t\t\t\t<?= isset($toplam_adet) ? $toplam_adet : count($tahsilatlar) ?>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div class=\"stats-label\">\r\n\r\n\t\t\t\t\t\t\t\t<i class=\"fa fa-list mr-2\"></i>Toplam Tahsilat Sayısı\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"col-xl-3 col-sm-6 col-12\">\r\n\r\n\t\t\t\t\t<div class=\"card card-stats card-warning\">\r\n\r\n\t\t\t\t\t\t<div class=\"card-body\">\r\n\r\n\t\t\t\t\t\t\t<div class=\"stats-number\">\r\n\r\n\t\t\t\t\t\t\t\t<?= isset($onay_bekleyen_adet) ? $onay_bekleyen_adet : 0 ?>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div class=\"stats-label\">\r\n\r\n\t\t\t\t\t\t\t\t<i class=\"fa fa-clock-o mr-2\"></i>Onay Bekleyen\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"col-xl-3 col-sm-6 col-12\">\r\n\r\n\t\t\t\t\t<div class=\"card card-stats card-success\">\r\n\r\n\t\t\t\t\t\t<div class=\"card-body\">\r\n\r\n\t\t\t\t\t\t\t<div class=\"stats-number\">\r\n\r\n\t\t\t\t\t\t\t\t<?= isset($onaylanan_adet) ? $onaylanan_adet : 0 ?>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div class=\"stats-label\">\r\n\r\n\t\t\t\t\t\t\t\t<i class=\"fa fa-check mr-2\"></i>Onaylanan\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"col-xl-3 col-sm-6 col-12\">\r\n\r\n\t\t\t\t\t<div class=\"card card-stats card-danger\">\r\n\r\n\t\t\t\t\t\t<div class=\"card-body\">\r\n\r\n\t\t\t\t\t\t\t<div class=\"stats-number\">\r\n\r\n\t\t\t\t\t\t\t\t<?= isset($reddedilen_adet) ? $reddedilen_adet : 0 ?>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div class=\"stats-label\">\r\n\r\n\t\t\t\t\t\t\t\t<i class=\"fa fa-times mr-2\"></i>Reddedilen\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\r\n\r\n\r\n\r\n\t\t\t<!-- Toplam Tutar -->\r\n\r\n\t\t\t<div class=\"row mb-4\">\r\n\r\n\t\t\t\t<div class=\"col-12\">\r\n\r\n\t\t\t\t\t<div class=\"card\">\r\n\r\n\t\t\t\t\t\t<div class=\"card-body text-center\">\r\n\r\n\t\t\t\t\t\t\t<h4 class=\"card-title\">Toplam Tahsilat Tutarı</h4>\r\n\r\n\t\t\t\t\t\t\t<h2 class=\"text-success\">\r\n\r\n\t\t\t\t\t\t\t\t<i class=\"fa fa-money mr-2\"></i>\r\n\r\n\t\t\t\t\t\t\t\t<?= number_format($toplam_tutar, 2, ',', '.') ?> ₺\r\n\r\n\t\t\t\t\t\t\t</h2>\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\r\n\r\n\r\n\r\n\t\t\t<!-- Tahsilatlar Listesi -->\r\n\r\n\t\t\t<div class=\"row\">\r\n\r\n\t\t\t\t<div class=\"col-xl-12 col-md-12\">\r\n\r\n\t\t\t\t\t<div class=\"card card-table\">\r\n\r\n\t\t\t\t\t\t<div class=\"card-header\">\r\n\r\n\t\t\t\t\t\t\t<div class=\"row\">\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"col\">\r\n\r\n\t\t\t\t\t\t\t\t\t<h4 class=\"card-title\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-list text-primary mr-2\"></i>\r\n\r\n\t\t\t\t\t\t\t\t\t\tTahsilatlarım\r\n\r\n\t\t\t\t\t\t\t\t\t</h4>\r\n\r\n\t\t\t\t\t\t\t\t\t<p class=\"text-muted mb-0\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t<small>Sadece sizin oluşturduğunuz tahsilatlar listelenmektedir</small>\r\n\r\n\t\t\t\t\t\t\t\t\t</p>\r\n\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"col-auto\">\r\n\r\n\t\t\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-primary btn-sm\" onclick=\"location.reload()\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-refresh\"></i> Yenile\r\n\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\r\n\r\n\t\t\t\t\t\t<?php if (isset($error_message)): ?>\r\n\r\n\t\t\t\t\t\t\t<div class=\"alert alert-warning\">\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"row\">\r\n\r\n\t\t\t\t\t\t\t\t\t<div class=\"col-md-2 text-center\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-database\" style=\"font-size: 3rem; color: #ffc107;\"></i>\r\n\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t<div class=\"col-md-10\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t<h5><i class=\"fa fa-exclamation-triangle mr-2\"></i>Veritabanı Kurulum Gerekli</h5>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<p><?= $error_message ?></p>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"mt-3\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<p><strong>Kurulum Adımları:</strong></p>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<ol>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<li>MySQL/phpMyAdmin'e giriş yapın</li>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<li><code>muhase_database_setup.sql</code> dosyasını çalıştırın</li>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<li>Bu sayfayı yenileyin</li>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</ol>\r\n\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<?php elseif (isset($tahsilatlar) && count($tahsilatlar) > 0): ?>\r\n\r\n\t\t\t\t\t\t\t<div class=\"table-responsive\">\r\n\r\n\t\t\t\t\t\t\t\t<table class=\"table table-striped custom-table mb-0\" id=\"tahsilatlarTable\">\r\n\r\n\t\t\t\t\t\t\t\t\t<thead>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<tr>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<th>ID</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<th>Tahsilat Tipi</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<th>Müşteri Adı</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<th>Tutar</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<th>Detaylar</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<th>İşlem Tarihi</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<th>Görsel</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<th>Açıklama</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<th>İşlemler</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t</tr>\r\n\r\n\t\t\t\t\t\t\t\t\t</thead>\r\n\r\n\t\t\t\t\t\t\t\t\t<tbody>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<?php foreach($tahsilatlar as $tahsilat): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<tr class=\"<?php \r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif($tahsilat->durum == 1) echo 'tahsilat-onay-bekleyen';\r\n\r\n\t\t\t\t\t\t\t\t\t\t\telseif($tahsilat->durum == 2) echo 'tahsilat-onaylanan';\r\n\r\n\t\t\t\t\t\t\t\t\t\t\telseif($tahsilat->durum == 3) echo 'tahsilat-reddedilen';\r\n\r\n\t\t\t\t\t\t\t\t\t\t?>\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td><strong>#<?= $tahsilat->id ?></strong></td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t$icon = '';\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t$class = '';\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tswitch($tahsilat->tahsilat_tipi_adi) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase 'Banka': $icon = 'fa-university'; $class = 'text-primary'; break;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase 'Çek': $icon = 'fa-file-text-o'; $class = 'text-info'; break;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase 'Kasa': $icon = 'fa-money'; $class = 'text-success'; break;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase 'Senet': $icon = 'fa-file-o'; $class = 'text-warning'; break;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdefault: $icon = 'fa-question'; $class = 'text-muted'; break;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fa <?= $icon ?> <?= $class ?> mr-2\"></i>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"<?= $class ?>\"><?= $tahsilat->tahsilat_tipi_adi ?></span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<strong title=\"<?= htmlspecialchars($tahsilat->musteri_adi ?: 'Bilinmiyor') ?>\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?= $tahsilat->musteri_adi ? (mb_strlen($tahsilat->musteri_adi) > 30 ? mb_substr($tahsilat->musteri_adi, 0, 30) . '...' : $tahsilat->musteri_adi) : 'Bilinmiyor' ?>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</strong>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"tutar-buyuk\"><?= $tahsilat->tutar ? number_format($tahsilat->tutar, 2, ',', '.') . ' ₺' : '-' ?></span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->tahsilat_tipi_adi == 'Banka' && isset($tahsilat->banka_belge_no)): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"banka-detaylari\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->banka_adi): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<small class=\"d-block\"><strong>Banka:</strong> <?= $tahsilat->banka_adi ?></small>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->banka_hesap_no): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<small class=\"d-block\"><strong>Hesap No:</strong> <?= $tahsilat->banka_hesap_no ?></small>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->banka_belge_no): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<small class=\"d-block\"><strong>Belge No:</strong> <?= $tahsilat->banka_belge_no ?></small>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->banka_tarih): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<small class=\"d-block\"><strong>İşlem Tarihi:</strong> <?= date('d.m.Y', strtotime($tahsilat->banka_tarih)) ?></small>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->banka_aciklama): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<small class=\"d-block\"><strong>Açıklama:</strong> <?= substr($tahsilat->banka_aciklama, 0, 50) ?><?= strlen($tahsilat->banka_aciklama) > 50 ? '...' : '' ?></small>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php elseif($tahsilat->tahsilat_tipi_adi == 'Kasa' && isset($tahsilat->kasa_belge_no)): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"kasa-detaylari\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->kasa_adi): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<small class=\"d-block\"><strong>Kasa:</strong> <?= $tahsilat->kasa_adi ?></small>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->kasa_kodu): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<small class=\"d-block\"><strong>Kasa Kodu:</strong> <?= $tahsilat->kasa_kodu ?></small>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->kasa_belge_no): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<small class=\"d-block\"><strong>Belge No:</strong> <?= $tahsilat->kasa_belge_no ?></small>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->kasa_tarih): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<small class=\"d-block\"><strong>İşlem Tarihi:</strong> <?= date('d.m.Y', strtotime($tahsilat->kasa_tarih)) ?></small>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->kasa_aciklama && !strpos($tahsilat->kasa_aciklama, 'Açılış Bakiyesi')): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<small class=\"d-block\"><strong>Açıklama:</strong> <?= substr($tahsilat->kasa_aciklama, 0, 50) ?><?= strlen($tahsilat->kasa_aciklama) > 50 ? '...' : '' ?></small>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php elseif($tahsilat->tahsilat_tipi_adi == 'Çek' && isset($tahsilat->cek_seri_no)): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"cek-detaylari\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->cek_seri_no): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<small class=\"d-block\"><strong>Seri No:</strong> <?= $tahsilat->cek_seri_no ?></small>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->cek_vade_tarih): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<small class=\"d-block\"><strong>Vade:</strong> <?= date('d.m.Y', strtotime($tahsilat->cek_vade_tarih)) ?></small>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->cek_portfoy_no): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<small class=\"d-block\"><strong>Portföy:</strong> <?= $tahsilat->cek_portfoy_no ?></small>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php if(isset($tahsilat->cek_durum)): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<small class=\"d-block\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<strong>Çek Durumu:</strong> \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"badge badge-<?= $tahsilat->cek_durum == 1 ? 'success' : ($tahsilat->cek_durum == 0 ? 'warning' : 'danger') ?>\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?= $tahsilat->cek_durum == 1 ? 'Tahsil Edildi' : ($tahsilat->cek_durum == 0 ? 'Beklemede' : 'İade') ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</small>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php elseif($tahsilat->tahsilat_tipi_adi == 'Senet' && isset($tahsilat->senet_seri_no)): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"senet-detaylari\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->senet_seri_no): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<small class=\"d-block\"><strong>Seri No:</strong> <?= $tahsilat->senet_seri_no ?></small>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->senet_vade_tarih): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<small class=\"d-block\"><strong>Vade:</strong> <?= date('d.m.Y', strtotime($tahsilat->senet_vade_tarih)) ?></small>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->senet_portfoy_no): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<small class=\"d-block\"><strong>Portföy:</strong> <?= $tahsilat->senet_portfoy_no ?></small>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php if(isset($tahsilat->senet_durum)): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<small class=\"d-block\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<strong>Senet Durumu:</strong> \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"badge badge-<?= $tahsilat->senet_durum == 1 ? 'success' : ($tahsilat->senet_durum == 0 ? 'warning' : 'danger') ?>\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?= $tahsilat->senet_durum == 1 ? 'Tahsil Edildi' : ($tahsilat->senet_durum == 0 ? 'Beklemede' : 'İade') ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</small>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php else: ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-muted\">-</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->olusturma_tarihi): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<strong><?= date('d.m.Y', strtotime($tahsilat->olusturma_tarihi)) ?></strong>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><small class=\"text-muted\"><?= date('H:i', strtotime($tahsilat->olusturma_tarihi)) ?></small>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php else: ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-muted\">-</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->gorsel): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?php\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// Tahsilat tipine göre doğru klasör yolunu belirle\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$gorsel_url = '';\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif($tahsilat->tahsilat_tipi == 1) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$gorsel_url = base_url('assets/uploads/dekontlar/' . $tahsilat->gorsel);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} elseif($tahsilat->tahsilat_tipi == 2) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$gorsel_url = base_url('assets/uploads/cekler/' . $tahsilat->gorsel);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} elseif($tahsilat->tahsilat_tipi == 4) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$gorsel_url = base_url('assets/uploads/senetler/' . $tahsilat->gorsel);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$gorsel_url = base_url('assets/uploads/dekontlar/' . $tahsilat->gorsel);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-sm btn-outline-info\" \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonclick=\"window.open('<?= $gorsel_url ?>', '_blank')\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-image\"></i> Görsel\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php else: ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-muted\">-</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->aciklama): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?= substr($tahsilat->aciklama, 0, 30) ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?= strlen($tahsilat->aciklama) > 30 ? '...' : '' ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php else: ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-muted\">-</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"btn-group\" role=\"group\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<button type=\"button\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t    class=\"btn btn-sm btn-outline-warning tahsilat-edit-btn\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t    data-tip=\"<?= $tahsilat->tahsilat_tipi ?>\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t    data-id=\"<?= $tahsilat->kayit_id ?>\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t    data-tutar=\"<?= $tahsilat->tutar ?>\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t    data-aciklama=\"<?= htmlspecialchars($tahsilat->aciklama) ?>\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t    data-gorsel=\"<?= $tahsilat->gorsel ?>\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t    data-gorsel-url=\"<?php\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t    $gorsel_url = '';\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t    $gorsel_adi = '';\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t    \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t    // Görsel alanını kontrol et - JSON formatında olabilir\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t    if(!empty($tahsilat->gorsel)) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    $json_decoded = json_decode($tahsilat->gorsel, true);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    if(is_array($json_decoded) && !empty($json_decoded[0])) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    $gorsel_adi = $json_decoded[0];\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    } else {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    $gorsel_adi = $tahsilat->gorsel;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    }\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t    }\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t    \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t    // Görsel path'ini belirle\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t    if(!empty($gorsel_adi)) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    if($tahsilat->tahsilat_tipi == 1) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    $gorsel_url = base_url('assets/uploads/dekontlar/' . $gorsel_adi);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    } elseif($tahsilat->tahsilat_tipi == 2) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    $gorsel_url = base_url('assets/uploads/cekler/' . $gorsel_adi);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    } elseif($tahsilat->tahsilat_tipi == 4) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    $gorsel_url = base_url('assets/uploads/senetler/' . $gorsel_adi);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    } else {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    $gorsel_url = base_url('assets/uploads/dekontlar/' . $gorsel_adi);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t    }\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t    }\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t    echo $gorsel_url;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t    ?>\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-edit\"></i>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t</tr>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<?php endforeach; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t</tbody>\r\n\r\n\t\t\t\t\t\t\t\t</table>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<?php else: ?>\r\n\r\n\t\t\t\t\t\t\t<div class=\"text-center py-5\">\r\n\r\n\t\t\t\t\t\t\t\t<i class=\"fa fa-list text-muted\" style=\"font-size: 4rem; margin-bottom: 1rem;\"></i>\r\n\r\n\t\t\t\t\t\t\t\t<h4>Henüz tahsilat kaydınız bulunmuyor.</h4>\r\n\r\n\t\t\t\t\t\t\t\t<p class=\"text-muted\">İlk tahsilat kaydınızı oluşturmak için aşağıdaki butonu kullanabilirsiniz.</p>\r\n\r\n\t\t\t\t\t\t\t\t<a href=\"<?= base_url('tahsilat/tahsilat-olustur') ?>\" class=\"btn btn-primary\">\r\n\r\n\t\t\t\t\t\t\t\t\t<i class=\"fa fa-plus\"></i> Yeni Tahsilat Ekle\r\n\r\n\t\t\t\t\t\t\t\t</a>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t</div>\r\n\r\n\t</div>\r\n\r\n</div>\r\n\r\n\r\n\r\n<?php $this->load->view(\"include/footer-js\"); ?>\r\n\r\n\r\n\r\n<script src=\"https://cdn.jsdelivr.net/npm/datatables.net@1.13.6/js/jquery.dataTables.min.js\"></script>\r\n\r\n<script src=\"https://cdn.jsdelivr.net/npm/datatables.net-bs4@1.13.6/js/dataTables.bootstrap4.min.js\"></script>\r\n\r\n\r\n\r\n<script>\r\n\r\n$(document).ready(function() {\r\n\r\n\t// DataTable başlat\r\n\r\n\t$('#tahsilatlarTable').DataTable({\r\n\r\n\t\t\"language\": {\r\n\r\n\t\t\t\"url\": \"//cdn.datatables.net/plug-ins/1.13.6/i18n/tr.json\"\r\n\r\n\t\t},\r\n\r\n\t\t\"pageLength\": 25,\r\n\r\n\t\t\"order\": [[ 0, \"desc\" ]],\r\n\r\n\t\t\"columnDefs\": [\r\n\r\n\t\t\t{ \"orderable\": false, \"targets\": [4, 6, 8] } // Detaylar, Görsel ve İşlemler sütunları sıralanamaz\r\n\r\n\t\t]\r\n\r\n\t});\r\n\r\n});\r\n\r\n</script>\r\n\r\n\r\n\r\n<!-- Tahsilat Düzenle Modalı -->\r\n\r\n<div class=\"modal fade\" id=\"tahsilatEditModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"tahsilatEditModalLabel\" aria-hidden=\"true\">\r\n\r\n  <div class=\"modal-dialog\" role=\"document\">\r\n\r\n    <form id=\"tahsilatEditForm\" enctype=\"multipart/form-data\">\r\n\r\n      <div class=\"modal-content\">\r\n\r\n        <div class=\"modal-header\">\r\n\r\n          <h5 class=\"modal-title\" id=\"tahsilatEditModalLabel\">Tahsilat Düzenle</h5>\r\n\r\n          <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Kapat\">\r\n\r\n            <span aria-hidden=\"true\">&times;</span>\r\n\r\n          </button>\r\n\r\n        </div>\r\n\r\n        <div class=\"modal-body\">\r\n\r\n          <input type=\"hidden\" name=\"tip\" id=\"modal_tip\">\r\n\r\n          <input type=\"hidden\" name=\"id\" id=\"modal_id\">\r\n\r\n\r\n\r\n          <div class=\"form-group\">\r\n\r\n            <label for=\"modal_tutar\">Tutar</label>\r\n\r\n            <input type=\"number\" class=\"form-control\" name=\"tutar\" id=\"modal_tutar\" step=\"0.01\" required>\r\n\r\n          </div>\r\n\r\n          <div class=\"form-group\">\r\n\r\n            <label for=\"modal_aciklama\">Açıklama</label>\r\n\r\n            <textarea class=\"form-control\" name=\"aciklama\" id=\"modal_aciklama\"></textarea>\r\n\r\n          </div>\r\n\r\n          <div class=\"form-group\" id=\"modal_gorsel_preview_group\">\r\n\r\n            <label>Mevcut Görsel</label>\r\n\r\n            <div id=\"modal_gorsel_preview\"></div>\r\n\r\n          </div>\r\n\r\n          <div class=\"form-group\" id=\"modal_gorsel_upload_group\">\r\n\r\n            <label>Yeni Görsel Yükle (Sadece 1 dosya)</label>\r\n\r\n            <input type=\"file\" class=\"form-control\" name=\"gorsel\" id=\"modal_gorsel\" accept=\"image/*\">\r\n\r\n            <small class=\"form-text text-muted\">Kasa hareketleri için görsel yükleme desteklenmemektedir.</small>\r\n\r\n          </div>\r\n\r\n        </div>\r\n\r\n        <div class=\"modal-footer\">\r\n\r\n          <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">Kapat</button>\r\n\r\n          <button type=\"submit\" class=\"btn btn-primary\">Kaydet</button>\r\n\r\n        </div>\r\n\r\n      </div>\r\n\r\n    </form>\r\n\r\n  </div>\r\n\r\n</div>\r\n\r\n\r\n\r\n<script>\r\n\r\n$(document).on('click', '.tahsilat-edit-btn', function() {\r\n\r\n    var tip = $(this).data('tip');\r\n\r\n    $('#modal_tip').val(tip);\r\n\r\n    $('#modal_id').val($(this).data('id'));\r\n\r\n    $('#modal_tutar').val($(this).data('tutar'));\r\n\r\n    $('#modal_aciklama').val($(this).data('aciklama'));\r\n\r\n    var gorsel = $(this).data('gorsel');\r\n\r\n    var gorselUrl = $(this).data('gorsel-url');\r\n\r\n    \r\n\r\n    // Kasa tipi (tip=3) ise görsel alanlarını gizle\r\n\r\n    if(tip == 3) {\r\n\r\n        $('#modal_gorsel_preview_group').hide();\r\n\r\n        $('#modal_gorsel_upload_group').hide();\r\n\r\n    } else {\r\n\r\n        $('#modal_gorsel_preview_group').show();\r\n\r\n        $('#modal_gorsel_upload_group').show();\r\n\r\n        \r\n\r\n        // Görsel URL kontrolü - boş veya geçersiz URL'leri kontrol et\r\n\r\n        if (gorsel && gorselUrl && gorselUrl.trim() !== '' && !gorselUrl.includes('[') && !gorselUrl.includes(']')) {\r\n\r\n            $('#modal_gorsel_preview').html('<img src=\"'+gorselUrl+'\" style=\"max-width:150px;\" onerror=\"this.style.display=\\'none\\'; this.parentNode.innerHTML=\\'<span class=\\\\\\'text-muted\\\\\\'>Görsel yüklenemedi</span>\\';\">');\r\n\r\n        } else {\r\n\r\n            $('#modal_gorsel_preview').html('<span class=\"text-muted\">Görsel yok</span>');\r\n\r\n        }\r\n\r\n    }\r\n\r\n    \r\n\r\n    $('#modal_gorsel').val('');\r\n\r\n    $('#tahsilatEditModal').modal('show');\r\n\r\n});\r\n\r\n\r\n\r\n$('#tahsilatEditForm').on('submit', function(e) {\r\n\r\n    e.preventDefault();\r\n\r\n    \r\n\r\n    // Kasa tipi için görsel kontrolü\r\n\r\n    var tip = $('#modal_tip').val();\r\n\r\n    if(tip == 3 && $('#modal_gorsel')[0].files.length > 0) {\r\n\r\n        alert('Kasa hareketleri için görsel yükleme desteklenmemektedir!');\r\n\r\n        return false;\r\n\r\n    }\r\n\r\n    \r\n\r\n    var formData = new FormData(this);\r\n\r\n    \r\n\r\n    // Debug: FormData içeriğini kontrol et\r\n\r\n    console.log('Form verisi:');\r\n\r\n    for (var pair of formData.entries()) {\r\n\r\n        console.log(pair[0] + ': ', pair[1]);\r\n\r\n    }\r\n\r\n    \r\n\r\n    // Dosya bilgilerini özel olarak kontrol et\r\n\r\n    var fileInput = $('#modal_gorsel')[0];\r\n\r\n    if (fileInput.files.length > 0) {\r\n\r\n        console.log('Seçilen dosya:', fileInput.files[0]);\r\n\r\n        console.log('Dosya adı:', fileInput.files[0].name);\r\n\r\n        console.log('Dosya boyutu:', fileInput.files[0].size);\r\n\r\n        console.log('Dosya tipi:', fileInput.files[0].type);\r\n\r\n    } else {\r\n\r\n        console.log('Hiç dosya seçilmedi');\r\n\r\n    }\r\n\r\n    \r\n\r\n    $.ajax({\r\n\r\n        url: '<?= base_url('tahsilat/tahsilat_guncelle') ?>',\r\n\r\n        type: 'POST',\r\n\r\n        data: formData,\r\n\r\n        processData: false,\r\n\r\n        contentType: false,\r\n\r\n        success: function(resp) {\r\n\r\n            console.log('Server response:', resp);\r\n\r\n            if(resp == 'OK') {\r\n\r\n                $('#tahsilatEditModal').modal('hide');\r\n\r\n                location.reload();\r\n\r\n            } else if(resp == 'KASA_GORSEL_HATASI') {\r\n\r\n                alert('Kasa hareketleri için görsel yükleme desteklenmemektedir!');\r\n\r\n            } else {\r\n\r\n                alert('Hata: ' + resp);\r\n\r\n            }\r\n\r\n        },\r\n\r\n        error: function(xhr, status, error) {\r\n\r\n            console.log('AJAX Error:', xhr.responseText);\r\n\r\n            alert('AJAX Hatası: ' + error);\r\n\r\n        }\r\n\r\n    });\r\n\r\n});\r\n\r\n</script>\r\n\r\n\r\n\r\n</body>\r\n\r\n</html>\r\n\r\n"
        }
    ]
}