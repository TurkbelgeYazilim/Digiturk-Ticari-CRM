{
    "sourceFile": "application/views/muhase/tahsilat-listesi.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1756213124138,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1756213124138,
            "name": "Commit-0",
            "content": "<!DOCTYPE html>\r\n\r\n<html lang=\"tr\">\r\n\r\n<head>\r\n\r\n\t<?php $this->load->view(\"include/head-tags\"); ?>\r\n\r\n\t<title>Tahsilat Listesi | İlekaSoft CRM</title>\r\n\r\n\t<link rel=\"icon\" type=\"image/x-icon\" href=\"<?= base_url('assets/favicon.ico'); ?>\" />\r\n\r\n\t<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/datatables.net-bs4@1.13.6/css/dataTables.bootstrap4.min.css\"/>\r\n\r\n\t\r\n\r\n\t<style>\r\n\r\n\t\t.tahsilat-onay-bekleyen {\r\n\r\n\t\t\tbackground-color: #fff3cd;\r\n\r\n\t\t\tborder-left: 4px solid #ffc107;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.tahsilat-onaylanan {\r\n\r\n\t\t\tbackground-color: #d4edda;\r\n\r\n\t\t\tborder-left: 4px solid #28a745;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.tahsilat-reddedilen {\r\n\r\n\t\t\tbackground-color: #f8d7da;\r\n\r\n\t\t\tborder-left: 4px solid #dc3545;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.tutar-buyuk {\r\n\r\n\t\t\tfont-size: 1.2em;\r\n\r\n\t\t\tfont-weight: bold;\r\n\r\n\t\t\tcolor: #28a745;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.btn-onay {\r\n\r\n\t\t\tbackground-color: #28a745;\r\n\r\n\t\t\tborder-color: #28a745;\r\n\r\n\t\t\tcolor: white;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.btn-onay:hover {\r\n\r\n\t\t\tbackground-color: #218838;\r\n\r\n\t\t\tborder-color: #1e7e34;\r\n\r\n\t\t\tcolor: white;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.btn-red {\r\n\r\n\t\t\tbackground-color: #dc3545;\r\n\r\n\t\t\tborder-color: #dc3545;\r\n\r\n\t\t\tcolor: white;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.btn-red:hover {\r\n\r\n\t\t\tbackground-color: #c82333;\r\n\r\n\t\t\tborder-color: #bd2130;\r\n\r\n\t\t\tcolor: white;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.card-stats {\r\n\r\n\t\t\tbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n\r\n\t\t\tcolor: white;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.card-stats.card-warning {\r\n\r\n\t\t\tbackground: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.card-stats.card-success {\r\n\r\n\t\t\tbackground: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.card-stats.card-danger {\r\n\r\n\t\t\tbackground: linear-gradient(135deg, #fa709a 0%, #fee140 100%);\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.card-stats .card-body {\r\n\r\n\t\t\tpadding: 1.5rem;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.stats-number {\r\n\r\n\t\t\tfont-size: 2rem;\r\n\r\n\t\t\tfont-weight: bold;\r\n\r\n\t\t\tmargin-bottom: 0.5rem;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t.stats-label {\r\n\r\n\t\t\tfont-size: 0.9rem;\r\n\r\n\t\t\topacity: 0.9;\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t@media (max-width: 768px) {\r\n\r\n\t\t\t.table-responsive {\r\n\r\n\t\t\t\tfont-size: 0.875rem;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t\r\n\r\n\t\t\t.btn-group .btn {\r\n\r\n\t\t\t\tpadding: 0.25rem 0.5rem;\r\n\r\n\t\t\t\tfont-size: 0.8rem;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t</style>\r\n\r\n</head>\r\n\r\n<body>\r\n\r\n<div class=\"main-wrapper\">\r\n\r\n\t<?php $this->load->view(\"include/header\"); ?>\r\n\r\n\t<?php $this->load->view(\"include/sidebar\"); ?>\r\n\r\n\t<div class=\"page-wrapper\">\r\n\r\n\t\t<div class=\"content container-fluid\">\r\n\r\n\t\t\t<!-- Page Header -->\r\n\r\n\t\t\t<div class=\"page-header\">\r\n\r\n\t\t\t\t<div class=\"row\">\r\n\r\n\t\t\t\t\t<div class=\"col-sm-10\">\r\n\r\n\t\t\t\t\t\t<h3 class=\"page-title\">Tahsilat Listesi</h3>\r\n\r\n\t\t\t\t\t\t<ul class=\"breadcrumb\">\r\n\r\n\t\t\t\t\t\t\t<li class=\"breadcrumb-item\"><a href=\"<?= base_url(); ?>\">Anasayfa</a></li>\r\n\r\n\t\t\t\t\t\t\t<li class=\"breadcrumb-item\">Muhasebe</li>\r\n\r\n\t\t\t\t\t\t\t<li class=\"breadcrumb-item active\">Tahsilat Listesi</li>\r\n\r\n\t\t\t\t\t\t</ul>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"d-flex justify-content-end text-align-center col-sm-2\">\r\n\r\n\t\t\t\t\t\t<a class=\"btn btn-outline-light\" href=\"javascript:history.back()\">\r\n\r\n\t\t\t\t\t\t\t<i class=\"fa fa-history\"></i> <br>Önceki Sayfa\r\n\r\n\t\t\t\t\t\t</a>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t\t<!-- /Page Header -->\r\n\r\n\r\n\r\n\t\t\t<!-- İstatistikler -->\r\n\r\n\t\t\t<div class=\"row mb-4\">\r\n\r\n\t\t\t\t<div class=\"col-xl-3 col-sm-6 col-12\">\r\n\r\n\t\t\t\t\t<div class=\"card card-stats\">\r\n\r\n\t\t\t\t\t\t<div class=\"card-body\">\r\n\r\n\t\t\t\t\t\t\t<div class=\"stats-number\">\r\n\r\n\t\t\t\t\t\t\t\t<?= isset($toplam_adet) ? $toplam_adet : count($tahsilatlar) ?>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div class=\"stats-label\">\r\n\r\n\t\t\t\t\t\t\t\t<i class=\"fa fa-list mr-2\"></i>Toplam Tahsilat Sayısı\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"col-xl-3 col-sm-6 col-12\">\r\n\r\n\t\t\t\t\t<div class=\"card card-stats card-warning\">\r\n\r\n\t\t\t\t\t\t<div class=\"card-body\">\r\n\r\n\t\t\t\t\t\t\t<div class=\"stats-number\">\r\n\r\n\t\t\t\t\t\t\t\t<?= isset($onay_bekleyen_adet) ? $onay_bekleyen_adet : 0 ?>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div class=\"stats-label\">\r\n\r\n\t\t\t\t\t\t\t\t<i class=\"fa fa-clock-o mr-2\"></i>Onay Bekleyen\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"col-xl-3 col-sm-6 col-12\">\r\n\r\n\t\t\t\t\t<div class=\"card card-stats card-success\">\r\n\r\n\t\t\t\t\t\t<div class=\"card-body\">\r\n\r\n\t\t\t\t\t\t\t<div class=\"stats-number\">\r\n\r\n\t\t\t\t\t\t\t\t<?= isset($onaylanan_adet) ? $onaylanan_adet : 0 ?>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div class=\"stats-label\">\r\n\r\n\t\t\t\t\t\t\t\t<i class=\"fa fa-check mr-2\"></i>Onaylanan\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"col-xl-3 col-sm-6 col-12\">\r\n\r\n\t\t\t\t\t<div class=\"card card-stats card-danger\">\r\n\r\n\t\t\t\t\t\t<div class=\"card-body\">\r\n\r\n\t\t\t\t\t\t\t<div class=\"stats-number\">\r\n\r\n\t\t\t\t\t\t\t\t<?= isset($reddedilen_adet) ? $reddedilen_adet : 0 ?>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div class=\"stats-label\">\r\n\r\n\t\t\t\t\t\t\t\t<i class=\"fa fa-times mr-2\"></i>Reddedilen\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\r\n\r\n\r\n\r\n\t\t\t<!-- Toplam Tutar -->\r\n\r\n\t\t\t<div class=\"row mb-4\">\r\n\r\n\t\t\t\t<div class=\"col-12\">\r\n\r\n\t\t\t\t\t<div class=\"card\">\r\n\r\n\t\t\t\t\t\t<div class=\"card-body text-center\">\r\n\r\n\t\t\t\t\t\t\t<h4 class=\"card-title\">Toplam Tahsilat Tutarı</h4>\r\n\r\n\t\t\t\t\t\t\t<h2 class=\"text-success\">\r\n\r\n\t\t\t\t\t\t\t\t<i class=\"fa fa-money mr-2\"></i>\r\n\r\n\t\t\t\t\t\t\t\t<?= number_format($toplam_tutar, 2, ',', '.') ?> ₺\r\n\r\n\t\t\t\t\t\t\t</h2>\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\r\n\r\n\r\n\r\n\t\t\t<!-- Tahsilatlar Listesi -->\r\n\r\n\t\t\t<div class=\"row\">\r\n\r\n\t\t\t\t<div class=\"col-xl-12 col-md-12\">\r\n\r\n\t\t\t\t\t<div class=\"card card-table\">\r\n\r\n\t\t\t\t\t\t<div class=\"card-header\">\r\n\r\n\t\t\t\t\t\t\t<div class=\"row\">\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"col\">\r\n\r\n\t\t\t\t\t\t\t\t\t<h4 class=\"card-title\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-list text-primary mr-2\"></i>\r\n\r\n\t\t\t\t\t\t\t\t\t\tTüm Tahsilatlar\r\n\r\n\t\t\t\t\t\t\t\t\t</h4>\r\n\r\n\t\t\t\t\t\t\t\t\t<p class=\"text-muted mb-0\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t<small>Tüm tahsilatlar durum farkı gözetmeksizin listelenmektedir</small>\r\n\r\n\t\t\t\t\t\t\t\t\t</p>\r\n\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"col-auto\">\r\n\r\n\t\t\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-primary btn-sm\" onclick=\"location.reload()\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-refresh\"></i> Yenile\r\n\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\r\n\r\n\t\t\t\t\t\t<?php if (isset($error_message)): ?>\r\n\r\n\t\t\t\t\t\t\t<div class=\"alert alert-warning\">\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"row\">\r\n\r\n\t\t\t\t\t\t\t\t\t<div class=\"col-md-2 text-center\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-database\" style=\"font-size: 3rem; color: #ffc107;\"></i>\r\n\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t<div class=\"col-md-10\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t<h5><i class=\"fa fa-exclamation-triangle mr-2\"></i>Veritabanı Kurulum Gerekli</h5>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<p><?= $error_message ?></p>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"mt-3\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<p><strong>Kurulum Adımları:</strong></p>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<ol>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<li>MySQL/phpMyAdmin'e giriş yapın</li>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<li><code>muhase_database_setup.sql</code> dosyasını çalıştırın</li>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<li>Bu sayfayı yenileyin</li>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</ol>\r\n\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<?php elseif (count($tahsilatlar) > 0): ?>\r\n\r\n\t\t\t\t\t\t\t<div class=\"table-responsive\">\r\n\r\n\t\t\t\t\t\t\t\t<table class=\"table table-striped custom-table mb-0\" id=\"tahsilatlarTable\">\r\n\r\n\t\t\t\t\t\t\t\t\t<thead>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<tr>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<th>ID</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<th>Tahsilat Tipi</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<th>Müşteri Adı</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<th>Tutar</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<th>Durum</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<th>İşlemi Yapan</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<th>Onay Yapan</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<th>İşlem Tarihi</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<th>Görsel</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<th>Açıklama</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<th>İşlemler</th>\r\n\r\n\t\t\t\t\t\t\t\t\t\t</tr>\r\n\r\n\t\t\t\t\t\t\t\t\t</thead>\r\n\r\n\t\t\t\t\t\t\t\t\t<tbody>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<?php foreach($tahsilatlar as $tahsilat): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<tr class=\"<?php \r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif($tahsilat->durum == 1) echo 'tahsilat-onay-bekleyen';\r\n\r\n\t\t\t\t\t\t\t\t\t\t\telseif($tahsilat->durum == 2) echo 'tahsilat-onaylanan';\r\n\r\n\t\t\t\t\t\t\t\t\t\t\telseif($tahsilat->durum == 3) echo 'tahsilat-reddedilen';\r\n\r\n\t\t\t\t\t\t\t\t\t\t?>\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td><strong>#<?= $tahsilat->id ?></strong></td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t$icon = '';\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t$class = '';\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tswitch($tahsilat->tahsilat_tipi_adi) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase 'Banka': $icon = 'fa-university'; $class = 'text-primary'; break;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase 'Çek': $icon = 'fa-file-text-o'; $class = 'text-info'; break;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase 'Kasa': $icon = 'fa-money'; $class = 'text-success'; break;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase 'Senet': $icon = 'fa-file-o'; $class = 'text-warning'; break;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdefault: $icon = 'fa-question'; $class = 'text-muted'; break;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fa <?= $icon ?> <?= $class ?> mr-2\"></i>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"<?= $class ?>\"><?= $tahsilat->tahsilat_tipi_adi ?></span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<strong title=\"<?= htmlspecialchars($tahsilat->musteri_adi ?: 'Bilinmiyor') ?>\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?= $tahsilat->musteri_adi ? (mb_strlen($tahsilat->musteri_adi) > 30 ? mb_substr($tahsilat->musteri_adi, 0, 30) . '...' : $tahsilat->musteri_adi) : 'Bilinmiyor' ?>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</strong>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"tutar-buyuk\"><?= $tahsilat->tutar ? number_format($tahsilat->tutar, 2, ',', '.') . ' ₺' : '-' ?></span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->durum == 1): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"badge badge-warning\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-clock-o mr-1\"></i>Onay Bekliyor\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php elseif($tahsilat->durum == 2): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"badge badge-success\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-check mr-1\"></i>Onaylandı\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php elseif($tahsilat->durum == 3): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"badge badge-danger\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-times mr-1\"></i>Reddedildi\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php else: ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"badge badge-secondary\">Bilinmiyor</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-user text-info mr-1\"></i>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?= $tahsilat->islemi_yapan_personel ?: 'Bilinmiyor' ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->onay_yapan_personel): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-user-check text-success mr-1\"></i>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?= $tahsilat->onay_yapan_personel ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php else: ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-muted\">-</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->islem_tarihi): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<strong><?= date('d.m.Y', strtotime($tahsilat->islem_tarihi)) ?></strong>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><small class=\"text-muted\"><?= date('H:i', strtotime($tahsilat->islem_tarihi)) ?></small>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php else: ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-muted\">-</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->gorsel): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?php\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// Tahsilat tipine göre doğru klasör yolunu belirle\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$gorsel_url = '';\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif($tahsilat->tahsilat_tipi == 1) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$gorsel_url = base_url('assets/uploads/dekontlar/' . $tahsilat->gorsel);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} elseif($tahsilat->tahsilat_tipi == 2) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$gorsel_url = base_url('assets/uploads/cekler/' . $tahsilat->gorsel);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} elseif($tahsilat->tahsilat_tipi == 4) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$gorsel_url = base_url('assets/uploads/senetler/' . $tahsilat->gorsel);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$gorsel_url = base_url('assets/uploads/dekontlar/' . $tahsilat->gorsel);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-sm btn-outline-info\" \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonclick=\"window.open('<?= $gorsel_url ?>', '_blank')\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-image\"></i> Görsel\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php else: ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-muted\">-</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->aciklama): ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?= substr($tahsilat->aciklama, 0, 30) ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?= strlen($tahsilat->aciklama) > 30 ? '...' : '' ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php else: ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-muted\">-</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"btn-group\" role=\"group\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?php if($tahsilat->durum == 1): // Sadece onay bekleyenler için ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<button type=\"button\" \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"btn btn-sm btn-onay tahsilat-onay-btn\" \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-id=\"<?= $tahsilat->id ?>\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-cari=\"<?= $tahsilat->musteri_adi ?>\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-tutar=\"<?= $tahsilat->tutar ? number_format($tahsilat->tutar, 2, ',', '.') : '0,00' ?>\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"Onayla\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-check\"></i>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<button type=\"button\" \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"btn btn-sm btn-red tahsilat-red-btn\" \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-id=\"<?= $tahsilat->id ?>\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-cari=\"<?= $tahsilat->musteri_adi ?>\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-tutar=\"<?= $tahsilat->tutar ? number_format($tahsilat->tutar, 2, ',', '.') : '0,00' ?>\"\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"Reddet\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-times\"></i>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?php else: ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-muted\">İşlem Tamamlandı</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"<?= base_url('muhasebe/tahsilat-detay/' . $tahsilat->id) ?>\" \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t   class=\"btn btn-sm btn-outline-primary\" \r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t   title=\"Detay Görüntüle\">\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-eye\"></i>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t</tr>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<?php endforeach; ?>\r\n\r\n\t\t\t\t\t\t\t\t\t</tbody>\r\n\r\n\t\t\t\t\t\t\t\t</table>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<?php else: ?>\r\n\r\n\t\t\t\t\t\t\t<div class=\"text-center py-5\">\r\n\r\n\t\t\t\t\t\t\t\t<i class=\"fa fa-list text-muted\" style=\"font-size: 4rem; margin-bottom: 1rem;\"></i>\r\n\r\n\t\t\t\t\t\t\t\t<h4>Henüz tahsilat kaydı bulunmuyor.</h4>\r\n\r\n\t\t\t\t\t\t\t\t<p class=\"text-muted\">İlk tahsilat kaydını oluşturmak için aşağıdaki butonu kullanabilirsiniz.</p>\r\n\r\n\t\t\t\t\t\t\t\t<a href=\"<?= base_url('tahsilat') ?>\" class=\"btn btn-primary\">\r\n\r\n\t\t\t\t\t\t\t\t\t<i class=\"fa fa-plus\"></i> Yeni Tahsilat Ekle\r\n\r\n\t\t\t\t\t\t\t\t</a>\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<?php endif; ?>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t</div>\r\n\r\n\t</div>\r\n\r\n</div>\r\n\r\n\r\n\r\n<!-- Onay Modalı -->\r\n\r\n<div class=\"modal fade\" id=\"onayModal\" tabindex=\"-1\" role=\"dialog\">\r\n\r\n\t<div class=\"modal-dialog\" role=\"document\">\r\n\r\n\t\t<div class=\"modal-content\">\r\n\r\n\t\t\t<div class=\"modal-header bg-success text-white\">\r\n\r\n\t\t\t\t<h5 class=\"modal-title\">\r\n\r\n\t\t\t\t\t<i class=\"fa fa-check-circle mr-2\"></i>Tahsilat Onayı\r\n\r\n\t\t\t\t</h5>\r\n\r\n\t\t\t\t<button type=\"button\" class=\"close text-white\" data-dismiss=\"modal\">\r\n\r\n\t\t\t\t\t<span>&times;</span>\r\n\r\n\t\t\t\t</button>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"modal-body\">\r\n\r\n\t\t\t\t<div class=\"text-center\">\r\n\r\n\t\t\t\t\t<i class=\"fa fa-question-circle text-warning\" style=\"font-size: 3rem; margin-bottom: 1rem;\"></i>\r\n\r\n\t\t\t\t\t<h5>Bu tahsilatı onaylamak istediğinizden emin misiniz?</h5>\r\n\r\n\t\t\t\t\t<div class=\"alert alert-info mt-3\">\r\n\r\n\t\t\t\t\t\t<strong>Cari:</strong> <span id=\"onay-cari-ad\"></span><br>\r\n\r\n\t\t\t\t\t\t<strong>Tutar:</strong> <span id=\"onay-tutar\"></span> ₺\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<p class=\"text-muted\">\r\n\r\n\t\t\t\t\t\tOnaylanan tahsilatlar geri alınamaz ve muhasebe kayıtlarına işlenir.\r\n\r\n\t\t\t\t\t</p>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"modal-footer\">\r\n\r\n\t\t\t\t<button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">İptal</button>\r\n\r\n\t\t\t\t<a href=\"#\" id=\"onay-link\" class=\"btn btn-success\">\r\n\r\n\t\t\t\t\t<i class=\"fa fa-check mr-1\"></i>Onayla\r\n\r\n\t\t\t\t</a>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t</div>\r\n\r\n\t</div>\r\n\r\n</div>\r\n\r\n\r\n\r\n<!-- Red Modalı -->\r\n\r\n<div class=\"modal fade\" id=\"redModal\" tabindex=\"-1\" role=\"dialog\">\r\n\r\n\t<div class=\"modal-dialog\" role=\"document\">\r\n\r\n\t\t<div class=\"modal-content\">\r\n\r\n\t\t\t<div class=\"modal-header bg-danger text-white\">\r\n\r\n\t\t\t\t<h5 class=\"modal-title\">\r\n\r\n\t\t\t\t\t<i class=\"fa fa-times-circle mr-2\"></i>Tahsilat Reddi\r\n\r\n\t\t\t\t</h5>\r\n\r\n\t\t\t\t<button type=\"button\" class=\"close text-white\" data-dismiss=\"modal\">\r\n\r\n\t\t\t\t\t<span>&times;</span>\r\n\r\n\t\t\t\t</button>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"modal-body\">\r\n\r\n\t\t\t\t<div class=\"text-center\">\r\n\r\n\t\t\t\t\t<i class=\"fa fa-exclamation-triangle text-danger\" style=\"font-size: 3rem; margin-bottom: 1rem;\"></i>\r\n\r\n\t\t\t\t\t<h5>Bu tahsilatı reddetmek istediğinizden emin misiniz?</h5>\r\n\r\n\t\t\t\t\t<div class=\"alert alert-warning mt-3\">\r\n\r\n\t\t\t\t\t\t<strong>Cari:</strong> <span id=\"red-cari-ad\"></span><br>\r\n\r\n\t\t\t\t\t\t<strong>Tutar:</strong> <span id=\"red-tutar\"></span> ₺\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<p class=\"text-muted\">\r\n\r\n\t\t\t\t\t\tReddedilen tahsilatlar muhasebe kayıtlarına işlenmez.\r\n\r\n\t\t\t\t\t</p>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"modal-footer\">\r\n\r\n\t\t\t\t<button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">İptal</button>\r\n\r\n\t\t\t\t<a href=\"#\" id=\"red-link\" class=\"btn btn-danger\">\r\n\r\n\t\t\t\t\t<i class=\"fa fa-times mr-1\"></i>Reddet\r\n\r\n\t\t\t\t</a>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t</div>\r\n\r\n\t</div>\r\n\r\n</div>\r\n\r\n\r\n\r\n<?php $this->load->view(\"include/footer-js\"); ?>\r\n\r\n\r\n\r\n<script src=\"https://cdn.jsdelivr.net/npm/datatables.net@1.13.6/js/jquery.dataTables.min.js\"></script>\r\n\r\n<script src=\"https://cdn.jsdelivr.net/npm/datatables.net-bs4@1.13.6/js/dataTables.bootstrap4.min.js\"></script>\r\n\r\n\r\n\r\n<script>\r\n\r\n$(document).ready(function() {\r\n\r\n\t// DataTable başlat\r\n\r\n\t$('#tahsilatlarTable').DataTable({\r\n\r\n\t\t\"language\": {\r\n\r\n\t\t\t\"url\": \"//cdn.datatables.net/plug-ins/1.13.6/i18n/tr.json\"\r\n\r\n\t\t},\r\n\r\n\t\t\"pageLength\": 25,\r\n\r\n\t\t\"order\": [[ 0, \"desc\" ]],\r\n\r\n\t\t\"columnDefs\": [\r\n\r\n\t\t\t{ \"orderable\": false, \"targets\": [8, 10] } // Görsel ve İşlemler sütunları sıralanamaz\r\n\r\n\t\t]\r\n\r\n\t});\r\n\r\n\t\r\n\r\n\t// Onay butonları\r\n\r\n\t$('.tahsilat-onay-btn').click(function() {\r\n\r\n\t\tvar tahsilat_id = $(this).data('id');\r\n\r\n\t\tvar cari_ad = $(this).data('cari');\r\n\r\n\t\tvar tutar = $(this).data('tutar');\r\n\r\n\t\t\r\n\r\n\t\t$('#onay-cari-ad').text(cari_ad);\r\n\r\n\t\t$('#onay-tutar').text(tutar);\r\n\r\n\t\t$('#onay-link').attr('href', '<?= base_url(\"muhasebe/tahsilat-onay/\") ?>' + tahsilat_id);\r\n\r\n\t\t\r\n\r\n\t\t$('#onayModal').modal('show');\r\n\r\n\t});\r\n\r\n\t\r\n\r\n\t// Red butonları\r\n\r\n\t$('.tahsilat-red-btn').click(function() {\r\n\r\n\t\tvar tahsilat_id = $(this).data('id');\r\n\r\n\t\tvar cari_ad = $(this).data('cari');\r\n\r\n\t\tvar tutar = $(this).data('tutar');\r\n\r\n\t\t\r\n\r\n\t\t$('#red-cari-ad').text(cari_ad);\r\n\r\n\t\t$('#red-tutar').text(tutar);\r\n\r\n\t\t$('#red-link').attr('href', '<?= base_url(\"muhasebe/tahsilat-red/\") ?>' + tahsilat_id);\r\n\r\n\t\t\r\n\r\n\t\t$('#redModal').modal('show');\r\n\r\n\t});\r\n\r\n});\r\n\r\n</script>\r\n\r\n\r\n\r\n<?php if($this->session->flashdata('tahsilat_onay_ok')): ?>\r\n\r\n<script>\r\n\r\ntoastr.success('Tahsilat başarıyla onaylandı!', 'Başarılı');\r\n\r\n</script>\r\n\r\n<?php endif; ?>\r\n\r\n\r\n\r\n<?php if($this->session->flashdata('tahsilat_red_ok')): ?>\r\n\r\n<script>\r\n\r\ntoastr.success('Tahsilat başarıyla reddedildi!', 'Başarılı');\r\n\r\n</script>\r\n\r\n<?php endif; ?>\r\n\r\n\r\n\r\n<?php if($this->session->flashdata('tahsilat_onay_hata')): ?>\r\n\r\n<script>\r\n\r\ntoastr.error('Tahsilat onaylama işlemi sırasında hata oluştu!', 'Hata');\r\n\r\n</script>\r\n\r\n<?php endif; ?>\r\n\r\n\r\n\r\n<?php if($this->session->flashdata('tahsilat_red_hata')): ?>\r\n\r\n<script>\r\n\r\ntoastr.error('Tahsilat reddetme işlemi sırasında hata oluştu!', 'Hata');\r\n\r\n</script>\r\n\r\n<?php endif; ?>\r\n\r\n\r\n\r\n</body>\r\n\r\n</html>\r\n\r\n"
        }
    ]
}