{
    "sourceFile": "application/views/aktivasyon/ssport_olustur.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1757426227633,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1757427668860,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -337,9 +337,9 @@\n                             <h4 class=\"card-title ssport-title\"><?= $isEditMode ? 'S SPORT Aktivasyon Düzenle' : 'Yeni S SPORT Aktivasyon Oluştur' ?></h4>\r\n \r\n                             \r\n \r\n-                            <form action=\"<?= base_url('aktivasyon/kaydet') ?>\" method=\"POST\" id=\"aktivasyonForm\">\r\n+                            <form action=\"<?= base_url('aktivasyon/ssport-kaydet') ?>\" method=\"POST\" id=\"aktivasyonForm\">\r\n \r\n                                 <?php if($isEditMode): ?>\r\n \r\n                                     <input type=\"hidden\" name=\"aktivasyon_id\" value=\"<?= $aktivasyon->aktivasyon_id ?>\">\r\n@@ -453,56 +453,268 @@\n                                 </div>\r\n \r\n \r\n \r\n+                                <!-- S SPORT Aktivasyon Bilgileri -->\r\n                                 <div class=\"row\">\r\n+                                    <!-- Üye No -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"uye_no\">Üye No</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"uye_no\" id=\"uye_no\" \r\n+                                               value=\"<?= $isEditMode ? $aktivasyon->aktivasyon_uye_no : '' ?>\" \r\n+                                               placeholder=\"Üye No\">\r\n+                                    </div>\r\n \r\n+                                    <!-- Kampanya Kodu -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"kampanya_kodu\">Kampanya Kodu</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"kampanya_kodu\" id=\"kampanya_kodu\" \r\n+                                               value=\"<?= $isEditMode ? $aktivasyon->aktivasyon_kampanya_kodu : '' ?>\" \r\n+                                               placeholder=\"Kampanya Kodu\">\r\n+                                    </div>\r\n+\r\n+                                    <!-- Aktivasyon Tarihi -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"aktivasyon_tarihi\">Aktivasyon Tarihi</label>\r\n+                                        <input type=\"datetime-local\" class=\"form-control\" name=\"aktivasyon_tarihi\" id=\"aktivasyon_tarihi\" \r\n+                                               value=\"<?= $isEditMode && $aktivasyon->aktivasyon_tarihi ? date('Y-m-d\\TH:i', strtotime($aktivasyon->aktivasyon_tarihi)) : '' ?>\">\r\n+                                    </div>\r\n+\r\n+                                    <!-- E-Posta -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"eposta\">E-Posta</label>\r\n+                                        <input type=\"email\" class=\"form-control\" name=\"eposta\" id=\"eposta\" \r\n+                                               value=\"<?= $isEditMode ? $aktivasyon->aktivasyon_eposta : '' ?>\" \r\n+                                               placeholder=\"ahmet@mehmet.com\">\r\n+                                    </div>\r\n+\r\n+                                    <!-- Telefon -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"telefon\">Telefon</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"telefon\" id=\"telefon\" \r\n+                                               value=\"<?= $isEditMode ? $aktivasyon->aktivasyon_telefon : '' ?>\" \r\n+                                               placeholder=\"5529857010\">\r\n+                                    </div>\r\n+\r\n+                                    <!-- Adı -->\r\n+                                    <div class=\"form-group col-md-1\">\r\n+                                        <label for=\"adi\">Adı</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"adi\" id=\"adi\" \r\n+                                               value=\"<?= $isEditMode ? $aktivasyon->aktivasyon_adi : '' ?>\" \r\n+                                               placeholder=\"Adı\">\r\n+                                    </div>\r\n+\r\n+                                    <!-- Soyadı -->\r\n+                                    <div class=\"form-group col-md-1\">\r\n+                                        <label for=\"soyadi\">Soyadı</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"soyadi\" id=\"soyadi\" \r\n+                                               value=\"<?= $isEditMode ? $aktivasyon->aktivasyon_soyad : '' ?>\" \r\n+                                               placeholder=\"Soyadı\">\r\n+                                    </div>\r\n+                                </div>\r\n+\r\n+                                <!-- S SPORT Aktivasyon Bilgileri - 2. Satır -->\r\n+                                <div class=\"row\">\r\n                                     <!-- Üye No -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"uye_no_2\">Üye No</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"uye_no_2\" id=\"uye_no_2\" \r\n+                                               placeholder=\"Üye No\">\r\n+                                    </div>\r\n \r\n-                                    <div class=\"form-group col-md-4\">\r\n+                                    <!-- Kampanya Kodu -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"kampanya_kodu_2\">Kampanya Kodu</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"kampanya_kodu_2\" id=\"kampanya_kodu_2\" \r\n+                                               placeholder=\"Kampanya Kodu\">\r\n+                                    </div>\r\n \r\n-                                        <label for=\"uye_no\">Üye No</label>\r\n+                                    <!-- Aktivasyon Tarihi -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"aktivasyon_tarihi_2\">Aktivasyon Tarihi</label>\r\n+                                        <input type=\"datetime-local\" class=\"form-control\" name=\"aktivasyon_tarihi_2\" id=\"aktivasyon_tarihi_2\">\r\n+                                    </div>\r\n \r\n-                                        <input type=\"text\" class=\"form-control\" name=\"uye_no\" id=\"uye_no\" \r\n+                                    <!-- E-Posta -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"eposta_2\">E-Posta</label>\r\n+                                        <input type=\"email\" class=\"form-control\" name=\"eposta_2\" id=\"eposta_2\" \r\n+                                               placeholder=\"ahmet@mehmet.com\">\r\n+                                    </div>\r\n \r\n-                                               value=\"<?= $isEditMode ? $aktivasyon->aktivasyon_uye_no : '' ?>\" \r\n+                                    <!-- Telefon -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"telefon_2\">Telefon</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"telefon_2\" id=\"telefon_2\" \r\n+                                               placeholder=\"5529857010\">\r\n+                                    </div>\r\n \r\n-                                               placeholder=\"Üye numarasını giriniz\">\r\n+                                    <!-- Adı -->\r\n+                                    <div class=\"form-group col-md-1\">\r\n+                                        <label for=\"adi_2\">Adı</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"adi_2\" id=\"adi_2\" \r\n+                                               placeholder=\"Adı\">\r\n+                                    </div>\r\n \r\n+                                    <!-- Soyadı -->\r\n+                                    <div class=\"form-group col-md-1\">\r\n+                                        <label for=\"soyadi_2\">Soyadı</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"soyadi_2\" id=\"soyadi_2\" \r\n+                                               placeholder=\"Soyadı\">\r\n                                     </div>\r\n+                                </div>\r\n \r\n+                                <!-- S SPORT Aktivasyon Bilgileri - 3. Satır -->\r\n+                                <div class=\"row\">\r\n+                                    <!-- Üye No -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"uye_no_3\">Üye No</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"uye_no_3\" id=\"uye_no_3\" \r\n+                                               placeholder=\"Üye No\">\r\n+                                    </div>\r\n \r\n+                                    <!-- Kampanya Kodu -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"kampanya_kodu_3\">Kampanya Kodu</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"kampanya_kodu_3\" id=\"kampanya_kodu_3\" \r\n+                                               placeholder=\"Kampanya Kodu\">\r\n+                                    </div>\r\n \r\n-                                    <!-- Kutu No -->\r\n+                                    <!-- Aktivasyon Tarihi -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"aktivasyon_tarihi_3\">Aktivasyon Tarihi</label>\r\n+                                        <input type=\"datetime-local\" class=\"form-control\" name=\"aktivasyon_tarihi_3\" id=\"aktivasyon_tarihi_3\">\r\n+                                    </div>\r\n \r\n-                                    <div class=\"form-group col-md-4\">\r\n+                                    <!-- E-Posta -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"eposta_3\">E-Posta</label>\r\n+                                        <input type=\"email\" class=\"form-control\" name=\"eposta_3\" id=\"eposta_3\" \r\n+                                               placeholder=\"ahmet@mehmet.com\">\r\n+                                    </div>\r\n \r\n-                                        <label for=\"kutu_no\">Kutu No</label>\r\n+                                    <!-- Telefon -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"telefon_3\">Telefon</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"telefon_3\" id=\"telefon_3\" \r\n+                                               placeholder=\"5529857010\">\r\n+                                    </div>\r\n \r\n-                                        <input type=\"text\" class=\"form-control\" name=\"kutu_no\" id=\"kutu_no\" \r\n+                                    <!-- Adı -->\r\n+                                    <div class=\"form-group col-md-1\">\r\n+                                        <label for=\"adi_3\">Adı</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"adi_3\" id=\"adi_3\" \r\n+                                               placeholder=\"Adı\">\r\n+                                    </div>\r\n \r\n-                                               value=\"<?= $isEditMode ? $aktivasyon->aktivasyon_kutu_no : '' ?>\" \r\n+                                    <!-- Soyadı -->\r\n+                                    <div class=\"form-group col-md-1\">\r\n+                                        <label for=\"soyadi_3\">Soyadı</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"soyadi_3\" id=\"soyadi_3\" \r\n+                                               placeholder=\"Soyadı\">\r\n+                                    </div>\r\n+                                </div>\r\n \r\n-                                               placeholder=\"Kutu numarasını giriniz\">\r\n+                                <!-- S SPORT Aktivasyon Bilgileri - 4. Satır -->\r\n+                                <div class=\"row\">\r\n+                                    <!-- Üye No -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"uye_no_4\">Üye No</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"uye_no_4\" id=\"uye_no_4\" \r\n+                                               placeholder=\"Üye No\">\r\n+                                    </div>\r\n \r\n+                                    <!-- Kampanya Kodu -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"kampanya_kodu_4\">Kampanya Kodu</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"kampanya_kodu_4\" id=\"kampanya_kodu_4\" \r\n+                                               placeholder=\"Kampanya Kodu\">\r\n                                     </div>\r\n \r\n+                                    <!-- Aktivasyon Tarihi -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"aktivasyon_tarihi_4\">Aktivasyon Tarihi</label>\r\n+                                        <input type=\"datetime-local\" class=\"form-control\" name=\"aktivasyon_tarihi_4\" id=\"aktivasyon_tarihi_4\">\r\n+                                    </div>\r\n \r\n+                                    <!-- E-Posta -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"eposta_4\">E-Posta</label>\r\n+                                        <input type=\"email\" class=\"form-control\" name=\"eposta_4\" id=\"eposta_4\" \r\n+                                               placeholder=\"ahmet@mehmet.com\">\r\n+                                    </div>\r\n \r\n-                                    <!-- Kart No -->\r\n+                                    <!-- Telefon -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"telefon_4\">Telefon</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"telefon_4\" id=\"telefon_4\" \r\n+                                               placeholder=\"5529857010\">\r\n+                                    </div>\r\n \r\n-                                    <div class=\"form-group col-md-4\">\r\n+                                    <!-- Adı -->\r\n+                                    <div class=\"form-group col-md-1\">\r\n+                                        <label for=\"adi_4\">Adı</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"adi_4\" id=\"adi_4\" \r\n+                                               placeholder=\"Adı\">\r\n+                                    </div>\r\n \r\n-                                        <label for=\"kart_no\">Kart No</label>\r\n+                                    <!-- Soyadı -->\r\n+                                    <div class=\"form-group col-md-1\">\r\n+                                        <label for=\"soyadi_4\">Soyadı</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"soyadi_4\" id=\"soyadi_4\" \r\n+                                               placeholder=\"Soyadı\">\r\n+                                    </div>\r\n+                                </div>\r\n \r\n-                                        <input type=\"text\" class=\"form-control\" name=\"kart_no\" id=\"kart_no\" \r\n+                                <!-- S SPORT Aktivasyon Bilgileri - 5. Satır -->\r\n+                                <div class=\"row\">\r\n+                                    <!-- Üye No -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"uye_no_5\">Üye No</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"uye_no_5\" id=\"uye_no_5\" \r\n+                                               placeholder=\"Üye No\">\r\n+                                    </div>\r\n \r\n-                                               value=\"<?= $isEditMode ? $aktivasyon->aktivasyon_kart_no : '' ?>\" \r\n+                                    <!-- Kampanya Kodu -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"kampanya_kodu_5\">Kampanya Kodu</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"kampanya_kodu_5\" id=\"kampanya_kodu_5\" \r\n+                                               placeholder=\"Kampanya Kodu\">\r\n+                                    </div>\r\n \r\n-                                               placeholder=\"Kart numarasını giriniz\">\r\n+                                    <!-- Aktivasyon Tarihi -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"aktivasyon_tarihi_5\">Aktivasyon Tarihi</label>\r\n+                                        <input type=\"datetime-local\" class=\"form-control\" name=\"aktivasyon_tarihi_5\" id=\"aktivasyon_tarihi_5\">\r\n+                                    </div>\r\n \r\n+                                    <!-- E-Posta -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"eposta_5\">E-Posta</label>\r\n+                                        <input type=\"email\" class=\"form-control\" name=\"eposta_5\" id=\"eposta_5\" \r\n+                                               placeholder=\"ahmet@mehmet.com\">\r\n                                     </div>\r\n \r\n+                                    <!-- Telefon -->\r\n+                                    <div class=\"form-group col-md-2\">\r\n+                                        <label for=\"telefon_5\">Telefon</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"telefon_5\" id=\"telefon_5\" \r\n+                                               placeholder=\"5529857010\">\r\n+                                    </div>\r\n+\r\n+                                    <!-- Adı -->\r\n+                                    <div class=\"form-group col-md-1\">\r\n+                                        <label for=\"adi_5\">Adı</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"adi_5\" id=\"adi_5\" \r\n+                                               placeholder=\"Adı\">\r\n+                                    </div>\r\n+\r\n+                                    <!-- Soyadı -->\r\n+                                    <div class=\"form-group col-md-1\">\r\n+                                        <label for=\"soyadi_5\">Soyadı</label>\r\n+                                        <input type=\"text\" class=\"form-control\" name=\"soyadi_5\" id=\"soyadi_5\" \r\n+                                               placeholder=\"Soyadı\">\r\n+                                    </div>\r\n                                 </div>\r\n \r\n \r\n \r\n@@ -1267,11 +1479,11 @@\n     });\r\n \r\n \r\n \r\n-    // Sadece rakam girişi için input'ları kontrol et\r\n+    // Sadece rakam girişi için telefon input'larını kontrol et\r\n \r\n-    $('#uye_no, #kutu_no, #kart_no').on('input', function() {\r\n+    $('#telefon, #telefon_2, #telefon_3, #telefon_4, #telefon_5').on('input', function() {\r\n \r\n         this.value = this.value.replace(/[^0-9]/g, '');\r\n \r\n     });\r\n"
                }
            ],
            "date": 1757426227633,
            "name": "Commit-0",
            "content": "<!DOCTYPE html>\r\n\r\n<html lang=\"tr\">\r\n\r\n<head>\r\n\r\n    <?php $this->load->view(\"include/head-tags\"); ?>\r\n\r\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css\">\r\n\r\n    <style>\r\n\r\n        .select2-container--default .select2-results__option--highlighted[aria-selected] {\r\n\r\n            background-color: #5c2d91 !important;\r\n\r\n            color: #fff !important;\r\n\r\n        }\r\n\r\n        .form-group {\r\n\r\n            margin-bottom: 1rem !important;\r\n\r\n        }\r\n\r\n        .card {\r\n\r\n            border-radius: 10px;\r\n\r\n            box-shadow: 0 4px 8px rgba(0,0,0,0.1);\r\n\r\n        }\r\n\r\n        .btn-primary {\r\n\r\n            background-color: #5c2d91;\r\n\r\n            border-color: #5c2d91;\r\n\r\n        }\r\n\r\n        .btn-primary:hover {\r\n\r\n            background-color: #4a2373;\r\n\r\n            border-color: #4a2373;\r\n\r\n        }\r\n\r\n        .required {\r\n\r\n            color: red;\r\n\r\n        }\r\n\r\n        #musteriDetayAlani .card {\r\n\r\n            border: 1px solid #e3e6f0;\r\n\r\n            border-radius: 8px;\r\n\r\n        }\r\n\r\n        #musteriDetayAlani .card-header {\r\n\r\n            background-color: #f8f9fc;\r\n\r\n            border-bottom: 1px solid #e3e6f0;\r\n\r\n        }\r\n\r\n        #evrakGorselAlani .btn {\r\n\r\n            margin-right: 5px;\r\n\r\n            margin-bottom: 5px;\r\n\r\n        }\r\n\r\n        #evrakGorselAlani {\r\n\r\n            display: flex;\r\n\r\n            align-items: center;\r\n\r\n            flex-wrap: wrap;\r\n\r\n            gap: 10px;\r\n\r\n        }\r\n\r\n        #personelBilgi {\r\n\r\n            background-color: #f8f9fa;\r\n\r\n            border-color: #dee2e6;\r\n\r\n        }\r\n\r\n        .tahsilat-item {\r\n\r\n            border: 1px solid #e3e6f0;\r\n\r\n            border-radius: 6px;\r\n\r\n            padding: 10px;\r\n\r\n            margin-bottom: 10px;\r\n\r\n            background-color: #f8f9fc;\r\n\r\n        }\r\n\r\n        .tahsilat-item .badge {\r\n\r\n            font-size: 0.75rem;\r\n\r\n            margin-right: 5px;\r\n\r\n        }\r\n\r\n        .tahsilat-durum-onay {\r\n\r\n            background-color: #28a745;\r\n\r\n            color: white;\r\n\r\n        }\r\n\r\n        .tahsilat-durum-bekliyor {\r\n\r\n            background-color: #ffc107;\r\n\r\n            color: black;\r\n\r\n        }\r\n\r\n        .tahsilat-durum-red {\r\n\r\n            background-color: #dc3545;\r\n\r\n            color: white;\r\n\r\n        }\r\n\r\n        .tahsilat-gorsel-btn {\r\n\r\n            font-size: 0.75rem;\r\n\r\n            padding: 2px 8px;\r\n\r\n        }\r\n\r\n        .tutar-buyuk {\r\n\r\n            font-size: 1.1em;\r\n\r\n            font-weight: bold;\r\n\r\n            color: #28a745;\r\n\r\n        }\r\n\r\n        .table th {\r\n\r\n            background-color: #f8f9fc;\r\n\r\n            border-color: #e3e6f0;\r\n\r\n            font-weight: 600;\r\n\r\n            font-size: 0.85rem;\r\n\r\n        }\r\n\r\n        .table td {\r\n\r\n            vertical-align: middle;\r\n\r\n            border-color: #e3e6f0;\r\n\r\n        }\r\n\r\n        #sozlesmeTutar {\r\n\r\n            background-color: #f8f9fa;\r\n\r\n            border-color: #dee2e6;\r\n\r\n            font-weight: 600;\r\n\r\n            color: #155724;\r\n\r\n        }\r\n\r\n        #sozlesmeAciklama {\r\n\r\n            background-color: #f8f9fa;\r\n\r\n            border-color: #dee2e6;\r\n\r\n            resize: none;\r\n\r\n        }\r\n\r\n        #sozlesmeGorselAlani {\r\n\r\n            display: flex;\r\n\r\n            align-items: center;\r\n\r\n            flex-wrap: wrap;\r\n\r\n            gap: 10px;\r\n\r\n        }\r\n\r\n        /* S SPORT specific styling */\r\n\r\n        .ssport-title {\r\n\r\n            color: #dc3545;\r\n\r\n            font-weight: bold;\r\n\r\n        }\r\n\r\n        .ssport-card {\r\n\r\n            border-left: 4px solid #dc3545;\r\n\r\n        }\r\n\r\n        .ssport-btn {\r\n\r\n            background-color: #dc3545;\r\n\r\n            border-color: #dc3545;\r\n\r\n        }\r\n\r\n        .ssport-btn:hover {\r\n\r\n            background-color: #c82333;\r\n\r\n            border-color: #bd2130;\r\n\r\n        }\r\n\r\n    </style>\r\n\r\n</head>\r\n\r\n<body>\r\n\r\n<!-- Main Wrapper -->\r\n\r\n<div class=\"main-wrapper\">\r\n\r\n    <!-- Header -->\r\n\r\n    <?php $this->load->view(\"include/header\"); ?>\r\n\r\n    <!-- /Header -->\r\n\r\n\r\n\r\n    <!-- Sidebar -->\r\n\r\n    <?php $this->load->view(\"include/sidebar\"); ?>\r\n\r\n    <!-- /Sidebar -->\r\n\r\n\r\n\r\n    <!-- Page Wrapper -->\r\n\r\n    <div class=\"page-wrapper\">\r\n\r\n        <div class=\"content container-fluid\">\r\n\r\n            <!-- Page Header -->\r\n\r\n            <div class=\"page-header\">\r\n\r\n                <div class=\"row\">\r\n\r\n                    <div class=\"col-sm-10\">\r\n\r\n                        <?php\r\n\r\n                        $isEditMode = isset($aktivasyon) && !empty($aktivasyon);\r\n\r\n                        ?>\r\n\r\n                        <h3 class=\"page-title ssport-title\"><?= $isEditMode ? 'S SPORT Aktivasyon Düzenle' : 'S SPORT Aktivasyon Oluştur' ?></h3>\r\n\r\n                        <ul class=\"breadcrumb\">\r\n\r\n                            <li class=\"breadcrumb-item\"><a href=\"<?= base_url(); ?>\">Anasayfa</a></li>\r\n\r\n                            <li class=\"breadcrumb-item\"><a href=\"<?= base_url('aktivasyon'); ?>\">Aktivasyon</a></li>\r\n\r\n                            <li class=\"breadcrumb-item active ssport-title\"><?= $isEditMode ? 'S SPORT Düzenle' : 'S SPORT Oluştur' ?></li>\r\n\r\n                        </ul>\r\n\r\n                    </div>\r\n\r\n                    <div class=\"d-flex justify-content-end text-align-center col-sm-2\">\r\n\r\n                        <a class=\"btn btn-outline-light\" href=\"javascript:history.back()\">\r\n\r\n                            <i class=\"fa fa-history\"></i><br>Önceki Sayfa\r\n\r\n                        </a>\r\n\r\n                    </div>\r\n\r\n                </div>\r\n\r\n            </div>\r\n\r\n            <!-- /Page Header -->\r\n\r\n\r\n\r\n            <div class=\"row\">\r\n\r\n                <div class=\"col-md-12\">\r\n\r\n                    <div class=\"card ssport-card\">\r\n\r\n                        <div class=\"card-body\">\r\n\r\n                            <h4 class=\"card-title ssport-title\"><?= $isEditMode ? 'S SPORT Aktivasyon Düzenle' : 'Yeni S SPORT Aktivasyon Oluştur' ?></h4>\r\n\r\n                            \r\n\r\n                            <form action=\"<?= base_url('aktivasyon/kaydet') ?>\" method=\"POST\" id=\"aktivasyonForm\">\r\n\r\n                                <?php if($isEditMode): ?>\r\n\r\n                                    <input type=\"hidden\" name=\"aktivasyon_id\" value=\"<?= $aktivasyon->aktivasyon_id ?>\">\r\n\r\n                                <?php endif; ?>\r\n\r\n\r\n\r\n                                <div class=\"row\">\r\n\r\n                                    <!-- Müşteri Seçimi -->\r\n\r\n                                    <div class=\"form-group col-md-6\">\r\n\r\n                                        <label for=\"cari_id\">Müşteri <span class=\"required\">*</span></label>\r\n\r\n                                        <select class=\"form-control select2\" name=\"cari_id\" id=\"cari_id\" required>\r\n\r\n                                            <option value=\"\">Müşteri Seçiniz...</option>\r\n\r\n                                            <?php if(isset($cari_listesi) && !empty($cari_listesi)): ?>\r\n\r\n                                                <?php foreach($cari_listesi as $cari): ?>\r\n\r\n                                                    <?php \r\n\r\n                                                        $displayText = $cari->cari_ad;\r\n\r\n                                                        $extraInfo = array();\r\n\r\n                                                        if (!empty($cari->il_adi)) {\r\n\r\n                                                            $extraInfo[] = $cari->il_adi;\r\n\r\n                                                        }\r\n\r\n                                                        if (!empty($cari->ilce_adi)) {\r\n\r\n                                                            $extraInfo[] = $cari->ilce_adi;\r\n\r\n                                                        }\r\n\r\n                                                        if (!empty($cari->cari_firmaTelefon)) {\r\n\r\n                                                            $extraInfo[] = $cari->cari_firmaTelefon;\r\n\r\n                                                        }\r\n\r\n                                                        \r\n\r\n                                                        if (!empty($extraInfo)) {\r\n\r\n                                                            $displayText .= ' (' . implode(', ', $extraInfo) . ')';\r\n\r\n                                                        }\r\n\r\n                                                    ?>\r\n\r\n                                                    <option value=\"<?= $cari->cari_id ?>\" \r\n\r\n                                                        <?= ($isEditMode && $aktivasyon->aktivasyon_cari_id == $cari->cari_id) ? 'selected' : '' ?>>\r\n\r\n                                                        <?= $displayText ?>\r\n\r\n                                                    </option>\r\n\r\n                                                <?php endforeach; ?>\r\n\r\n                                            <?php else: ?>\r\n\r\n                                                <option value=\"\">Cari bulunamadı</option>\r\n\r\n                                            <?php endif; ?>\r\n\r\n                                        </select>\r\n\r\n                                    </div>\r\n\r\n\r\n\r\n                                    <!-- Durum -->\r\n\r\n                                    <div class=\"form-group col-md-6\">\r\n\r\n                                        <label for=\"durum_id\">Durum <span class=\"required\">*</span></label>\r\n\r\n                                        <select class=\"form-control\" name=\"durum_id\" id=\"durum_id\" required>\r\n\r\n                                            <option value=\"\">Durum Seçiniz...</option>\r\n\r\n                                            <?php if(isset($durum_listesi) && !empty($durum_listesi)): ?>\r\n\r\n                                                <?php foreach($durum_listesi as $durum): ?>\r\n\r\n                                                    <option value=\"<?= $durum->aktivasyon_durum_id ?>\"\r\n\r\n                                                        <?= ($isEditMode && $aktivasyon->aktivasyon_durum_id == $durum->aktivasyon_durum_id) ? 'selected' : '' ?>>\r\n\r\n                                                        <?= $durum->aktivasyon_durum_adi ?>\r\n\r\n                                                    </option>\r\n\r\n                                                <?php endforeach; ?>\r\n\r\n                                            <?php endif; ?>\r\n\r\n                                        </select>\r\n\r\n                                    </div>\r\n\r\n                                </div>\r\n\r\n\r\n\r\n                                <div class=\"row\">\r\n\r\n                                    <!-- Üye No -->\r\n\r\n                                    <div class=\"form-group col-md-4\">\r\n\r\n                                        <label for=\"uye_no\">Üye No</label>\r\n\r\n                                        <input type=\"text\" class=\"form-control\" name=\"uye_no\" id=\"uye_no\" \r\n\r\n                                               value=\"<?= $isEditMode ? $aktivasyon->aktivasyon_uye_no : '' ?>\" \r\n\r\n                                               placeholder=\"Üye numarasını giriniz\">\r\n\r\n                                    </div>\r\n\r\n\r\n\r\n                                    <!-- Kutu No -->\r\n\r\n                                    <div class=\"form-group col-md-4\">\r\n\r\n                                        <label for=\"kutu_no\">Kutu No</label>\r\n\r\n                                        <input type=\"text\" class=\"form-control\" name=\"kutu_no\" id=\"kutu_no\" \r\n\r\n                                               value=\"<?= $isEditMode ? $aktivasyon->aktivasyon_kutu_no : '' ?>\" \r\n\r\n                                               placeholder=\"Kutu numarasını giriniz\">\r\n\r\n                                    </div>\r\n\r\n\r\n\r\n                                    <!-- Kart No -->\r\n\r\n                                    <div class=\"form-group col-md-4\">\r\n\r\n                                        <label for=\"kart_no\">Kart No</label>\r\n\r\n                                        <input type=\"text\" class=\"form-control\" name=\"kart_no\" id=\"kart_no\" \r\n\r\n                                               value=\"<?= $isEditMode ? $aktivasyon->aktivasyon_kart_no : '' ?>\" \r\n\r\n                                               placeholder=\"Kart numarasını giriniz\">\r\n\r\n                                    </div>\r\n\r\n                                </div>\r\n\r\n\r\n\r\n                                <div class=\"row\">\r\n\r\n                                    <!-- Açıklama -->\r\n\r\n                                    <div class=\"form-group col-md-12\">\r\n\r\n                                        <label for=\"aciklama\">Açıklama</label>\r\n\r\n                                        <textarea class=\"form-control\" name=\"aciklama\" id=\"aciklama\" rows=\"3\" \r\n\r\n                                                  placeholder=\"S SPORT aktivasyon ile ilgili açıklama giriniz\"><?= $isEditMode ? $aktivasyon->aktivasyon_aciklama : '' ?></textarea>\r\n\r\n                                    </div>\r\n\r\n                                </div>\r\n\r\n\r\n\r\n                                <!-- Müşteri Bilgileri Bölümü -->\r\n\r\n                                <div id=\"musteriDetayAlani\" style=\"display: none;\">\r\n\r\n                                    <div class=\"card mt-3\">\r\n\r\n                                        <div class=\"card-header\">\r\n\r\n                                            <h5 class=\"card-title mb-0 ssport-title\">S SPORT Müşteri Bilgileri</h5>\r\n\r\n                                        </div>\r\n\r\n                                        <div class=\"card-body\">\r\n\r\n                                            <div class=\"row\">\r\n\r\n                                                <!-- Personel -->\r\n\r\n                                                <div class=\"form-group col-md-3\">\r\n\r\n                                                    <label>Personel</label>\r\n\r\n                                                    <input type=\"text\" class=\"form-control\" id=\"personelBilgi\" readonly \r\n\r\n                                                           placeholder=\"Müşteri seçildiğinde otomatik doldurulur\">\r\n\r\n                                                </div>\r\n\r\n\r\n\r\n                                                <!-- Sözleşme Tutar -->\r\n\r\n                                                <div class=\"form-group col-md-3\">\r\n\r\n                                                    <label>Sözleşme Tutar</label>\r\n\r\n                                                    <input type=\"text\" class=\"form-control\" id=\"sozlesmeTutar\" readonly \r\n\r\n                                                           placeholder=\"Tutar bilgisi\">\r\n\r\n                                                </div>\r\n\r\n\r\n\r\n                                                <!-- Müşteri Evrak/Görsel -->\r\n\r\n                                                <div class=\"form-group col-md-4\">\r\n\r\n                                                    <label>Müşteri Evrak/Görsel</label>\r\n\r\n                                                    <div id=\"evrakGorselAlani\">\r\n\r\n                                                        <p class=\"text-muted mb-0\">Müşteri seçildiğinde evrak ve görsel linkleri burada gösterilecek</p>\r\n\r\n                                                    </div>\r\n\r\n                                                </div>\r\n\r\n\r\n\r\n                                                <!-- Düzenle Butonu -->\r\n\r\n                                                <div class=\"form-group col-md-2\">\r\n\r\n                                                    <label>&nbsp;</label>\r\n\r\n                                                    <div>\r\n\r\n                                                        <a href=\"#\" id=\"musteriDuzenleBtn\" class=\"btn btn-warning btn-sm\" style=\"display: none;\" target=\"_blank\">\r\n\r\n                                                            <i class=\"fa fa-edit\"></i> Düzenle\r\n\r\n                                                        </a>\r\n\r\n                                                    </div>\r\n\r\n                                                </div>\r\n\r\n                                            </div>\r\n\r\n                                            \r\n\r\n                                            <div class=\"row\">\r\n\r\n                                                <!-- Sözleşme Açıklama -->\r\n\r\n                                                <div class=\"form-group col-md-5\">\r\n\r\n                                                    <label>Sözleşme Açıklama</label>\r\n\r\n                                                    <textarea class=\"form-control\" id=\"sozlesmeAciklama\" rows=\"2\" readonly \r\n\r\n                                                              placeholder=\"Sözleşme açıklama bilgisi\"></textarea>\r\n\r\n                                                </div>\r\n\r\n\r\n\r\n                                                <!-- Sözleşme Görsel -->\r\n\r\n                                                <div class=\"form-group col-md-5\">\r\n\r\n                                                    <label>Sözleşme Görsel</label>\r\n\r\n                                                    <div id=\"sozlesmeGorselAlani\">\r\n\r\n                                                        <p class=\"text-muted mb-0\">Sözleşme görselleri burada gösterilecek</p>\r\n\r\n                                                    </div>\r\n\r\n                                                </div>\r\n\r\n\r\n\r\n                                                <!-- Sözleşme Düzenle Butonu -->\r\n\r\n                                                <div class=\"form-group col-md-2\">\r\n\r\n                                                    <label>&nbsp;</label>\r\n\r\n                                                    <div>\r\n\r\n                                                        <a href=\"#\" id=\"sozlesmeDuzenleBtn\" class=\"btn btn-info btn-sm\" style=\"display: none;\" target=\"_blank\">\r\n\r\n                                                            <i class=\"fa fa-file-invoice\"></i> Sözleşme Düzenle\r\n\r\n                                                        </a>\r\n\r\n                                                    </div>\r\n\r\n                                                </div>\r\n\r\n                                            </div>\r\n\r\n\r\n\r\n                                            <!-- Tahsilat Bilgileri Bölümü -->\r\n\r\n                                            <div class=\"row mt-3\">\r\n\r\n                                                <div class=\"col-md-12\">\r\n\r\n                                                    <h6 class=\"text-primary mb-3\">\r\n\r\n                                                        <i class=\"fa fa-money\"></i> S SPORT Tahsilat Bilgileri\r\n\r\n                                                    </h6>\r\n\r\n                                                    <div id=\"tahsilatBilgiAlani\">\r\n\r\n                                                        <p class=\"text-muted mb-0\">Müşteri seçildiğinde tahsilat bilgileri burada gösterilecek</p>\r\n\r\n                                                    </div>\r\n\r\n                                                </div>\r\n\r\n                                            </div>\r\n\r\n                                        </div>\r\n\r\n                                    </div>\r\n\r\n                                </div>\r\n\r\n\r\n\r\n                                <div class=\"row\">\r\n\r\n                                    <div class=\"col-md-12\">\r\n\r\n                                        <div class=\"form-group\">\r\n\r\n                                            <button type=\"submit\" class=\"btn btn-primary ssport-btn\">\r\n\r\n                                                <i class=\"fa fa-save\"></i> \r\n\r\n                                                <?= $isEditMode ? 'S SPORT Güncelle' : 'S SPORT Kaydet' ?>\r\n\r\n                                            </button>\r\n\r\n                                            <a href=\"<?= base_url('aktivasyon') ?>\" class=\"btn btn-secondary ml-2\">\r\n\r\n                                                <i class=\"fa fa-times\"></i> İptal\r\n\r\n                                            </a>\r\n\r\n                                        </div>\r\n\r\n                                    </div>\r\n\r\n                                </div>\r\n\r\n                            </form>\r\n\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                </div>\r\n\r\n            </div>\r\n\r\n        </div>\r\n\r\n    </div>\r\n\r\n</div>\r\n\r\n\r\n\r\n<?php $this->load->view(\"include/footer-js\"); ?>\r\n\r\n\r\n\r\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js\"></script>\r\n\r\n<script>\r\n\r\n$(document).ready(function() {\r\n\r\n    // Select2 için müşteri dropdown'ını başlat\r\n\r\n    $('#cari_id').select2({\r\n\r\n        placeholder: 'S SPORT müşteri ara ve seç...',\r\n\r\n        allowClear: true,\r\n\r\n        ajax: {\r\n\r\n            url: '<?= base_url(\"aktivasyon/cari_ara\") ?>',\r\n\r\n            dataType: 'json',\r\n\r\n            delay: 250,\r\n\r\n            data: function (params) {\r\n\r\n                return {\r\n\r\n                    q: params.term // search term\r\n\r\n                };\r\n\r\n            },\r\n\r\n            processResults: function (data) {\r\n\r\n                return {\r\n\r\n                    results: data\r\n\r\n                };\r\n\r\n            },\r\n\r\n            cache: true\r\n\r\n        },\r\n\r\n        minimumInputLength: 2\r\n\r\n    });\r\n\r\n\r\n\r\n    // Müşteri seçildiğinde detayları getir\r\n\r\n    $('#cari_id').on('select2:select', function (e) {\r\n\r\n        var cariId = e.params.data.id;\r\n\r\n        if (cariId) {\r\n\r\n            musteriDetayGetir(cariId);\r\n\r\n        }\r\n\r\n    });\r\n\r\n\r\n\r\n    // Müşteri seçimi temizlendiğinde detay alanını gizle\r\n\r\n    $('#cari_id').on('select2:clear', function (e) {\r\n\r\n        $('#musteriDetayAlani').hide();\r\n\r\n        $('#personelBilgi').val('');\r\n\r\n        $('#sozlesmeTutar').val('');\r\n\r\n        $('#sozlesmeAciklama').val('');\r\n\r\n        $('#evrakGorselAlani').html('<p class=\"text-muted mb-0\">Müşteri seçildiğinde evrak ve görsel linkleri burada gösterilecek</p>');\r\n\r\n        $('#sozlesmeGorselAlani').html('<p class=\"text-muted mb-0\">Sözleşme görselleri burada gösterilecek</p>');\r\n\r\n        $('#tahsilatBilgiAlani').html('<p class=\"text-muted mb-0\">Müşteri seçildiğinde tahsilat bilgileri burada gösterilecek</p>');\r\n\r\n        $('#musteriDuzenleBtn').hide();\r\n\r\n        $('#sozlesmeDuzenleBtn').hide();\r\n\r\n    });\r\n\r\n\r\n\r\n    // AJAX ile müşteri detaylarını getir\r\n\r\n    function musteriDetayGetir(cariId) {\r\n\r\n        $.ajax({\r\n\r\n            url: '<?= base_url(\"aktivasyon/cari_detay_getir\") ?>',\r\n\r\n            type: 'GET',\r\n\r\n            data: { cari_id: cariId },\r\n\r\n            dataType: 'json',\r\n\r\n            success: function(response) {\r\n\r\n                if (response.error) {\r\n\r\n                    console.error('Hata:', response.error);\r\n\r\n                    return;\r\n\r\n                }\r\n\r\n\r\n\r\n                // Personel bilgisini doldur\r\n\r\n                $('#personelBilgi').val(response.personel || 'Belirtilmemiş');\r\n\r\n\r\n\r\n                // Sözleşme bilgilerini doldur\r\n\r\n                $('#sozlesmeTutar').val(response.sozlesme_tutar || 'Belirtilmemiş');\r\n\r\n                $('#sozlesmeAciklama').val(response.sozlesme_aciklama || 'Açıklama bulunmuyor');\r\n\r\n\r\n\r\n                // Sözleşme görsel linklerini oluştur\r\n\r\n                var sozlesmeGorselHtml = '';\r\n\r\n                if (response.sozlesme_dosyalar && response.sozlesme_dosyalar.length > 0) {\r\n\r\n                    sozlesmeGorselHtml += '<strong>Sözleşme:</strong> ';\r\n\r\n                    response.sozlesme_dosyalar.forEach(function(sozlesme, index) {\r\n\r\n                        sozlesmeGorselHtml += '<button type=\"button\" class=\"btn btn-sm btn-outline-info mr-1 mb-1\" ';\r\n\r\n                        sozlesmeGorselHtml += 'onclick=\"window.open(\\'' + sozlesme.link + '\\', \\'sozlesmeGorsel' + index + '\\', \\'width=800,height=600,scrollbars=yes,resizable=yes\\')\">';\r\n\r\n                        sozlesmeGorselHtml += '<i class=\"fa fa-file-image\"></i> Görsel ' + (index + 1);\r\n\r\n                        sozlesmeGorselHtml += '</button>';\r\n\r\n                    });\r\n\r\n                } else {\r\n\r\n                    sozlesmeGorselHtml = '<p class=\"text-muted mb-0\">Sözleşme görseli bulunmuyor</p>';\r\n\r\n                }\r\n\r\n                $('#sozlesmeGorselAlani').html(sozlesmeGorselHtml);\r\n\r\n\r\n\r\n                // Evrak ve görsel linklerini oluştur\r\n\r\n                var evrakGorselHtml = '';\r\n\r\n                \r\n\r\n                // Evrak dosyaları\r\n\r\n                if (response.evrak_dosyalar && response.evrak_dosyalar.length > 0) {\r\n\r\n                    evrakGorselHtml += '<strong>Evraklar:</strong> ';\r\n\r\n                    evrakGorselHtml += '<button type=\"button\" class=\"btn btn-sm btn-outline-primary mr-2 mb-1\" ';\r\n\r\n                    evrakGorselHtml += 'onclick=\"window.open(\\'' + '<?= base_url(\"cari/evrakGoster/\") ?>' + cariId + '\\', \\'evrakPencere\\', \\'width=800,height=600,scrollbars=yes,resizable=yes\\')\">';\r\n\r\n                    evrakGorselHtml += '<i class=\"fa fa-file\"></i> ' + response.evrak_dosyalar.length + ' Evrak';\r\n\r\n                    evrakGorselHtml += '</button>';\r\n\r\n                }\r\n\r\n\r\n\r\n                // Görsel dosyaları\r\n\r\n                if (response.fotograf_dosyalar && response.fotograf_dosyalar.length > 0) {\r\n\r\n                    if (response.evrak_dosyalar && response.evrak_dosyalar.length > 0) {\r\n\r\n                        evrakGorselHtml += ' '; // Boşluk ekle\r\n\r\n                    }\r\n\r\n                    evrakGorselHtml += '<strong>Görseller:</strong> ';\r\n\r\n                    evrakGorselHtml += '<button type=\"button\" class=\"btn btn-sm btn-outline-success mr-1 mb-1\" ';\r\n\r\n                    evrakGorselHtml += 'onclick=\"window.open(\\'' + '<?= base_url(\"cari/gorselGoster/\") ?>' + cariId + '\\', \\'gorselPencere\\', \\'width=800,height=600,scrollbars=yes,resizable=yes\\')\">';\r\n\r\n                    evrakGorselHtml += '<i class=\"fa fa-image\"></i> ' + response.fotograf_dosyalar.length + ' Görsel';\r\n\r\n                    evrakGorselHtml += '</button>';\r\n\r\n                }\r\n\r\n\r\n\r\n                if (!evrakGorselHtml) {\r\n\r\n                    evrakGorselHtml = '<p class=\"text-muted mb-0\">Bu müşteri için evrak veya görsel bulunmamaktadır.</p>';\r\n\r\n                }\r\n\r\n\r\n\r\n                $('#evrakGorselAlani').html(evrakGorselHtml);\r\n\r\n\r\n\r\n                // Düzenle butonu linkini ayarla\r\n\r\n                $('#musteriDuzenleBtn').attr('href', response.duzenle_link).show();\r\n\r\n\r\n\r\n                // Sözleşme düzenle butonu linkini ayarla\r\n\r\n                if (response.sozlesme_id) {\r\n\r\n                    var sozlesmeDuzenleLink = '<?= base_url(\"fatura/satis-faturasi/\") ?>' + response.sozlesme_id;\r\n\r\n                    $('#sozlesmeDuzenleBtn').attr('href', sozlesmeDuzenleLink).show();\r\n\r\n                } else {\r\n\r\n                    $('#sozlesmeDuzenleBtn').hide();\r\n\r\n                }\r\n\r\n\r\n\r\n                // Tahsilat bilgilerini işle\r\n\r\n                var tahsilatHtml = '';\r\n\r\n                if (response.tahsilatlar && response.tahsilatlar.length > 0) {\r\n\r\n                    tahsilatHtml += '<div class=\"table-responsive\">';\r\n\r\n                    tahsilatHtml += '<table class=\"table table-sm table-bordered\">';\r\n\r\n                    tahsilatHtml += '<thead class=\"thead-light\">';\r\n\r\n                    tahsilatHtml += '<tr>';\r\n\r\n                    tahsilatHtml += '<th>Tahsilat Tipi</th>';\r\n\r\n                    tahsilatHtml += '<th>Tutar</th>';\r\n\r\n                    tahsilatHtml += '<th>Durum</th>';\r\n\r\n                    tahsilatHtml += '<th>Görsel</th>';\r\n\r\n                    tahsilatHtml += '<th>Tarih</th>';\r\n\r\n                    tahsilatHtml += '<th>İşlemler</th>';\r\n\r\n                    tahsilatHtml += '</tr>';\r\n\r\n                    tahsilatHtml += '</thead>';\r\n\r\n                    tahsilatHtml += '<tbody>';\r\n\r\n                    \r\n\r\n                    response.tahsilatlar.forEach(function(tahsilat, index) {\r\n\r\n                        // Tahsilat tipi iconları ve renkleri\r\n\r\n                        var tipIcon = '';\r\n\r\n                        var tipClass = '';\r\n\r\n                        switch(tahsilat.tahsilat_tipi) {\r\n\r\n                            case 'Banka': tipIcon = 'fa fa-university'; tipClass = 'text-primary'; break;\r\n\r\n                            case 'Çek': tipIcon = 'fa fa-file-text-o'; tipClass = 'text-info'; break;\r\n\r\n                            case 'Kasa': tipIcon = 'fa fa-money'; tipClass = 'text-success'; break;\r\n\r\n                            case 'Senet': tipIcon = 'fa fa-file-o'; tipClass = 'text-warning'; break;\r\n\r\n                            default: tipIcon = 'fa fa-question'; tipClass = 'text-muted'; break;\r\n\r\n                        }\r\n\r\n                        \r\n\r\n                        // Durum iconları ve renkleri  \r\n\r\n                        var durumIcon = '';\r\n\r\n                        var durumBadgeClass = '';\r\n\r\n                        switch(tahsilat.durum_code) {\r\n\r\n                            case 1: \r\n\r\n                                durumIcon = 'fa fa-clock-o'; \r\n\r\n                                durumBadgeClass = 'badge-warning'; \r\n\r\n                                break;\r\n\r\n                            case 2: \r\n\r\n                                durumIcon = 'fa fa-check'; \r\n\r\n                                durumBadgeClass = 'badge-success'; \r\n\r\n                                break;\r\n\r\n                            case 3: \r\n\r\n                                durumIcon = 'fa fa-times'; \r\n\r\n                                durumBadgeClass = 'badge-danger'; \r\n\r\n                                break;\r\n\r\n                            default: \r\n\r\n                                durumIcon = 'fa fa-question'; \r\n\r\n                                durumBadgeClass = 'badge-secondary'; \r\n\r\n                                break;\r\n\r\n                        }\r\n\r\n                        \r\n\r\n                        tahsilatHtml += '<tr>';\r\n\r\n                        \r\n\r\n                        // Tahsilat Tipi sütunu\r\n\r\n                        tahsilatHtml += '<td>';\r\n\r\n                        tahsilatHtml += '<i class=\"' + tipIcon + ' ' + tipClass + ' mr-2\"></i>';\r\n\r\n                        tahsilatHtml += '<span class=\"' + tipClass + '\">' + tahsilat.tahsilat_tipi + '</span>';\r\n\r\n                        tahsilatHtml += '</td>';\r\n\r\n                        \r\n\r\n                        // Tutar sütunu\r\n\r\n                        tahsilatHtml += '<td><strong class=\"tutar-buyuk\">' + tahsilat.tutar + '</strong></td>';\r\n\r\n                        \r\n\r\n                        // Durum sütunu\r\n\r\n                        tahsilatHtml += '<td>';\r\n\r\n                        tahsilatHtml += '<span class=\"badge ' + durumBadgeClass + '\">';\r\n\r\n                        tahsilatHtml += '<i class=\"' + durumIcon + ' mr-1\"></i>' + tahsilat.durum;\r\n\r\n                        tahsilatHtml += '</span>';\r\n\r\n                        tahsilatHtml += '</td>';\r\n\r\n                        \r\n\r\n                        // Görsel sütunu\r\n\r\n                        tahsilatHtml += '<td>';\r\n\r\n                        if (tahsilat.gorsel && tahsilat.gorsel_link) {\r\n\r\n                            tahsilatHtml += '<button type=\"button\" class=\"btn btn-sm btn-outline-info tahsilat-gorsel-btn\" ';\r\n\r\n                            tahsilatHtml += 'onclick=\"window.open(\\'' + tahsilat.gorsel_link + '\\', \\'_blank\\')\">';\r\n\r\n                            tahsilatHtml += '<i class=\"fa fa-image\"></i> Görsel</button>';\r\n\r\n                        } else {\r\n\r\n                            tahsilatHtml += '<span class=\"text-muted\">-</span>';\r\n\r\n                        }\r\n\r\n                        tahsilatHtml += '</td>';\r\n\r\n                        \r\n\r\n                        // Tarih sütunu\r\n\r\n                        tahsilatHtml += '<td>';\r\n\r\n                        if (tahsilat.olusturma_tarihi) {\r\n\r\n                            var tarih = new Date(tahsilat.olusturma_tarihi);\r\n\r\n                            tahsilatHtml += '<small>' + tarih.toLocaleDateString('tr-TR') + '</small>';\r\n\r\n                        }\r\n\r\n                        tahsilatHtml += '</td>';\r\n\r\n                        \r\n\r\n                        // İşlemler sütunu - Görsel Yükleme\r\n\r\n                        tahsilatHtml += '<td>';\r\n\r\n                        tahsilatHtml += '<div class=\"tahsilat-gorsel-upload-wrapper\" data-tahsilat-id=\"' + tahsilat.kayit_id + '\" data-tahsilat-tipi=\"' + tahsilat.tahsilat_tipi_kodu + '\">';\r\n\r\n                        tahsilatHtml += '<input type=\"file\" class=\"d-none tahsilat-gorsel-input\" id=\"gorselInput_' + index + '\" accept=\"image/*\" onchange=\"tahsilatGorselYukle(this, ' + tahsilat.kayit_id + ', ' + tahsilat.tahsilat_tipi_kodu + ')\">';\r\n\r\n                        tahsilatHtml += '<button type=\"button\" class=\"btn btn-sm btn-outline-primary\" onclick=\"document.getElementById(\\'gorselInput_' + index + '\\').click()\">';\r\n\r\n                        tahsilatHtml += '<i class=\"fa fa-upload\"></i> Görsel Yükle';\r\n\r\n                        tahsilatHtml += '</button>';\r\n\r\n                        tahsilatHtml += '</div>';\r\n\r\n                        tahsilatHtml += '</td>';\r\n\r\n                        \r\n\r\n                        tahsilatHtml += '</tr>';\r\n\r\n                    });\r\n\r\n                    tahsilatHtml += '</tbody>';\r\n\r\n                    tahsilatHtml += '</table>';\r\n\r\n                    tahsilatHtml += '</div>';\r\n\r\n                } else {\r\n\r\n                    tahsilatHtml = '<div class=\"alert alert-info\"><i class=\"fa fa-info-circle\"></i> Bu S SPORT müşteri için henüz tahsilat kaydı bulunmamaktadır.</div>';\r\n\r\n                }\r\n\r\n                $('#tahsilatBilgiAlani').html(tahsilatHtml);\r\n\r\n\r\n\r\n                // Detay alanını göster\r\n\r\n                $('#musteriDetayAlani').show();\r\n\r\n            },\r\n\r\n            error: function(xhr, status, error) {\r\n\r\n                console.error('AJAX Hatası:', error);\r\n\r\n            }\r\n\r\n        });\r\n\r\n    }\r\n\r\n\r\n\r\n    // Sayfa yüklendiğinde düzenleme modunda müşteri seçiliyse detayları getir\r\n\r\n    <?php if($isEditMode && !empty($aktivasyon->aktivasyon_cari_id)): ?>\r\n\r\n        musteriDetayGetir(<?= $aktivasyon->aktivasyon_cari_id ?>);\r\n\r\n    <?php endif; ?>\r\n\r\n\r\n\r\n    // Form validasyonu\r\n\r\n    $('#aktivasyonForm').on('submit', function(e) {\r\n\r\n        var cariId = $('#cari_id').val();\r\n\r\n        var durumId = $('#durum_id').val();\r\n\r\n\r\n\r\n        if (!cariId) {\r\n\r\n            alert('Lütfen bir S SPORT müşteri seçiniz.');\r\n\r\n            e.preventDefault();\r\n\r\n            return false;\r\n\r\n        }\r\n\r\n\r\n\r\n        if (!durumId) {\r\n\r\n            alert('Lütfen bir durum seçiniz.');\r\n\r\n            e.preventDefault();\r\n\r\n            return false;\r\n\r\n        }\r\n\r\n\r\n\r\n        return true;\r\n\r\n    });\r\n\r\n\r\n\r\n    // Sadece rakam girişi için input'ları kontrol et\r\n\r\n    $('#uye_no, #kutu_no, #kart_no').on('input', function() {\r\n\r\n        this.value = this.value.replace(/[^0-9]/g, '');\r\n\r\n    });\r\n\r\n\r\n\r\n    // Tahsilat görsel yükleme fonksiyonu\r\n\r\n    function tahsilatGorselYukle(input, tahsilatId, tahsilatTipi) {\r\n\r\n        if (input.files && input.files[0]) {\r\n\r\n            var file = input.files[0];\r\n\r\n            \r\n\r\n            // Dosya boyutu kontrolü (5MB)\r\n\r\n            if (file.size > 5 * 1024 * 1024) {\r\n\r\n                alert('Dosya boyutu 5MB\\'dan küçük olmalıdır.');\r\n\r\n                input.value = '';\r\n\r\n                return;\r\n\r\n            }\r\n\r\n            \r\n\r\n            // Dosya türü kontrolü\r\n\r\n            if (!file.type.match('image.*')) {\r\n\r\n                alert('Lütfen sadece resim dosyası seçiniz.');\r\n\r\n                input.value = '';\r\n\r\n                return;\r\n\r\n            }\r\n\r\n            \r\n\r\n            var formData = new FormData();\r\n\r\n            formData.append('gorsel', file);\r\n\r\n            formData.append('tahsilat_id', tahsilatId);\r\n\r\n            formData.append('tahsilat_tipi', tahsilatTipi);\r\n\r\n            \r\n\r\n            // Loading göster\r\n\r\n            var wrapper = input.closest('.tahsilat-gorsel-upload-wrapper');\r\n\r\n            var button = wrapper.querySelector('button');\r\n\r\n            var originalText = button.innerHTML;\r\n\r\n            button.innerHTML = '<i class=\"fa fa-spinner fa-spin\"></i> Yükleniyor...';\r\n\r\n            button.disabled = true;\r\n\r\n            \r\n\r\n            $.ajax({\r\n\r\n                url: '<?= base_url(\"aktivasyon/tahsilat_gorsel_yukle\") ?>',\r\n\r\n                type: 'POST',\r\n\r\n                data: formData,\r\n\r\n                contentType: false,\r\n\r\n                processData: false,\r\n\r\n                success: function(response) {\r\n\r\n                    if (response.success) {\r\n\r\n                        alert('S SPORT görsel başarıyla yüklendi.');\r\n\r\n                        // Müşteri detaylarını yenile\r\n\r\n                        var cariId = $('#cari_id').val();\r\n\r\n                        if (cariId) {\r\n\r\n                            musteriDetayGetir(cariId);\r\n\r\n                        }\r\n\r\n                    } else {\r\n\r\n                        alert('S SPORT görsel yüklenirken hata oluştu: ' + (response.message || 'Bilinmeyen hata'));\r\n\r\n                    }\r\n\r\n                },\r\n\r\n                error: function(xhr, status, error) {\r\n\r\n                    alert('S SPORT görsel yüklenirken hata oluştu. Lütfen tekrar deneyiniz.');\r\n\r\n                    console.error('Görsel yükleme hatası:', error);\r\n\r\n                },\r\n\r\n                complete: function() {\r\n\r\n                    // Loading'i gizle\r\n\r\n                    button.innerHTML = originalText;\r\n\r\n                    button.disabled = false;\r\n\r\n                    input.value = ''; // Input'u temizle\r\n\r\n                }\r\n\r\n            });\r\n\r\n        }\r\n\r\n    }\r\n\r\n});\r\n\r\n</script>\r\n\r\n</body>\r\n\r\n</html>\r\n"
        }
    ]
}